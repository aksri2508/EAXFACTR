function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],a=!0,r=!1,o=void 0;try{for(var s,n=t[Symbol.iterator]();!(a=(s=n.next()).done)&&(i.push(s.value),!e||i.length!==e);a=!0);}catch(c){r=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(r)throw o}}return i}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{FinS:function(t,e,i){"use strict";i.r(e),i.d(e,"ApprovalModule",(function(){return Nt}));var a=i("tyNb"),r=i("ey9i"),o=i("3Pt+"),s=i("fXoL"),n=i("oARB"),c=i("K3ix"),l=i("IzNV"),b=i("ofXK"),u=i("ZOsW");function p(t,e){1&t&&(s.Tb(0),s.Lc(1,"Add"),s.Sb())}function m(t,e){1&t&&(s.Tb(0),s.Lc(1,"Edit"),s.Sb())}function d(t,e){if(1&t&&(s.Vb(0,"div",24),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",i.myFormErrors.stageName," ")}}function h(t,e){if(1&t&&(s.Vb(0,"div",24),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",i.myFormErrors.noOfApprovals," ")}}function v(t,e){if(1&t&&(s.Vb(0,"div",24),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",null==i.myForm.errors?null:i.myForm.errors.invalidMaxApproval," ")}}function f(t,e){if(1&t&&(s.Vb(0,"div",24),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",i.myFormErrors.noOfRejections," ")}}function g(t,e){if(1&t&&(s.Vb(0,"div",24),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",null==i.myForm.errors?null:i.myForm.errors.invalidMaxRejection," ")}}function S(t,e){if(1&t&&(s.Vb(0,"div"),s.Lc(1),s.Vb(2,"small"),s.Lc(3),s.Ub(),s.Ub()),2&t){var i=e.item;s.Cb(1),s.Nc("",i.employeeName,"\xa0"),s.Cb(2),s.Nc("(",i.empCode,")")}}function y(t,e){if(1&t&&(s.Vb(0,"div",24),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",i.myFormErrors.authorizerId," ")}}function U(t,e){if(1&t&&(s.Vb(0,"option",25),s.Lc(1),s.Ub()),2&t){var i=e.$implicit;s.oc("value",i.id),s.Cb(1),s.Mc(i.name)}}function C(t,e){if(1&t){var i=s.Wb();s.Vb(0,"button",26),s.dc("click",(function(){return s.Dc(i),s.hc().saveUpdate()})),s.Qb(1,"i",27),s.Vb(2,"span"),s.Lc(3,"Save"),s.Ub(),s.Ub()}}function L(t,e){if(1&t){var i=s.Wb();s.Vb(0,"button",28),s.dc("click",(function(){return s.Dc(i),s.hc().clearForm()})),s.Qb(1,"i",29),s.Vb(2,"span"),s.Lc(3,"Clear"),s.Ub(),s.Ub()}}function V(t,e){if(1&t){var i=s.Wb();s.Vb(0,"button",26),s.dc("click",(function(){return s.Dc(i),s.hc().saveUpdate()})),s.Qb(1,"i",30),s.Vb(2,"span"),s.Lc(3,"Update"),s.Ub(),s.Ub()}}function F(t,e){if(1&t){var i=s.Wb();s.Vb(0,"button",28),s.dc("click",(function(){return s.Dc(i),s.hc().activeModal.hide()})),s.Qb(1,"i",31),s.Vb(2,"span"),s.Lc(3,"Cancel"),s.Ub(),s.Ub()}}function I(t,e){1&t&&(s.Vb(0,"div",32),s.Vb(1,"span",33),s.Lc(2,"Note:"),s.Ub(),s.Lc(3," You are unauthorized to "),s.Vb(4,"strong"),s.Lc(5,"update"),s.Ub(),s.Lc(6," this transaction! "),s.Ub())}function A(t,e){1&t&&(s.Vb(0,"div",32),s.Vb(1,"span",33),s.Lc(2,"Note:"),s.Ub(),s.Lc(3," You are unauthorized to "),s.Vb(4,"strong"),s.Lc(5,"add"),s.Ub(),s.Lc(6," this transaction!. "),s.Ub())}var k,D=((k=function(){function t(e,i,a,o,s,n,c){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.commonDataService=a,this.activeModal=o,this.formBuilder=s,this.branchUtilsService=n,this.approvalStagesDataService=c,this.appConstants=r.h,this.screenAcl={},this.employeeList=[],this.statusList=[],this.myFormData={},this.myFormErrors={stageName:"",noOfApprovals:"",noOfRejections:"",authorizerId:""},this.myFormValidationMsgs={stageName:{required:"Stage Name is required"},noOfApprovals:{required:"No. of Approvals is required",min:"Minimum 1 is required",pattern:"Only positive numbers are allowed"},noOfRejections:{required:"No. of Rejections is required",min:"Minimum 1 is required",pattern:"Only positive numbers are allowed"},authorizerId:{required:"Authorizer is required"}}}return _createClass(t,[{key:"ngOnInit",value:function(){this.screenAcl=this.authGuardService.getScreenAcl("56"),this.initializeForm(),this.getEmployeeList(),this.getAutoSuggestionList("getCommonStatusList"),this.inputEditId&&this.get()}},{key:"initializeForm",value:function(){var t=this;this.myForm=this.formBuilder.group({stageName:["",[o.u.required]],stageDescription:[""],noOfApprovals:["",[o.u.required,o.u.min(1),o.u.pattern(this.appConstants.VALIDATION_PATTERNS.positiveFloatNumber)]],noOfRejections:["",[o.u.required,o.u.pattern(this.appConstants.VALIDATION_PATTERNS.positiveFloatNumber)]],authorizerId:["",[o.u.required]],status:["1"]}),this.myForm.valueChanges.subscribe((function(e){t.utilsService.validation(t.myForm,t.myFormErrors,t.myFormValidationMsgs),t.myFormData=t.myForm.getRawValue()})),this.myFormData=this.myForm.getRawValue()}},{key:"saveUpdate",value:function(){var t=this;if(!this.myForm.valid)return this.utilsService.validation(this.myForm,this.myFormErrors,this.myFormValidationMsgs,!0),!1;var e=parseFloat(this.myFormData.noOfApprovals)>parseFloat(this.myFormData.noOfRejections)?this.myFormData.noOfApprovals:this.myFormData.noOfRejections;if(this.myFormData.authorizerId.length<parseFloat(e))return parseFloat(e)===parseFloat(this.myFormData.noOfRejections)?this.utilsService.showFailureMsg('In the "No. of Rejects" field, enter a number less than or equal to the value in "Authorizers" column'):this.utilsService.showFailureMsg("'In the No. of Approvals Required' field, enter a number less than or equal to the value in \"Authorizers\" column"),!1;var i,a={stageName:this.myFormData.stageName,stageDescription:this.myFormData.stageDescription,noOfApprovals:this.myFormData.noOfApprovals,noOfRejections:this.myFormData.noOfRejections,authorizerId:this.myFormData.authorizerId.join(","),status:this.myFormData.status};this.inputEditId?(i="update",a.id=this.inputEditId):i="save",this.approvalStagesDataService[i](a).subscribe((function(e){"SUCCESS"===e.status?(t.utilsService.showSuccessMsg(e),t.branchUtilsService.actionSaveUpdate.next({triggerType:"approval-stages"}),t.activeModal.hide()):t.utilsService.showFailureMsg(e)}))}},{key:"get",value:function(){var t=this;this.approvalStagesDataService.get(this.inputEditId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results[0];t.myForm.patchValue({stageName:i.stageName,stageDescription:i.stageDescription,noOfApprovals:i.noOfApprovals,noOfRejections:i.noOfRejections,authorizerId:i.authorizerId.split(","),status:i.status})}else t.utilsService.showFailureMsg(e)}))}},{key:"clearForm",value:function(){this.initializeForm()}},{key:"getAutoSuggestionList",value:function(t,e){var i=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(a){"SUCCESS"===a.status?(i.utilsService.ifNotPushToList(a.results,e),"getCommonStatusList"===t&&(i.statusList=a.results)):i.utilsService.showFailureMsg(a)}))}},{key:"getEmployeeList",value:function(t){var e=this;this.commonDataService.getEmployeeList(2).subscribe((function(i){"SUCCESS"===i.status?(e.utilsService.ifNotPushToList(i.results,t),e.employeeList=i.results.map((function(t){return t.searchText=t.employeeName+" - "+t.empCode,t}))):e.utilsService.showFailureMsg(i)}))}}]),t}()).\u0275fac=function(t){return new(t||k)(s.Pb(r.g),s.Pb(r.a),s.Pb(n.l),s.Pb(c.a),s.Pb(o.e),s.Pb(l.a),s.Pb(n.d))},k.\u0275cmp=s.Jb({type:k,selectors:[["app-approval-stages-add-popup"]],inputs:{inputEditId:"inputEditId"},decls:60,vars:18,consts:[[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],[1,"close",3,"click"],[1,"modal-body"],[1,"row",3,"formGroup"],[1,"form-group","col-sm-12"],[1,"form-label"],[1,"mandatory"],["type","text","formControlName","stageName",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],["type","text","formControlName","stageDescription",1,"form-control","form-control-sm"],[1,"form-group","col-sm-6"],["type","text","formControlName","noOfApprovals",1,"form-control","form-control-sm"],["type","text","formControlName","noOfRejections",1,"form-control","form-control-sm"],["formControlName","authorizerId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["ng-option-tmp",""],["formControlName","status",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],[1,"validation-error"],[3,"value"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-broom"],[1,"fa","fa-sync"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Vb(1,"h5",1),s.Jc(2,p,2,0,"ng-container",2),s.Jc(3,m,2,0,"ng-container",2),s.Lc(4," Approval Stages "),s.Ub(),s.Vb(5,"button",3),s.dc("click",(function(){return e.activeModal.hide()})),s.Vb(6,"span"),s.Lc(7,"\xd7"),s.Ub(),s.Ub(),s.Ub(),s.Vb(8,"div",4),s.Vb(9,"div",5),s.Vb(10,"div",6),s.Vb(11,"label",7),s.Lc(12,"Stage Name"),s.Vb(13,"span",8),s.Lc(14,"*"),s.Ub(),s.Ub(),s.Qb(15,"input",9),s.Jc(16,d,2,1,"div",10),s.Ub(),s.Vb(17,"div",6),s.Vb(18,"label",7),s.Lc(19,"Stage Description"),s.Ub(),s.Qb(20,"input",11),s.Ub(),s.Vb(21,"div",12),s.Vb(22,"label",7),s.Lc(23,"No. of Approvals"),s.Vb(24,"span",8),s.Lc(25,"*"),s.Ub(),s.Ub(),s.Qb(26,"input",13),s.Jc(27,h,2,1,"div",10),s.Jc(28,v,2,1,"div",10),s.Ub(),s.Vb(29,"div",12),s.Vb(30,"label",7),s.Lc(31,"No. of Rejections"),s.Vb(32,"span",8),s.Lc(33,"*"),s.Ub(),s.Ub(),s.Qb(34,"input",14),s.Jc(35,f,2,1,"div",10),s.Jc(36,g,2,1,"div",10),s.Ub(),s.Vb(37,"div",6),s.Vb(38,"label",7),s.Lc(39,"Authorizer"),s.Vb(40,"span",8),s.Lc(41,"*"),s.Ub(),s.Ub(),s.Vb(42,"ng-select",15),s.Jc(43,S,4,2,"ng-template",16),s.Ub(),s.Jc(44,y,2,1,"div",10),s.Ub(),s.Vb(45,"div",6),s.Vb(46,"label",7),s.Lc(47,"Status"),s.Vb(48,"span",8),s.Lc(49,"*"),s.Ub(),s.Ub(),s.Vb(50,"select",17),s.Jc(51,U,2,2,"option",18),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(52,"div",19),s.Vb(53,"div",20),s.Jc(54,C,4,0,"button",21),s.Jc(55,L,4,0,"button",22),s.Jc(56,V,4,0,"button",21),s.Jc(57,F,4,0,"button",22),s.Ub(),s.Jc(58,I,7,0,"div",23),s.Jc(59,A,7,0,"div",23),s.Ub()),2&t&&(s.Cb(2),s.oc("ngIf",!e.inputEditId),s.Cb(1),s.oc("ngIf",e.inputEditId),s.Cb(6),s.oc("formGroup",e.myForm),s.Cb(7),s.oc("ngIf",e.myFormErrors.stageName),s.Cb(11),s.oc("ngIf",e.myFormErrors.noOfApprovals),s.Cb(1),s.oc("ngIf",null==e.myForm.errors?null:e.myForm.errors.invalidMaxApproval),s.Cb(7),s.oc("ngIf",e.myFormErrors.noOfRejections),s.Cb(1),s.oc("ngIf",null==e.myForm.errors?null:e.myForm.errors.invalidMaxRejection),s.Cb(6),s.oc("items",e.employeeList)("multiple",!0),s.Cb(2),s.oc("ngIf",e.myFormErrors.authorizerId),s.Cb(7),s.oc("ngForOf",e.statusList),s.Cb(3),s.oc("ngIf",e.screenAcl.add&&!e.inputEditId),s.Cb(1),s.oc("ngIf",!e.inputEditId),s.Cb(1),s.oc("ngIf",e.screenAcl.update&&e.inputEditId),s.Cb(1),s.oc("ngIf",e.inputEditId),s.Cb(1),s.oc("ngIf",e.inputEditId&&!e.screenAcl.update),s.Cb(1),s.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[b.m,o.n,o.i,o.b,o.m,o.g,u.a,u.c,o.t,b.l,o.p,o.v],styles:[""]}),k),N=i("rEr+"),E=i("7zfz"),M=i("Mfq2"),w=["dataTable"];function T(t,e){if(1&t&&(s.Vb(0,"option",26),s.Lc(1),s.Ub()),2&t){var i=e.$implicit;s.oc("value",i.id),s.Cb(1),s.Mc(i.name)}}function O(t,e){if(1&t){var i=s.Wb();s.Vb(0,"tr"),s.Vb(1,"th",13),s.Lc(2,"Actions"),s.Ub(),s.Vb(3,"th",14),s.Lc(4,"Stage Name"),s.Qb(5,"p-sortIcon",15),s.Ub(),s.Vb(6,"th",16),s.Lc(7,"Stage Description"),s.Qb(8,"p-sortIcon",15),s.Ub(),s.Vb(9,"th",17),s.Lc(10,"No. Of Approvals"),s.Qb(11,"p-sortIcon",15),s.Ub(),s.Vb(12,"th",17),s.Lc(13,"No. Of Rejections"),s.Qb(14,"p-sortIcon",15),s.Ub(),s.Vb(15,"th",18),s.Lc(16,"Status"),s.Qb(17,"p-sortIcon",15),s.Ub(),s.Ub(),s.Vb(18,"tr",19),s.Vb(19,"th"),s.Vb(20,"a",20),s.dc("click",(function(){return s.Dc(i),s.hc(2).clearSearchForm()})),s.Qb(21,"i",21),s.Lc(22,"Clear"),s.Ub(),s.Ub(),s.Vb(23,"th"),s.Vb(24,"input",22),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.stageName=t}))("keyup.enter",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Ub(),s.Ub(),s.Vb(25,"th"),s.Vb(26,"input",22),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.stageDescription=t}))("keyup.enter",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Ub(),s.Ub(),s.Vb(27,"th"),s.Vb(28,"input",22),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.noOfApprovals=t}))("keyup.enter",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Ub(),s.Ub(),s.Vb(29,"th"),s.Vb(30,"input",22),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.noOfRejections=t}))("keyup.enter",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Ub(),s.Ub(),s.Vb(31,"th"),s.Vb(32,"select",23),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.status=t}))("change",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Lc(33,"> "),s.Vb(34,"option",24),s.Lc(35,"--SELECT--"),s.Ub(),s.Jc(36,T,2,2,"option",25),s.Ub(),s.Ub(),s.Ub()}if(2&t){var a=s.hc(2);s.Cb(3),s.oc("pSortableColumn","stageName"),s.Cb(2),s.oc("field","stageName"),s.Cb(1),s.oc("pSortableColumn","stageDescription"),s.Cb(2),s.oc("field","stageDescription"),s.Cb(1),s.oc("pSortableColumn","noOfApprovals"),s.Cb(2),s.oc("field","noOfApprovals"),s.Cb(1),s.oc("pSortableColumn","noOfRejections"),s.Cb(2),s.oc("field","noOfRejections"),s.Cb(1),s.oc("pSortableColumn","status"),s.Cb(2),s.oc("field","status"),s.Cb(7),s.oc("ngModel",a.searchForm.stageName),s.Cb(2),s.oc("ngModel",a.searchForm.stageDescription),s.Cb(2),s.oc("ngModel",a.searchForm.noOfApprovals),s.Cb(2),s.oc("ngModel",a.searchForm.noOfRejections),s.Cb(2),s.oc("ngModel",a.searchForm.status),s.Cb(4),s.oc("ngForOf",a.statusList)}}function R(t,e){if(1&t){var i=s.Wb();s.Vb(0,"tr"),s.Vb(1,"td"),s.Vb(2,"a",27),s.dc("click",(function(){s.Dc(i);var t=e.$implicit;return s.hc(2).showAddPopup(t.id)})),s.Qb(3,"i",28),s.Ub(),s.Ub(),s.Vb(4,"td"),s.Lc(5),s.Ub(),s.Vb(6,"td"),s.Lc(7),s.Ub(),s.Vb(8,"td"),s.Lc(9),s.Ub(),s.Vb(10,"td"),s.Lc(11),s.Ub(),s.Vb(12,"td"),s.Vb(13,"span",29),s.Lc(14),s.Ub(),s.Ub(),s.Ub()}if(2&t){var a=e.$implicit,r=s.hc(2);s.Cb(5),s.Mc(a.stageName),s.Cb(2),s.Mc(a.stageDescription),s.Cb(2),s.Mc(a.noOfApprovals),s.Cb(2),s.Mc(a.noOfRejections),s.Cb(2),s.oc("ngClass",r.appConstants.STATUS_COLOR_CLS[a.status]),s.Cb(1),s.Mc(a.statusName)}}function P(t,e){if(1&t){var i=s.Wb();s.Tb(0),s.Vb(1,"div",1),s.Vb(2,"span"),s.Lc(3,"A"),s.Ub(),s.Lc(4,"pproval Stages - List "),s.Vb(5,"div",2),s.Vb(6,"button",3),s.dc("click",(function(){return s.Dc(i),s.hc().showAddPopup()})),s.Qb(7,"i",4),s.Vb(8,"span"),s.Lc(9,"Add Approval Stages"),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(10,"div",5),s.Vb(11,"div",6),s.Vb(12,"div",7),s.Vb(13,"div",8),s.Vb(14,"p-table",9,10),s.dc("onLazyLoad",(function(t){return s.Dc(i),s.hc().getListing(t)})),s.Jc(16,O,37,16,"ng-template",11),s.Jc(17,R,15,6,"ng-template",12),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Sb()}if(2&t){var a=s.hc();s.Cb(14),s.oc("value",a.listing.data)("lazy",!0)("paginator",!0)("rows",a.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",a.listing.totalRecords)}}var J,_=((J=function(){function t(e,i,a,o,s,n){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.commonDataService=a,this.approvalStagesDataService=o,this.branchUtilsService=s,this.modalService=n,this.appConstants=r.h,this.screenAcl={},this.statusList=[],this.listing={data:[],totalRecords:0},this.searchForm={stageName:"",stageDescription:"",noOfApprovals:"",noOfRejections:"",status:"1"}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;if(this.screenAcl=this.authGuardService.getScreenAcl("56"),!this.screenAcl.view)return this.utilsService.showFailureMsg(r.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.getAutoSuggestionList("getCommonStatusList"),this.branchUtilsService.actionSaveUpdate.subscribe((function(e){"approval-stages"===e.triggerType&&t.resetListing()}))}},{key:"getListing",value:function(t){var e=this,i=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.approvalStagesDataService.getList(i).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"clearSearchForm",value:function(){this.searchForm={stageName:"",stageDescription:"",noOfApprovals:"",noOfRejections:"",status:"1"},this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"showAddPopup",value:function(t){var e={backdrop:"static"};e.initialState={inputEditId:t||""},this.modalService.show(D,e)}},{key:"getAutoSuggestionList",value:function(t){var e=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(i){"SUCCESS"===i.status?"getCommonStatusList"===t&&(e.statusList=i.results):e.utilsService.showFailureMsg(i)}))}}]),t}()).\u0275fac=function(t){return new(t||J)(s.Pb(r.g),s.Pb(r.a),s.Pb(n.l),s.Pb(n.d),s.Pb(l.a),s.Pb(c.b))},J.\u0275cmp=s.Jb({type:J,selectors:[["app-approval-stages-list"]],viewQuery:function(t,e){var i;1&t&&s.Pc(w,!0),2&t&&s.zc(i=s.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[2,"width","80px"],[2,"width","150px",3,"pSortableColumn"],[3,"field"],[2,"width","250px",3,"pSortableColumn"],[2,"width","100px",3,"pSortableColumn"],[2,"width","80px",3,"pSortableColumn"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"],[1,"badge",3,"ngClass"]],template:function(t,e){1&t&&s.Jc(0,P,18,5,"ng-container",0),2&t&&s.oc("ngIf",e.screenAcl.view)},directives:[b.m,N.c,E.b,N.b,N.a,M.a,o.b,o.m,o.o,o.t,o.p,o.v,b.l,b.k],styles:[""]}),J),x=i("LvDl");function z(t,e){if(1&t&&(s.Vb(0,"div",18),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",i.myFormErrors.remarks," ")}}function Q(t,e){if(1&t&&(s.Vb(0,"option",19),s.Lc(1),s.Ub()),2&t){var i=e.$implicit;s.oc("value",i.id),s.Cb(1),s.Mc(i.name)}}var j,q=((j=function(){function t(e,i,a,o,s,n){_classCallCheck(this,t),this.utilsService=e,this.commonDataService=i,this.activeModal=a,this.formBuilder=o,this.branchUtilsService=s,this.approvalStatusReportDataService=n,this.appConstants=r.h,this.statusList=[],this.myFormData={},this.myFormErrors={remarks:"",status:""},this.myFormValidationMsgs={remarks:{required:"Remarks is required"},status:{required:"Status is required"}}}return _createClass(t,[{key:"ngOnInit",value:function(){this.initializeForm(),this.getAutoSuggestionList("getApprovalStatusList"),this.get()}},{key:"initializeForm",value:function(){var t=this;this.myForm=this.formBuilder.group({remarks:["",[o.u.required]],status:["2",[o.u.required]]}),this.myForm.valueChanges.subscribe((function(e){t.utilsService.validation(t.myForm,t.myFormErrors,t.myFormValidationMsgs),t.myFormData=t.myForm.getRawValue()})),this.myFormData=this.myForm.getRawValue()}},{key:"saveUpdate",value:function(){var t=this;if(!this.myForm.valid)return this.utilsService.validation(this.myForm,this.myFormErrors,this.myFormValidationMsgs,!0),!1;this.approvalStatusReportDataService.update({approvalStatusReportId:this.inputEditId,status:this.myFormData.status,remarks:this.myFormData.remarks}).subscribe((function(e){"SUCCESS"===e.status?(t.utilsService.showSuccessMsg(e),t.branchUtilsService.actionSaveUpdate.next({triggerType:"approval-status-review"}),t.activeModal.hide()):t.utilsService.showFailureMsg(e)}))}},{key:"get",value:function(){}},{key:"clearForm",value:function(){this.initializeForm()}},{key:"getAutoSuggestionList",value:function(t,e){var i=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(a){"SUCCESS"===a.status?(i.utilsService.ifNotPushToList(a.results,e),"getApprovalStatusList"===t&&(i.statusList=x.filter(a.results,(function(t){return"Pending"!==t.name})))):i.utilsService.showFailureMsg(a)}))}}]),t}()).\u0275fac=function(t){return new(t||j)(s.Pb(r.g),s.Pb(n.l),s.Pb(c.a),s.Pb(o.e),s.Pb(l.a),s.Pb(n.e))},j.\u0275cmp=s.Jb({type:j,selectors:[["app-approval-status-review-popup"]],inputs:{inputEditId:"inputEditId"},decls:32,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],[1,"close",3,"click"],[1,"modal-body"],[1,"row",3,"formGroup"],[1,"form-group","col-sm-12"],[1,"form-label"],[1,"mandatory"],["type","text","formControlName","remarks",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],["formControlName","status",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"btn-group","text-right"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-times"],[1,"validation-error"],[3,"value"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Vb(1,"h5",1),s.Lc(2," Approval Status - Review "),s.Ub(),s.Vb(3,"button",2),s.dc("click",(function(){return e.activeModal.hide()})),s.Vb(4,"span"),s.Lc(5,"\xd7"),s.Ub(),s.Ub(),s.Ub(),s.Vb(6,"div",3),s.Vb(7,"div",4),s.Vb(8,"div",5),s.Vb(9,"label",6),s.Lc(10,"Remarks"),s.Vb(11,"span",7),s.Lc(12,"*"),s.Ub(),s.Ub(),s.Qb(13,"input",8),s.Jc(14,z,2,1,"div",9),s.Ub(),s.Vb(15,"div",5),s.Vb(16,"label",6),s.Lc(17,"Status"),s.Vb(18,"span",7),s.Lc(19,"*"),s.Ub(),s.Ub(),s.Vb(20,"select",10),s.Jc(21,Q,2,2,"option",11),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(22,"div",12),s.Vb(23,"div",13),s.Vb(24,"button",14),s.dc("click",(function(){return e.saveUpdate()})),s.Qb(25,"i",15),s.Vb(26,"span"),s.Lc(27,"Save"),s.Ub(),s.Ub(),s.Vb(28,"button",16),s.dc("click",(function(){return e.activeModal.hide()})),s.Qb(29,"i",17),s.Vb(30,"span"),s.Lc(31,"Cancel"),s.Ub(),s.Ub(),s.Ub(),s.Ub()),2&t&&(s.Cb(7),s.oc("formGroup",e.myForm),s.Cb(7),s.oc("ngIf",e.myFormErrors.remarks),s.Cb(7),s.oc("ngForOf",e.statusList))},directives:[o.n,o.i,o.b,o.m,o.g,b.m,o.t,b.l,o.p,o.v],styles:[""]}),j);function W(t,e){if(1&t&&(s.Vb(0,"tr"),s.Vb(1,"td"),s.Lc(2),s.Ub(),s.Vb(3,"td"),s.Lc(4),s.Ub(),s.Vb(5,"td"),s.Vb(6,"span",11),s.Lc(7),s.Ub(),s.Ub(),s.Vb(8,"td"),s.Lc(9),s.Ub(),s.Vb(10,"td"),s.Lc(11),s.Ub(),s.Ub()),2&t){var i=e.$implicit,a=e.index,r=s.hc();s.Cb(2),s.Mc(a+1),s.Cb(2),s.Mc(i.employeeName),s.Cb(2),s.oc("ngClass",r.appConstants.APPROVAL_STATUS_COLOR_CLS[i.approvalStatus]),s.Cb(1),s.Nc(" ",i.approvalStatusName,""),s.Cb(2),s.Mc(i.remarks),s.Cb(2),s.Mc(i.createdDateTime)}}function G(t,e){1&t&&(s.Vb(0,"tr"),s.Vb(1,"td",12),s.Lc(2,"No Records Found"),s.Ub(),s.Ub())}var $,B=function(){return{"max-height.px":300}},H=(($=function(){function t(e,i,a){_classCallCheck(this,t),this.utilsService=e,this.approvalStatusReportDataService=i,this.activeModal=a,this.appConstants=r.h,this.listingData=[]}return _createClass(t,[{key:"ngOnInit",value:function(){this.get()}},{key:"get",value:function(){var t=this;this.approvalStatusReportDataService.getHistory(this.inputEditId).subscribe((function(e){"SUCCESS"===e.status?t.listingData=e.results:t.utilsService.showFailureMsg(e)}))}}]),t}()).\u0275fac=function(t){return new(t||$)(s.Pb(r.g),s.Pb(n.e),s.Pb(c.a))},$.\u0275cmp=s.Jb({type:$,selectors:[["app-approval-history-popup"]],inputs:{inputEditId:"inputEditId"},decls:24,vars:4,consts:[[1,"modal-header"],[1,"modal-title"],[1,"close",3,"click"],[1,"modal-body"],[1,"table-responsive",3,"ngStyle"],[1,"table","table-striped","table-bordered"],[2,"width","40px"],[2,"width","100px"],[2,"width","250px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"badge",3,"ngClass"],["colspan","5"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Vb(1,"h5",1),s.Lc(2,"Approval Status - Histroy"),s.Ub(),s.Vb(3,"button",2),s.dc("click",(function(){return e.activeModal.hide()})),s.Vb(4,"span"),s.Lc(5,"\xd7"),s.Ub(),s.Ub(),s.Ub(),s.Vb(6,"div",3),s.Vb(7,"div",4),s.Vb(8,"table",5),s.Vb(9,"thead"),s.Vb(10,"tr"),s.Vb(11,"th",6),s.Lc(12,"S.No"),s.Ub(),s.Vb(13,"th",7),s.Lc(14,"Approver / Rejecter"),s.Ub(),s.Vb(15,"th",7),s.Lc(16,"Status"),s.Ub(),s.Vb(17,"th",8),s.Lc(18,"History"),s.Ub(),s.Vb(19,"th",7),s.Lc(20,"Date / Time"),s.Ub(),s.Ub(),s.Ub(),s.Vb(21,"tbody"),s.Jc(22,W,12,6,"tr",9),s.Jc(23,G,3,0,"tr",10),s.Ub(),s.Ub(),s.Ub(),s.Ub()),2&t&&(s.Cb(7),s.oc("ngStyle",s.rc(3,B)),s.Cb(15),s.oc("ngForOf",e.listingData),s.Cb(1),s.oc("ngIf",0===e.listingData.length))},directives:[b.n,b.l,b.m,b.k],styles:[""]}),$),K=["dataTable"];function Y(t,e){if(1&t&&(s.Vb(0,"option",24),s.Lc(1),s.Ub()),2&t){var i=e.$implicit;s.oc("value",i.id),s.Cb(1),s.Mc(i.name)}}function Z(t,e){if(1&t){var i=s.Wb();s.Vb(0,"tr"),s.Vb(1,"th",10),s.Lc(2,"Actions"),s.Ub(),s.Vb(3,"th",11),s.Lc(4,"Document Type"),s.Qb(5,"p-sortIcon",12),s.Ub(),s.Vb(6,"th",13),s.Lc(7," Document Number"),s.Ub(),s.Vb(8,"th",14),s.Lc(9,"Status"),s.Qb(10,"p-sortIcon",12),s.Ub(),s.Vb(11,"th",15),s.Lc(12,"Remarks"),s.Qb(13,"p-sortIcon",12),s.Ub(),s.Vb(14,"th",16),s.Lc(15,"Total Approved"),s.Ub(),s.Vb(16,"th",16),s.Lc(17,"Total Rejected"),s.Ub(),s.Ub(),s.Vb(18,"tr",17),s.Vb(19,"th"),s.Vb(20,"a",18),s.dc("click",(function(){return s.Dc(i),s.hc(2).clearSearchForm()})),s.Qb(21,"i",19),s.Lc(22,"Clear"),s.Ub(),s.Ub(),s.Vb(23,"th"),s.Vb(24,"input",20),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.documentTypeName=t}))("keyup.enter",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Ub(),s.Ub(),s.Qb(25,"th"),s.Vb(26,"th"),s.Vb(27,"select",21),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.approvalStatus=t}))("change",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Lc(28,"> "),s.Vb(29,"option",22),s.Lc(30,"--SELECT--"),s.Ub(),s.Jc(31,Y,2,2,"option",23),s.Ub(),s.Ub(),s.Vb(32,"th"),s.Vb(33,"input",20),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.remarks=t}))("keyup.enter",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Ub(),s.Ub(),s.Qb(34,"th"),s.Qb(35,"th"),s.Ub()}if(2&t){var a=s.hc(2);s.Cb(3),s.oc("pSortableColumn","documentTypeName"),s.Cb(2),s.oc("field","documentTypeName"),s.Cb(3),s.oc("pSortableColumn","approvalStatus"),s.Cb(2),s.oc("field","approvalStatus"),s.Cb(1),s.oc("pSortableColumn","remarks"),s.Cb(2),s.oc("field","remarks"),s.Cb(11),s.oc("ngModel",a.searchForm.documentTypeName),s.Cb(3),s.oc("ngModel",a.searchForm.approvalStatus),s.Cb(4),s.oc("ngForOf",a.statusList),s.Cb(2),s.oc("ngModel",a.searchForm.remarks)}}function X(t,e){if(1&t){var i=s.Wb();s.Vb(0,"a",30),s.dc("click",(function(){s.Dc(i);var t=s.hc().$implicit;return s.hc(2).showReviewPopup(t.id)})),s.Qb(1,"i",31),s.Ub()}}function tt(t,e){if(1&t){var i=s.Wb();s.Vb(0,"tr"),s.Vb(1,"td"),s.Jc(2,X,2,0,"a",25),s.Vb(3,"a",26),s.dc("click",(function(){s.Dc(i);var t=e.$implicit;return s.hc(2).showHistroyPopup(t.id)})),s.Qb(4,"i",27),s.Ub(),s.Ub(),s.Vb(5,"td"),s.Lc(6),s.Ub(),s.Vb(7,"td"),s.Vb(8,"a",28),s.dc("click",(function(){s.Dc(i);var t=e.$implicit;return s.hc(2).documentNavigation(t)})),s.Lc(9),s.Ub(),s.Ub(),s.Vb(10,"td"),s.Vb(11,"span",29),s.Lc(12),s.Ub(),s.Ub(),s.Vb(13,"td"),s.Lc(14),s.Ub(),s.Vb(15,"td"),s.Lc(16),s.Ub(),s.Vb(17,"td"),s.Lc(18),s.Ub(),s.Ub()}if(2&t){var a=e.$implicit,r=s.hc(2);s.Cb(2),s.oc("ngIf",r.storageService.get("userId")!==a.createdBy),s.Cb(4),s.Mc(a.documentTypeName),s.Cb(3),s.Mc(a.documentNumber),s.Cb(2),s.oc("ngClass",r.appConstants.APPROVAL_STATUS_COLOR_CLS[a.approvalStatus]),s.Cb(1),s.Mc(a.approvalStatusName),s.Cb(2),s.Mc(a.remarks),s.Cb(2),s.Mc(a.totalApproved),s.Cb(2),s.Mc(a.totalRejected)}}function et(t,e){if(1&t){var i=s.Wb();s.Tb(0),s.Vb(1,"div",1),s.Vb(2,"span"),s.Lc(3,"A"),s.Ub(),s.Lc(4,"pproval Status Report - List "),s.Ub(),s.Vb(5,"div",2),s.Vb(6,"div",3),s.Vb(7,"div",4),s.Vb(8,"div",5),s.Vb(9,"p-table",6,7),s.dc("onLazyLoad",(function(t){return s.Dc(i),s.hc().getListing(t)})),s.Jc(11,Z,36,10,"ng-template",8),s.Jc(12,tt,19,8,"ng-template",9),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Sb()}if(2&t){var a=s.hc();s.Cb(9),s.oc("value",a.listing.data)("lazy",!0)("paginator",!0)("rows",a.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",a.listing.totalRecords)}}var it,at=((it=function(){function t(e,i,a,o,s,n,c){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.commonDataService=a,this.approvalStatusReportDataService=o,this.branchUtilsService=s,this.storageService=n,this.modalService=c,this.appConstants=r.h,this.screenAcl={},this.statusList=[],this.listing={data:[],totalRecords:0},this.searchForm={documentTypeName:"",documentNumber:"",remarks:"",approvalStatus:"1"}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;if(this.screenAcl=this.authGuardService.getScreenAcl("58"),!this.screenAcl.view)return this.utilsService.showFailureMsg(r.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.getAutoSuggestionList("getApprovalStatusList"),this.branchUtilsService.actionSaveUpdate.subscribe((function(e){"approval-status-review"===e.triggerType&&t.resetListing()}))}},{key:"getListing",value:function(t){var e=this,i=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.approvalStatusReportDataService.getList(i).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"documentNavigation",value:function(t){var e=this;Object.entries(this.branchUtilsService.screenAttributes).forEach((function(i){var a=_slicedToArray(i,2),r=(a[0],a[1]),o=JSON.parse(JSON.stringify(r));o.documentTypeId===t.documentTypeId&&e.utilsService.redirect("/branch/".concat(o.module,"/").concat("1"===t.isDraft?o.draftRouteKey:o.editRouteKey,"/").concat(o.uiKey,"/").concat(t.documentId))}))}},{key:"clearSearchForm",value:function(){this.searchForm={documentTypeName:"",documentNumber:"",remarks:"",approvalStatus:"1"},this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"showReviewPopup",value:function(t){var e={backdrop:"static"};e.initialState={inputEditId:t},this.modalService.show(q,e)}},{key:"showHistroyPopup",value:function(t){var e={backdrop:"static"};e.initialState={inputEditId:t},this.modalService.show(H,e)}},{key:"getAutoSuggestionList",value:function(t){var e=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(i){"SUCCESS"===i.status?"getApprovalStatusList"===t&&(e.statusList=i.results):e.utilsService.showFailureMsg(i)}))}}]),t}()).\u0275fac=function(t){return new(t||it)(s.Pb(r.g),s.Pb(r.a),s.Pb(n.l),s.Pb(n.e),s.Pb(l.a),s.Pb(r.f),s.Pb(c.b))},it.\u0275cmp=s.Jb({type:it,selectors:[["app-approval-status-report-list"]],viewQuery:function(t,e){var i;1&t&&s.Pc(K,!0),2&t&&s.zc(i=s.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[2,"width","80px"],[2,"width","150px",3,"pSortableColumn"],[3,"field"],[2,"width","150px"],[2,"width","80px",3,"pSortableColumn"],[2,"width","250px",3,"pSortableColumn"],[2,"width","100px"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","action blue","placement","top","container","body","tooltip","Review",3,"click",4,"ngIf"],["placement","top","container","body","tooltip","Histroy",1,"action","yellow",3,"click"],["aria-hidden","true",1,"fa","fa-history"],["href","javascript:void(0)",3,"click"],[1,"badge",3,"ngClass"],["placement","top","container","body","tooltip","Review",1,"action","blue",3,"click"],[1,"fa","fa-tasks"]],template:function(t,e){1&t&&s.Jc(0,et,13,5,"ng-container",0),2&t&&s.oc("ngIf",e.screenAcl.view)},directives:[b.m,N.c,E.b,N.b,N.a,M.a,o.b,o.m,o.o,o.t,o.p,o.v,b.l,b.k],styles:[""]}),it);function rt(t,e){1&t&&(s.Tb(0),s.Lc(1,"Add"),s.Sb())}function ot(t,e){1&t&&(s.Tb(0),s.Lc(1,"Edit"),s.Sb())}function st(t,e){if(1&t&&(s.Vb(0,"div",24),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",i.myFormErrors.templateName," ")}}function nt(t,e){if(1&t&&(s.Vb(0,"div"),s.Lc(1),s.Vb(2,"small"),s.Lc(3),s.Ub(),s.Ub()),2&t){var i=e.item;s.Cb(1),s.Nc("",i.employeeName,"\xa0"),s.Cb(2),s.Nc("(",i.empCode,")")}}function ct(t,e){if(1&t&&(s.Vb(0,"div",24),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",i.myFormErrors.originatorId," ")}}function lt(t,e){if(1&t&&(s.Vb(0,"div",24),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",i.myFormErrors.documentId," ")}}function bt(t,e){if(1&t&&(s.Vb(0,"option",25),s.Lc(1),s.Ub()),2&t){var i=e.$implicit;s.oc("value",i.id),s.Cb(1),s.Mc(i.stageName)}}function ut(t,e){if(1&t&&(s.Vb(0,"div",24),s.Lc(1),s.Ub()),2&t){var i=s.hc();s.Cb(1),s.Nc(" ",i.myFormErrors.approvalStagesId," ")}}function pt(t,e){if(1&t&&(s.Vb(0,"option",25),s.Lc(1),s.Ub()),2&t){var i=e.$implicit;s.oc("value",i.id),s.Cb(1),s.Mc(i.name)}}function mt(t,e){if(1&t){var i=s.Wb();s.Vb(0,"button",26),s.dc("click",(function(){return s.Dc(i),s.hc().saveUpdate()})),s.Qb(1,"i",27),s.Vb(2,"span"),s.Lc(3,"Save"),s.Ub(),s.Ub()}}function dt(t,e){if(1&t){var i=s.Wb();s.Vb(0,"button",28),s.dc("click",(function(){return s.Dc(i),s.hc().clearForm()})),s.Qb(1,"i",29),s.Vb(2,"span"),s.Lc(3,"Clear"),s.Ub(),s.Ub()}}function ht(t,e){if(1&t){var i=s.Wb();s.Vb(0,"button",26),s.dc("click",(function(){return s.Dc(i),s.hc().saveUpdate()})),s.Qb(1,"i",30),s.Vb(2,"span"),s.Lc(3,"Update"),s.Ub(),s.Ub()}}function vt(t,e){if(1&t){var i=s.Wb();s.Vb(0,"button",28),s.dc("click",(function(){return s.Dc(i),s.hc().activeModal.hide()})),s.Qb(1,"i",31),s.Vb(2,"span"),s.Lc(3,"Cancel"),s.Ub(),s.Ub()}}function ft(t,e){1&t&&(s.Vb(0,"div",32),s.Vb(1,"span",33),s.Lc(2,"Note:"),s.Ub(),s.Lc(3," You are unauthorized to "),s.Vb(4,"strong"),s.Lc(5,"update"),s.Ub(),s.Lc(6," this transaction! "),s.Ub())}function gt(t,e){1&t&&(s.Vb(0,"div",32),s.Vb(1,"span",33),s.Lc(2,"Note:"),s.Ub(),s.Lc(3," You are unauthorized to "),s.Vb(4,"strong"),s.Lc(5,"add"),s.Ub(),s.Lc(6," this transaction!. "),s.Ub())}var St,yt=((St=function(){function t(e,i,a,o,s,n,c){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.commonDataService=a,this.activeModal=o,this.formBuilder=s,this.branchUtilsService=n,this.approvalTemplatesDataService=c,this.appConstants=r.h,this.screenAcl={},this.employeeList=[],this.statusList=[],this.screenList=[],this.approvalStagesList=[],this.myFormData={},this.myFormErrors={templateName:"",originatorId:"",documentId:"",approvalStagesId:""},this.myFormValidationMsgs={templateName:{required:"Template Name is required"},originatorId:{required:"Orignator is required"},documentId:{required:"Document Type is required"},approvalStagesId:{required:"Stages is required"}}}return _createClass(t,[{key:"ngOnInit",value:function(){this.screenAcl=this.authGuardService.getScreenAcl("57"),this.initializeForm(),this.getEmployeeList(),this.getApprovalProcessScreens(),this.getAutoSuggestionList("getCommonStatusList"),this.getAutoSuggestionList("getApprovalStagesList"),this.inputEditId&&this.get()}},{key:"initializeForm",value:function(){var t=this;this.myForm=this.formBuilder.group({templateName:["",[o.u.required]],templateDescription:[""],originatorId:["",[o.u.required]],documentId:["",[o.u.required]],approvalStagesId:["",[o.u.required]],status:["1"]}),this.myForm.valueChanges.subscribe((function(e){t.utilsService.validation(t.myForm,t.myFormErrors,t.myFormValidationMsgs),t.myFormData=t.myForm.getRawValue()})),this.myFormData=this.myForm.getRawValue()}},{key:"saveUpdate",value:function(){var t=this;if(!this.myForm.valid)return this.utilsService.validation(this.myForm,this.myFormErrors,this.myFormValidationMsgs,!0),!1;var e,i={templateName:this.myFormData.templateName,templateDescription:this.myFormData.templateDescription,originatorId:this.myFormData.originatorId.join(","),documentId:this.myFormData.documentId.join(","),approvalStagesId:this.myFormData.approvalStagesId,status:this.myFormData.status};this.inputEditId?(e="update",i.id=this.inputEditId):e="save",this.approvalTemplatesDataService[e](i).subscribe((function(e){"SUCCESS"===e.status?(t.utilsService.showSuccessMsg(e),t.branchUtilsService.actionSaveUpdate.next({triggerType:"approval-templates"}),t.activeModal.hide()):t.utilsService.showFailureMsg(e)}))}},{key:"get",value:function(){var t=this;this.approvalTemplatesDataService.get(this.inputEditId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results[0],a=i.documentId.split(",").map(Number);t.myForm.patchValue({templateName:i.templateName,templateDescription:i.templateDescription,originatorId:i.originatorId.split(","),documentId:a,approvalStagesId:i.approvalStagesId,status:i.status})}else t.utilsService.showFailureMsg(e)}))}},{key:"clearForm",value:function(){this.initializeForm()}},{key:"getAutoSuggestionList",value:function(t,e){var i=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(a){"SUCCESS"===a.status?(i.utilsService.ifNotPushToList(a.results,e),"getCommonStatusList"===t?i.statusList=a.results:"getApprovalStagesList"===t?i.approvalStagesList=a.results:"getApprovalProcessScreens"===t&&(i.screenList=a.results)):i.utilsService.showFailureMsg(a)}))}},{key:"getEmployeeList",value:function(t){var e=this;this.commonDataService.getEmployeeList(2).subscribe((function(i){"SUCCESS"===i.status?(e.utilsService.ifNotPushToList(i.results,t),e.employeeList=i.results.map((function(t){return t.searchText=t.employeeName+" - "+t.empCode,t}))):e.utilsService.showFailureMsg(i)}))}},{key:"getApprovalProcessScreens",value:function(){var t=this;this.commonDataService.getApprovalProcessScreens().subscribe((function(e){"SUCCESS"===e.status?t.screenList=e.results:t.utilsService.showFailureMsg(e)}))}}]),t}()).\u0275fac=function(t){return new(t||St)(s.Pb(r.g),s.Pb(r.a),s.Pb(n.l),s.Pb(c.a),s.Pb(o.e),s.Pb(l.a),s.Pb(n.f))},St.\u0275cmp=s.Jb({type:St,selectors:[["app-approval-templates-add-popup"]],inputs:{inputEditId:"inputEditId"},decls:61,vars:19,consts:[[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],[1,"close",3,"click"],[1,"modal-body"],[1,"row",3,"formGroup"],[1,"form-group","col-sm-12"],[1,"form-label"],[1,"mandatory"],["type","text","formControlName","templateName",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],["type","text","formControlName","templateDescription",1,"form-control","form-control-sm"],["formControlName","originatorId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["ng-option-tmp",""],["formControlName","documentId","bindLabel","screenName","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["formControlName","approvalStagesId",1,"form-control","form-control-sm"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","status",1,"form-control","form-control-sm"],[1,"modal-footer"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],[1,"validation-error"],[3,"value"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-broom"],[1,"fa","fa-sync"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Vb(1,"h5",1),s.Jc(2,rt,2,0,"ng-container",2),s.Jc(3,ot,2,0,"ng-container",2),s.Lc(4," Approval Templates "),s.Ub(),s.Vb(5,"button",3),s.dc("click",(function(){return e.activeModal.hide()})),s.Vb(6,"span"),s.Lc(7,"\xd7"),s.Ub(),s.Ub(),s.Ub(),s.Vb(8,"div",4),s.Vb(9,"div",5),s.Vb(10,"div",6),s.Vb(11,"label",7),s.Lc(12,"Template Name"),s.Vb(13,"span",8),s.Lc(14,"*"),s.Ub(),s.Ub(),s.Qb(15,"input",9),s.Jc(16,st,2,1,"div",10),s.Ub(),s.Vb(17,"div",6),s.Vb(18,"label",7),s.Lc(19,"Template Description"),s.Ub(),s.Qb(20,"input",11),s.Ub(),s.Vb(21,"div",6),s.Vb(22,"label",7),s.Lc(23,"Originator"),s.Vb(24,"span",8),s.Lc(25,"*"),s.Ub(),s.Ub(),s.Vb(26,"ng-select",12),s.Jc(27,nt,4,2,"ng-template",13),s.Ub(),s.Jc(28,ct,2,1,"div",10),s.Ub(),s.Vb(29,"div",6),s.Vb(30,"label",7),s.Lc(31,"Document Type"),s.Vb(32,"span",8),s.Lc(33,"*"),s.Ub(),s.Ub(),s.Qb(34,"ng-select",14),s.Jc(35,lt,2,1,"div",10),s.Ub(),s.Vb(36,"div",6),s.Vb(37,"label",7),s.Lc(38,"Stages Type"),s.Vb(39,"span",8),s.Lc(40,"*"),s.Ub(),s.Ub(),s.Vb(41,"select",15),s.Vb(42,"option",16),s.Lc(43,"--SELECT--"),s.Ub(),s.Jc(44,bt,2,2,"option",17),s.Ub(),s.Jc(45,ut,2,1,"div",10),s.Ub(),s.Vb(46,"div",6),s.Vb(47,"label",7),s.Lc(48,"Status"),s.Vb(49,"span",8),s.Lc(50,"*"),s.Ub(),s.Ub(),s.Vb(51,"select",18),s.Jc(52,pt,2,2,"option",17),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(53,"div",19),s.Vb(54,"div",20),s.Jc(55,mt,4,0,"button",21),s.Jc(56,dt,4,0,"button",22),s.Jc(57,ht,4,0,"button",21),s.Jc(58,vt,4,0,"button",22),s.Ub(),s.Jc(59,ft,7,0,"div",23),s.Jc(60,gt,7,0,"div",23),s.Ub()),2&t&&(s.Cb(2),s.oc("ngIf",!e.inputEditId),s.Cb(1),s.oc("ngIf",e.inputEditId),s.Cb(6),s.oc("formGroup",e.myForm),s.Cb(7),s.oc("ngIf",e.myFormErrors.templateName),s.Cb(10),s.oc("items",e.employeeList)("multiple",!0),s.Cb(2),s.oc("ngIf",e.myFormErrors.originatorId),s.Cb(6),s.oc("items",e.screenList)("multiple",!0),s.Cb(1),s.oc("ngIf",e.myFormErrors.documentId),s.Cb(9),s.oc("ngForOf",e.approvalStagesList),s.Cb(1),s.oc("ngIf",e.myFormErrors.approvalStagesId),s.Cb(7),s.oc("ngForOf",e.statusList),s.Cb(3),s.oc("ngIf",e.screenAcl.add&&!e.inputEditId),s.Cb(1),s.oc("ngIf",!e.inputEditId),s.Cb(1),s.oc("ngIf",e.screenAcl.update&&e.inputEditId),s.Cb(1),s.oc("ngIf",e.inputEditId),s.Cb(1),s.oc("ngIf",e.inputEditId&&!e.screenAcl.update),s.Cb(1),s.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[b.m,o.n,o.i,o.b,o.m,o.g,u.a,u.c,o.t,o.p,o.v,b.l],styles:[""]}),St),Ut=["dataTable"];function Ct(t,e){if(1&t&&(s.Vb(0,"option",25),s.Lc(1),s.Ub()),2&t){var i=e.$implicit;s.oc("value",i.id),s.Cb(1),s.Mc(i.name)}}function Lt(t,e){if(1&t){var i=s.Wb();s.Vb(0,"tr"),s.Vb(1,"th",13),s.Lc(2,"Actions"),s.Ub(),s.Vb(3,"th",14),s.Lc(4,"Template Name"),s.Qb(5,"p-sortIcon",15),s.Ub(),s.Vb(6,"th",16),s.Lc(7,"Template Description"),s.Qb(8,"p-sortIcon",15),s.Ub(),s.Vb(9,"th",17),s.Lc(10,"Status"),s.Qb(11,"p-sortIcon",15),s.Ub(),s.Ub(),s.Vb(12,"tr",18),s.Vb(13,"th"),s.Vb(14,"a",19),s.dc("click",(function(){return s.Dc(i),s.hc(2).clearSearchForm()})),s.Qb(15,"i",20),s.Lc(16,"Clear"),s.Ub(),s.Ub(),s.Vb(17,"th"),s.Vb(18,"input",21),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.templateName=t}))("keyup.enter",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Ub(),s.Ub(),s.Vb(19,"th"),s.Vb(20,"input",21),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.templateDescription=t}))("keyup.enter",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Ub(),s.Ub(),s.Vb(21,"th"),s.Vb(22,"select",22),s.dc("ngModelChange",(function(t){return s.Dc(i),s.hc(2).searchForm.status=t}))("change",(function(){return s.Dc(i),s.hc(2).resetListing()})),s.Lc(23,"> "),s.Vb(24,"option",23),s.Lc(25,"--SELECT--"),s.Ub(),s.Jc(26,Ct,2,2,"option",24),s.Ub(),s.Ub(),s.Ub()}if(2&t){var a=s.hc(2);s.Cb(3),s.oc("pSortableColumn","templateName"),s.Cb(2),s.oc("field","templateName"),s.Cb(1),s.oc("pSortableColumn","templateDescription"),s.Cb(2),s.oc("field","templateDescription"),s.Cb(1),s.oc("pSortableColumn","status"),s.Cb(2),s.oc("field","status"),s.Cb(7),s.oc("ngModel",a.searchForm.templateName),s.Cb(2),s.oc("ngModel",a.searchForm.templateDescription),s.Cb(2),s.oc("ngModel",a.searchForm.status),s.Cb(4),s.oc("ngForOf",a.statusList)}}function Vt(t,e){if(1&t){var i=s.Wb();s.Vb(0,"tr"),s.Vb(1,"td"),s.Vb(2,"a",26),s.dc("click",(function(){s.Dc(i);var t=e.$implicit;return s.hc(2).showAddPopup(t.id)})),s.Qb(3,"i",27),s.Ub(),s.Ub(),s.Vb(4,"td"),s.Lc(5),s.Ub(),s.Vb(6,"td"),s.Lc(7),s.Ub(),s.Vb(8,"td"),s.Vb(9,"span",28),s.Lc(10),s.Ub(),s.Ub(),s.Ub()}if(2&t){var a=e.$implicit,r=s.hc(2);s.Cb(5),s.Mc(a.templateName),s.Cb(2),s.Mc(a.templateDescription),s.Cb(2),s.oc("ngClass",r.appConstants.STATUS_COLOR_CLS[a.status]),s.Cb(1),s.Mc(a.statusName)}}function Ft(t,e){if(1&t){var i=s.Wb();s.Tb(0),s.Vb(1,"div",1),s.Vb(2,"span"),s.Lc(3,"A"),s.Ub(),s.Lc(4,"pproval Templates - List "),s.Vb(5,"div",2),s.Vb(6,"button",3),s.dc("click",(function(){return s.Dc(i),s.hc().showAddPopup()})),s.Qb(7,"i",4),s.Vb(8,"span"),s.Lc(9,"Add Approval Templates"),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(10,"div",5),s.Vb(11,"div",6),s.Vb(12,"div",7),s.Vb(13,"div",8),s.Vb(14,"p-table",9,10),s.dc("onLazyLoad",(function(t){return s.Dc(i),s.hc().getListing(t)})),s.Jc(16,Lt,27,10,"ng-template",11),s.Jc(17,Vt,11,4,"ng-template",12),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Sb()}if(2&t){var a=s.hc();s.Cb(14),s.oc("value",a.listing.data)("lazy",!0)("paginator",!0)("rows",a.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",a.listing.totalRecords)}}var It,At,kt=a.h.forChild([{path:"approval-stages-list",component:_},{path:"approval-templates-list",component:(It=function(){function t(e,i,a,o,s,n){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.commonDataService=a,this.approvalTemplatesDataService=o,this.branchUtilsService=s,this.modalService=n,this.appConstants=r.h,this.screenAcl={},this.statusList=[],this.listing={data:[],totalRecords:0},this.searchForm={templateName:"",templateDescription:"",status:"1"}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;if(this.screenAcl=this.authGuardService.getScreenAcl("57"),!this.screenAcl.view)return this.utilsService.showFailureMsg(r.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.getAutoSuggestionList("getCommonStatusList"),this.branchUtilsService.actionSaveUpdate.subscribe((function(e){"approval-templates"===e.triggerType&&t.resetListing()}))}},{key:"getListing",value:function(t){var e=this,i=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.approvalTemplatesDataService.getList(i).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"clearSearchForm",value:function(){this.searchForm={templateName:"",templateDescription:"",status:"1"},this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"showAddPopup",value:function(t){var e={backdrop:"static"};e.initialState={inputEditId:t||""},this.modalService.show(yt,e)}},{key:"getAutoSuggestionList",value:function(t){var e=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(i){"SUCCESS"===i.status?"getCommonStatusList"===t&&(e.statusList=i.results):e.utilsService.showFailureMsg(i)}))}}]),t}(),It.\u0275fac=function(t){return new(t||It)(s.Pb(r.g),s.Pb(r.a),s.Pb(n.l),s.Pb(n.f),s.Pb(l.a),s.Pb(c.b))},It.\u0275cmp=s.Jb({type:It,selectors:[["app-approval-templates-list"]],viewQuery:function(t,e){var i;1&t&&s.Pc(Ut,!0),2&t&&s.zc(i=s.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[2,"width","80px"],[2,"width","150px",3,"pSortableColumn"],[3,"field"],[2,"width","250px",3,"pSortableColumn"],[2,"width","80px",3,"pSortableColumn"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"],[1,"badge",3,"ngClass"]],template:function(t,e){1&t&&s.Jc(0,Ft,18,5,"ng-container",0),2&t&&s.oc("ngIf",e.screenAcl.view)},directives:[b.m,N.c,E.b,N.b,N.a,M.a,o.b,o.m,o.o,o.t,o.p,o.v,b.l,b.k],styles:[""]}),It)},{path:"approval-status-report-list",component:at}]),Dt=i("o+NB"),Nt=((At=function t(){_classCallCheck(this,t)}).\u0275mod=s.Nb({type:At}),At.\u0275inj=s.Mb({factory:function(t){return new(t||At)},imports:[[kt,Dt.BranchModule]]}),At)}}]);