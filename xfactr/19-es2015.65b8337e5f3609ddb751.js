(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{FP8e:function(t,e,i){"use strict";i.r(e),i.d(e,"InventoryModule",(function(){return Qs}));var s=i("tyNb"),r=i("ey9i"),n=i("fXoL"),o=i("oARB"),c=i("IzNV"),a=i("fIZe"),b=i("ofXK"),u=i("rEr+"),m=i("7zfz"),l=i("Mfq2"),d=i("3Pt+");const h=["dataTable"];function p(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",15),n.dc("click",(function(){return n.Dc(t),n.hc(2).downloadAsExcel()})),n.Qb(1,"i",16),n.Vb(2,"span"),n.Lc(3,"Download as Excel"),n.Ub(),n.Ub()}}function f(t,e){1&t&&n.Qb(0,"col",22)}function g(t,e){if(1&t&&(n.Vb(0,"colgroup"),n.Qb(1,"col",17),n.Jc(2,f,1,0,"col",18),n.Qb(3,"col",19),n.Qb(4,"col",20),n.Qb(5,"col",21),n.Qb(6,"col",21),n.Qb(7,"col",21),n.Ub()),2&t){const t=n.hc(2);n.Cb(2),n.oc("ngIf",t.storageService.get("isSap"))}}function L(t,e){1&t&&(n.Vb(0,"th",24),n.Lc(1,"Sap No"),n.Qb(2,"p-sortIcon",25),n.Ub()),2&t&&(n.oc("pSortableColumn","sapId"),n.Cb(2),n.oc("field","sapId"))}function v(t,e){if(1&t){const t=n.Wb();n.Vb(0,"th"),n.Vb(1,"input",29),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(3).searchForm.sapId=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(3).resetListing()})),n.Ub(),n.Ub()}if(2&t){const t=n.hc(3);n.Cb(1),n.oc("ngModel",t.searchForm.sapId)}}function y(t,e){if(1&t&&(n.Vb(0,"option",33),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Nc(" ",t.groupName," ")}}function S(t,e){if(1&t&&(n.Vb(0,"option",33),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Nc(" ",t.name," ")}}function C(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"th"),n.Lc(2,"Actions"),n.Ub(),n.Jc(3,L,3,2,"th",23),n.Vb(4,"th"),n.Lc(5,"Item Image"),n.Ub(),n.Vb(6,"th",24),n.Lc(7,"Item Name"),n.Qb(8,"p-sortIcon",25),n.Ub(),n.Vb(9,"th",24),n.Lc(10,"Stock"),n.Qb(11,"p-sortIcon",25),n.Ub(),n.Vb(12,"th",24),n.Lc(13,"Item Group"),n.Qb(14,"p-sortIcon",25),n.Ub(),n.Vb(15,"th",24),n.Lc(16,"Status"),n.Qb(17,"p-sortIcon",25),n.Ub(),n.Ub(),n.Vb(18,"tr",26),n.Vb(19,"th"),n.Vb(20,"a",27),n.dc("click",(function(){return n.Dc(t),n.hc(2).clearSearchForm()})),n.Qb(21,"i",28),n.Lc(22,"Clear"),n.Ub(),n.Ub(),n.Jc(23,v,2,1,"th",0),n.Qb(24,"th"),n.Vb(25,"th"),n.Vb(26,"input",29),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.itemName=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(27,"th"),n.Vb(28,"input",29),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.stock=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(29,"th"),n.Vb(30,"select",30),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.itemGroupId=e}))("change",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Vb(31,"option",31),n.Lc(32,"--SELECT--"),n.Ub(),n.Jc(33,y,2,2,"option",32),n.Ub(),n.Ub(),n.Vb(34,"th"),n.Vb(35,"select",30),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.status=e}))("change",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Vb(36,"option",31),n.Lc(37,"--SELECT--"),n.Ub(),n.Jc(38,S,2,2,"option",32),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=n.hc(2);n.Cb(3),n.oc("ngIf",t.storageService.get("isSap")),n.Cb(3),n.oc("pSortableColumn","itemName"),n.Cb(2),n.oc("field","itemName"),n.Cb(1),n.oc("pSortableColumn","stock"),n.Cb(2),n.oc("field","stock"),n.Cb(1),n.oc("pSortableColumn","itemGroupId"),n.Cb(2),n.oc("field","itemGroupId"),n.Cb(1),n.oc("pSortableColumn","status"),n.Cb(2),n.oc("field","status"),n.Cb(6),n.oc("ngIf",t.storageService.get("isSap")),n.Cb(3),n.oc("ngModel",t.searchForm.itemName),n.Cb(2),n.oc("ngModel",t.searchForm.stock),n.Cb(2),n.oc("ngModel",t.searchForm.itemGroupId),n.Cb(3),n.oc("ngForOf",t.itemGroupList),n.Cb(2),n.oc("ngModel",t.searchForm.status),n.Cb(3),n.oc("ngForOf",t.statusList)}}function U(t,e){if(1&t&&(n.Vb(0,"td"),n.Lc(1),n.Ub()),2&t){const t=n.hc().$implicit;n.Cb(1),n.Mc(t.sapId)}}function I(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"td"),n.Vb(2,"a",34),n.Qb(3,"i",35),n.Ub(),n.Ub(),n.Jc(4,U,2,1,"td",0),n.Vb(5,"td"),n.Qb(6,"img",36),n.Ub(),n.Vb(7,"td"),n.Lc(8),n.Ub(),n.Vb(9,"td"),n.Lc(10),n.Vb(11,"a",37),n.dc("click",(function(){n.Dc(t);const i=e.$implicit;return n.hc(2).popupExternalService.showDetailPopup("item",i.id)})),n.Lc(12,"Check Stock"),n.Ub(),n.Ub(),n.Vb(13,"td"),n.Lc(14),n.Ub(),n.Vb(15,"td"),n.Vb(16,"span",38),n.Lc(17),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=e.$implicit,i=n.hc(2);n.Cb(2),n.qc("routerLink","/branch/inventory/item-edit/",i.utilsService.encrypt(t.id),""),n.Cb(2),n.oc("ngIf",i.storageService.get("isSap")),n.Cb(2),n.oc("src",t.itemImgUrl?t.itemImgUrl:i.appConstants.DEFAULT_IMAGE_ICON,n.Fc),n.Cb(2),n.Oc("",t.itemCode," - ",t.itemName,""),n.Cb(2),n.Nc("",t.stock," "),n.Cb(4),n.Mc(t.groupName),n.Cb(2),n.oc("ngClass",i.appConstants.STATUS_COLOR_CLS[t.status]),n.Cb(1),n.Nc(" ",t.statusName," ")}}function V(t,e){if(1&t){const t=n.Wb();n.Tb(0),n.Vb(1,"div",1),n.Vb(2,"span"),n.Lc(3,"I"),n.Ub(),n.Lc(4,"tem Master Data - List "),n.Vb(5,"div",2),n.Jc(6,p,4,0,"button",3),n.Vb(7,"button",4),n.Qb(8,"i",5),n.Vb(9,"span"),n.Lc(10,"Add Item"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(11,"div",6),n.Vb(12,"div",7),n.Vb(13,"div",8),n.Vb(14,"div",9),n.Vb(15,"p-table",10,11),n.dc("onLazyLoad",(function(e){return n.Dc(t),n.hc().getListing(e)})),n.Jc(17,g,8,1,"ng-template",12),n.Jc(18,C,39,16,"ng-template",13),n.Jc(19,I,18,9,"ng-template",14),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Sb()}if(2&t){const t=n.hc();n.Cb(6),n.oc("ngIf",t.screenAcl.download),n.Cb(9),n.oc("value",t.listing.data)("lazy",!0)("paginator",!0)("rows",t.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",t.listing.totalRecords)}}let F=(()=>{class t{constructor(t,e,i,s,n,o,c){this.utilsService=t,this.storageService=e,this.authGuardService=i,this.commonDataService=s,this.itemDataService=n,this.branchUtilsService=o,this.popupExternalService=c,this.appConstants=r.h,this.screenAcl={},this.itemGroupList=[],this.statusList=[],this.listingProperties={},this.listing={data:[],totalRecords:0},this.searchForm={sapId:"",itemName:"",itemGroupId:"",status:"1",stock:""}}ngOnInit(){if(this.screenAcl=this.authGuardService.getScreenAcl("15"),!this.screenAcl.view)return this.utilsService.showFailureMsg(r.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.getAutoSuggestionList("getCommonStatusList"),this.getAutoSuggestionList("getItemGroupList")}getListing(t){const e=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.listingProperties=e,this.itemDataService.getList(e).subscribe(t=>{"SUCCESS"===t.status?(this.listing.data=t.results.searchResults,this.listing.totalRecords=t.results.totalRecords):this.utilsService.showFailureMsg(t)})}clearSearchForm(){this.searchForm={sapId:"",itemName:"",itemGroupId:"",status:"1",stock:""},this.resetListing()}resetListing(){this.dataTable.reset()}getAutoSuggestionList(t){this.commonDataService.getAutoSuggestionList(t).subscribe(e=>{if("SUCCESS"===e.status){let i="";"getItemGroupList"===t?i="itemGroupList":"getCommonStatusList"===t&&(i="statusList"),this[i]=e.results}else this.utilsService.showFailureMsg(e)})}downloadAsExcel(){this.itemDataService.downloadAsExcel(this.listingProperties).subscribe(t=>{"SUCCESS"===t.status?this.utilsService.externalRedirect(t.fileUrl):this.utilsService.showFailureMsg(t)})}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.g),n.Pb(r.f),n.Pb(r.a),n.Pb(o.l),n.Pb(o.B),n.Pb(c.a),n.Pb(a.a))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-item-list"]],viewQuery:function(t,e){var i;1&t&&n.Pc(h,!0),2&t&&n.zc(i=n.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],["class","btn btn-success btn-sm",3,"click",4,"ngIf"],["routerLink","/branch/inventory/item-add",1,"btn","btn-primary","btn-sm"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa","fa-file-excel"],[2,"width","80px"],["style","width:90px",4,"ngIf"],[2,"width","100px"],[2,"width","200px"],[2,"width","120px"],[2,"width","90px"],[3,"pSortableColumn",4,"ngIf"],[3,"pSortableColumn"],[3,"field"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"routerLink"],[1,"fa","fa-edit"],["height","20px",3,"src"],[1,"link",3,"click"],[1,"badge",3,"ngClass"]],template:function(t,e){1&t&&n.Jc(0,V,20,6,"ng-container",0),2&t&&n.oc("ngIf",e.screenAcl.view)},directives:[b.m,s.e,u.c,m.b,u.b,u.a,l.a,d.b,d.m,d.o,d.t,d.p,d.v,b.l,s.g,b.k],styles:[""]}),t})();var D=i("LvDl"),N=i("w9rb"),E=i("K3ix"),T=i("ZOsW");function P(t,e){1&t&&(n.Tb(0),n.Lc(1,"Add"),n.Sb())}function A(t,e){1&t&&(n.Tb(0),n.Lc(1,"Edit"),n.Sb())}function w(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.documentNumberingId?t.myFormErrors1.documentNumberingId:t.myFormErrors1.documentNumber," ")}}function x(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.itemCode," ")}}function M(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.itemName," ")}}function k(t,e){if(1&t&&(n.Vb(0,"option",62),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Mc(t.groupName)}}function W(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.itemGroupId," ")}}function B(t,e){if(1&t&&(n.Vb(0,"option",62),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Mc(t.uomName)}}function Q(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.uomId," ")}}function J(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.priceListId," ")}}function O(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.unitPrice," ")}}const R=function(){return{standalone:!0}};function K(t,e){if(1&t){const t=n.Wb();n.Tb(0),n.Vb(1,"label",63),n.Vb(2,"input",64),n.dc("ngModelChange",(function(i){return n.Dc(t),e.$implicit.flag=i})),n.Ub(),n.Qb(3,"span",65),n.Lc(4),n.Ub(),n.Lc(5,"\xa0\xa0 "),n.Sb()}if(2&t){const t=e.$implicit;n.Cb(2),n.oc("ngModel",t.flag)("ngModelOptions",n.rc(3,R)),n.Cb(2),n.Nc("",t.name," ")}}function q(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.manufacturerName,"\xa0"),n.Cb(2),n.Nc("(",t.manufacturerCode,")")}}function G(t,e){if(1&t&&(n.Vb(0,"option",62),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Nc(" ",t.name," ")}}function z(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.status," ")}}function _(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.warehouseName,"\xa0"),n.Cb(2),n.Nc("(",t.warehouseCode,")")}}function j(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){const t=n.hc().index,e=n.hc();n.Cb(1),n.Nc(" ",e.myFormErrors1.warehouseListArray[t].warehouseId," ")}}function $(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){const t=n.hc().index,e=n.hc();n.Cb(1),n.Nc(" ",e.myFormErrors1.warehouseListArray[t].binId," ")}}function H(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr",66),n.Vb(1,"td"),n.Vb(2,"a",67),n.dc("click",(function(){n.Dc(t);const i=e.index;return n.hc().removeWarehouseFields(i)})),n.Qb(3,"i",68),n.Ub(),n.Ub(),n.Vb(4,"td"),n.Vb(5,"ng-select",69),n.dc("change",(function(){n.Dc(t);const i=e.index;return n.hc().setBinList(i)})),n.Jc(6,_,4,2,"ng-template",44),n.Ub(),n.Jc(7,j,2,1,"div",25),n.Ub(),n.Vb(8,"td"),n.Qb(9,"ng-select",70),n.Jc(10,$,2,1,"div",25),n.Ub(),n.Ub()}if(2&t){const t=e.index,i=n.hc();n.oc("formGroupName",t),n.Cb(5),n.oc("items",i.warehouseList)("multiple",!1),n.Cb(2),n.oc("ngIf",i.myFormErrors1.warehouseListArray[t].warehouseId),n.Cb(2),n.oc("items",i.myForm1Data.warehouseListArray[t].binList)("multiple",!1),n.Cb(1),n.oc("ngIf",i.myFormErrors1.warehouseListArray[t].binId)}}function Y(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",71),n.dc("click",(function(){return n.Dc(t),n.hc().saveUpdate()})),n.Qb(1,"i",72),n.Vb(2,"span"),n.Lc(3,"Save"),n.Ub(),n.Ub()}}function Z(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",3),n.dc("click",(function(){return n.Dc(t),n.hc().clearForm()})),n.Qb(1,"i",73),n.Vb(2,"span"),n.Lc(3,"Clear"),n.Ub(),n.Ub()}}function X(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",71),n.dc("click",(function(){return n.Dc(t),n.hc().saveUpdate()})),n.Qb(1,"i",74),n.Vb(2,"span"),n.Lc(3,"Update"),n.Ub(),n.Ub()}}function tt(t,e){1&t&&(n.Vb(0,"button",75),n.Qb(1,"i",76),n.Vb(2,"span"),n.Lc(3,"Cancel"),n.Ub(),n.Ub())}function et(t,e){1&t&&(n.Vb(0,"div",79),n.Vb(1,"span",80),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"update"),n.Ub(),n.Lc(6," this transaction! "),n.Ub())}function it(t,e){if(1&t&&(n.Vb(0,"div",77),n.Vb(1,"div"),n.Vb(2,"strong"),n.Lc(3,"Created By:"),n.Ub(),n.Lc(4),n.Ub(),n.Jc(5,et,7,0,"div",78),n.Ub()),2&t){const t=n.hc();n.Cb(4),n.Nc(" ",t.editCreatedName,""),n.Cb(1),n.oc("ngIf",!t.screenAcl.update)}}function st(t,e){1&t&&(n.Vb(0,"div",77),n.Vb(1,"span",80),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"add"),n.Ub(),n.Lc(6," this transaction!. "),n.Ub())}let rt=(()=>{class t{constructor(t,e,i,s,n,o,c,a,b,u){this.utilsService=t,this.storageService=e,this.authGuardService=i,this.activatedRoute=s,this.commonDataService=n,this.itemDataService=o,this.branchUtilsService=c,this.formBuilder=a,this.popupExternalService=b,this.modalService=u,this.appConstants=r.h,this.screenAcl={},this.documentNumberingList=[],this.itemGroupList=[],this.uomList=[],this.itemTypeList=[],this.manufacturerList=[],this.hsnList=[],this.statusList=[],this.warehouseList=[],this.photoUrl="",this.priceList=[],this.myForm1Data={},this.myFormErrors1={documentNumberingId:"",documentNumber:"",itemCode:"",itemName:"",itemGroupId:"",uomId:"",unitPrice:"",itemWeight:"",priceListId:"",status:"",warehouseListArray:[]},this.myFormValidationMsgs1={documentNumberingId:{required:"Document No is required"},documentNumber:{required:"Document No is required"},itemCode:{required:"Item code is required"},itemName:{required:"Item name is required"},itemGroupId:{required:"Item group is required"},uomId:{required:"UOM is required"},priceListId:{required:"Price List is required"},unitPrice:{required:"Unit price is required",pattern:"Only positive numbers are allowed"},status:{required:"Status is required"},warehouseListArray:{warehouseId:{required:"WareHouse is required"},binId:{required:"Bin is required"}}}}ngOnInit(){if(this.screenAcl=this.authGuardService.getScreenAcl("15"),!this.screenAcl.view)return this.utilsService.showFailureMsg(r.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.initializeForm1(),this.initializeSubscriptions(),this.getAutoSuggestionList("getCommonStatusList")}ngAfterViewInit(){this.attachmentsComponent.loadAttachments(this.inputEditId)}initializeSubscriptions(){this.activatedRoute.params.subscribe(t=>{t.id?(this.inputEditId=this.utilsService.decrypt(t.id),this.get()):(this.branchUtilsService.getMasterDocumentNumbering(this.myForm1,this.branchUtilsService.screenAttributes.masterItem.documentTypeId).subscribe(t=>{this.documentNumberingList=t}),this.getAutoSuggestionList("getItemGroupList"),this.getAutoSuggestionList("getUomList"),this.getAutoSuggestionList("getManufacturerList"),this.getAutoSuggestionList("getHsnList"),this.getAutoSuggestionList("getPriceList"),this.getItemTxnTypeList(),this.getWarehouseList())}),this.branchUtilsService.actionSaveUpdate.subscribe(t=>{"item-group"===t.triggerType?this.getAutoSuggestionList("getItemGroupList"):"uom"===t.triggerType?this.getAutoSuggestionList("getUomList"):"hsn"===t.triggerType&&this.getAutoSuggestionList("getHsnList")})}initializeForm1(){this.myForm1=this.formBuilder.group({itemImage:[""],documentNumberingId:[null,[d.u.required]],documentNumber:["",[d.u.required]],documentNumberingType:[""],itemCode:["",[d.u.required]],itemName:["",[d.u.required]],foreignName:[""],stock:[{value:0,disabled:!0}],itemGroupId:["",[d.u.required]],uomId:["",[d.u.required]],unitPrice:["",[d.u.required,d.u.pattern(r.h.VALIDATION_PATTERNS.positiveFloatNumber)]],priceListId:[null,[d.u.required]],itemWeight:[""],manufacturerId:[null],hsnId:[null],remarks:[""],status:["1",[d.u.required]],deletedWarehouseChildIds:[[]],warehouseListArray:this.formBuilder.array([this.initWarehouseFields()])}),this.myForm1.valueChanges.subscribe(t=>{this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1),this.myForm1Data=this.myForm1.getRawValue()}),this.myForm1Data=this.myForm1.getRawValue(),this.removeWarehouseFields(0)}addWarehouseFields(t){this.myForm1.controls.warehouseListArray.push(this.initWarehouseFields(t))}initWarehouseFields(t){this.myFormErrors1.warehouseListArray.push({warehouseId:"",binId:""});const e={warehouseId:[null,[d.u.required]],binId:[null,[d.u.required]],binList:[[]],id:[""]};return t&&(this.utilsService.updateObject(e,"warehouseId",t.warehouseId),this.utilsService.updateObject(e,"binId",t.binId),this.utilsService.updateObject(e,"id",t.id)),this.formBuilder.group(e)}removeWarehouseFields(t){const e=this.myForm1Data.warehouseListArray[t].id;if(e){const t=this.myForm1Data.deletedWarehouseChildIds;t.push(e),this.myForm1.patchValue({deletedWarehouseChildIds:t})}this.myForm1.controls.warehouseListArray.removeAt(t)}saveUpdate(){if(this.checkMultipleSameWarehouse())return!1;if(!this.myForm1.valid)return this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1,!0),!1;const t=this.itemTypeList.filter(t=>t.flag).map(t=>t.id),e={itemImage:this.myForm1Data.itemImage,documentNumberingId:this.myForm1Data.documentNumberingId,documentNumber:this.myForm1Data.documentNumber,documentNumberingType:this.myForm1Data.documentNumberingType,itemCode:this.myForm1Data.itemCode,itemName:this.myForm1Data.itemName,foreignName:this.myForm1Data.foreignName,stock:this.myForm1Data.stock,itemGroupId:this.myForm1Data.itemGroupId,uomId:this.myForm1Data.uomId,unitPrice:this.myForm1Data.unitPrice,itemWeight:this.myForm1Data.itemWeight,priceListId:this.myForm1Data.priceListId,itemTransactionType:t.join(","),manufacturerId:this.myForm1Data.manufacturerId,hsnId:this.myForm1Data.hsnId,remarks:this.myForm1Data.remarks,status:this.myForm1Data.status,warehouseListArray:[]};let i;this.myForm1Data.warehouseListArray.forEach(t=>{e.warehouseListArray.push({warehouseId:t.warehouseId,binId:t.binId,id:t.id})}),this.inputEditId?(i="update",e.id=this.inputEditId,e.deletedWarehouseChildIds=this.myForm1Data.deletedWarehouseChildIds):i="save",this.itemDataService[i](e).subscribe(t=>{"SUCCESS"===t.status?(this.utilsService.showSuccessMsg(t),this.attachmentsComponent.save("save"===i?t.sId:this.inputEditId)):this.utilsService.showFailureMsg(t)})}get(){this.itemDataService.get(this.inputEditId).subscribe(t=>{if("SUCCESS"===t.status){const e=t.results[0];this.photoUrl=e.itemImgUrl;const i={};this.utilsService.updateObject(i,"documentNumberingId",e.documentNumberingId),this.utilsService.updateObject(i,"documentNumber",e.documentNumber),this.utilsService.updateObject(i,"documentNumberingType",e.documentNumberingInfo.length>0?e.documentNumberingInfo[0].documentNumberingType:""),this.utilsService.updateObject(i,"itemImage",e.itemImage),this.utilsService.updateObject(i,"itemCode",e.itemCode),this.utilsService.updateObject(i,"itemName",e.itemName),this.utilsService.updateObject(i,"foreignName",e.foreignName),this.utilsService.updateObject(i,"stock",e.stock),this.utilsService.updateObject(i,"itemGroupId",e.itemGroupId),this.utilsService.updateObject(i,"uomId",e.uomId),this.utilsService.updateObject(i,"unitPrice",e.unitPrice),this.utilsService.updateObject(i,"itemWeight",e.itemWeight),this.utilsService.updateObject(i,"manufacturerId",e.manufacturerId),this.utilsService.updateObject(i,"hsnId",e.hsnId),this.utilsService.updateObject(i,"remarks",e.remarks),this.utilsService.updateObject(i,"status",e.status),this.utilsService.updateObject(i,"priceListId",e.lastPriceListId),this.myForm1.patchValue(i),this.branchUtilsService.getMasterDocumentNumbering(this.myForm1,this.branchUtilsService.screenAttributes.masterItem.documentTypeId,"edit",e.documentNumberingInfo).subscribe(t=>{this.documentNumberingList=t}),this.getAutoSuggestionList("getItemGroupList",e.itemGroupInfo),this.getAutoSuggestionList("getUomList",e.uomInfo),this.getAutoSuggestionList("getManufacturerList",e.manufacturerInfo),this.getAutoSuggestionList("getHsnList",e.hsnInfo),this.getAutoSuggestionList("getPriceList",e.priceListInfo),this.getItemTxnTypeList(!0,e);const s=[];e.warehouseListArray.forEach((t,e)=>{this.addWarehouseFields(t),t.warehouseInfo[0]&&s.push(t.warehouseInfo[0])}),this.getWarehouseList(!0,s,e),this.myForm1.controls.itemCode.disable(),this.myForm1.controls.documentNumberingId.disable(),this.myForm1.controls.documentNumber.disable(),this.editCreatedName=e.createdByInfo[0].employeeName}else this.utilsService.showFailureMsg(t)})}clearForm(){this.initializeForm1()}uploadImage(t){this.itemDataService.imageUpload(t.target.files||t.srcElement.files).subscribe(t=>{"SUCCESS"===t.status?(this.myForm1.patchValue({itemImage:t.results.fileName}),this.photoUrl=t.results.fullUrl):this.utilsService.showFailureMsg(t)})}checkMultipleSameWarehouse(){const t=new Set;return this.myForm1Data.warehouseListArray.forEach(e=>{t.add(e.warehouseId)}),this.myForm1Data.warehouseListArray.length!==t.size&&(this.utilsService.showFailureMsg("Not allowed to select duplicate warehouse!"),!0)}onItemPriceChange(){this.myForm1Data.priceListId&&this.inputEditId&&this.commonDataService.getItemPriceValue({itemId:this.inputEditId,priceListId:this.myForm1Data.priceListId,type:"MASTERITEM"}).subscribe(t=>{"SUCCESS"===t.status?this.myForm1.patchValue({unitPrice:t.results.unitPrice}):this.utilsService.showFailureMsg(t)})}redirectToList(){this.utilsService.redirect("/branch/inventory/item-list")}getAutoSuggestionList(t,e){this.commonDataService.getAutoSuggestionList(t).subscribe(i=>{"SUCCESS"===i.status?(this.utilsService.ifNotPushToList(i.results,e),"getItemGroupList"===t?this.itemGroupList=i.results:"getUomList"===t?this.uomList=i.results:"getManufacturerList"===t?this.manufacturerList=i.results.map(t=>(t.searchText=t.manufacturerName+" - "+t.manufacturerCode,t)):"getHsnList"===t?this.hsnList=i.results:"getCommonStatusList"===t?this.statusList=i.results:"getPriceList"===t&&(this.priceList=i.results)):this.utilsService.showFailureMsg(i)})}getItemTxnTypeList(t,e){this.commonDataService.getAutoSuggestionList("getItemTransactionTypeList").subscribe(i=>{"SUCCESS"===i.status?this.itemTypeList=i.results.map(i=>{if(t){if(!this.utilsService.isEmpty(e.itemTransactionType)){const t=e.itemTransactionType.split(",");i.flag=t.indexOf(i.id)>=0}}else i.flag=!0;return i}):this.utilsService.showFailureMsg(i)})}getWarehouseList(t,e,i){this.commonDataService.getAutoSuggestionList("getWarehouseList").subscribe(s=>{"SUCCESS"===s.status?(this.warehouseList=s.results.map(t=>(t.searchText=t.warehouseName+" - "+t.warehouseCode,t)),t&&(this.utilsService.ifNotPushToList(s.results,e),i.warehouseListArray.forEach((t,e)=>{this.setBinList(e,!0,t.binInfo)}))):this.utilsService.showFailureMsg(s)})}setBinList(t,e,i){const s=this.myForm1.controls.warehouseListArray.at(t),r=this.myForm1Data.warehouseListArray[t].warehouseId;if(s.patchValue({binList:[]}),e||s.patchValue({binId:null}),!this.utilsService.isEmpty(r)){const t=D.findIndex(this.warehouseList,{id:r});s.patchValue({binList:this.warehouseList[t].binList}),e&&this.utilsService.ifNotPushToList(s.controls.binList.value,i)}}onKeydownHandler(t){t.ctrlKey&&"s"===t.key.toLowerCase()&&(this.saveUpdate(),t.preventDefault())}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.g),n.Pb(r.f),n.Pb(r.a),n.Pb(s.a),n.Pb(o.l),n.Pb(o.B),n.Pb(c.a),n.Pb(d.e),n.Pb(a.a),n.Pb(E.b))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-item-add"]],viewQuery:function(t,e){var i;1&t&&n.Pc(N.a,!0),2&t&&n.zc(i=n.ec())&&(e.attachmentsComponent=i.first)},hostBindings:function(t,e){1&t&&n.dc("keydown",(function(t){return e.onKeydownHandler(t)}),!1,n.Bc)},decls:180,vars:30,consts:[[1,"page-title"],[4,"ngIf"],[1,"btn-group"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-arrow-left"],[1,"working-container",3,"formGroup"],[1,"box"],[1,"box-header"],[1,"fa","fa-angle-right"],[1,"box-body","box-form"],[1,"row"],[1,"col-sm-3"],[1,"form-group"],[1,"form-label"],[1,"image-container"],[3,"src"],["type","file",3,"change"],["type","hidden","formControlName","itemImage"],[1,"small-text"],[1,"col-sm-9"],[1,"form-group","col-sm-4"],[1,"mandatory"],[1,"col-sm-6"],["formControlName","documentNumberingId","bindLabel","documentNumberingName","bindValue","id","placeholder","--SELECT--",3,"items","change"],["type","text","formControlName","documentNumber",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],["type","text","formControlName","itemCode",1,"form-control","form-control-sm"],["type","text","formControlName","itemName",1,"form-control","form-control-sm"],["type","text","formControlName","foreignName",1,"form-control","form-control-sm"],["type","text","formControlName","stock",1,"form-control","form-control-sm"],[1,"action-control"],["formControlName","itemGroupId",1,"form-control","form-control-sm"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"click"],[1,"fa","fa-plus"],["formControlName","uomId",1,"form-control","form-control-sm"],["formControlName","priceListId","bindLabel","priceListName","bindValue","id","placeholder","--SELECT--",3,"items","change"],["type","text","formControlName","unitPrice",1,"form-control","form-control-sm"],["type","number","formControlName","itemWeight",1,"form-control","form-control-sm"],[1,"form-group","col-sm-auto"],[4,"ngFor","ngForOf"],[1,"form-group","col-sm-3"],["formControlName","manufacturerId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["ng-option-tmp",""],["formControlName","hsnId","bindLabel","hsnCode","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["formControlName","remarks",1,"form-control","form-control-sm"],["formControlName","status",1,"form-control","form-control-sm"],[1,"box-body","box-table"],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],["formArrayName","warehouseListArray"],[3,"formGroupName",4,"ngFor","ngForOf"],["colspan","3"],[1,"btn","btn-success","btn-sm",3,"click"],[3,"type","doSuccess"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm","routerLink","/branch/inventory/item-list",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],[1,"validation-error"],[3,"value"],[1,"checkbox"],["type","checkbox",3,"ngModel","ngModelOptions","ngModelChange"],[1,"checkmark"],[3,"formGroupName"],["placement","top","container","body","tooltip","Delete",1,"action","red",3,"click"],[1,"fa","fa-minus-circle"],["formControlName","warehouseId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple","change"],["formControlName","binId","bindLabel","binName","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"fa","fa-broom"],[1,"fa","fa-redo-alt"],["routerLink","/branch/inventory/item-list",1,"btn","btn-secondary","btn-sm"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],["class","mt-2",4,"ngIf"],[1,"mt-2"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(n.Vb(0,"div",0),n.Vb(1,"span"),n.Lc(2,"I"),n.Ub(),n.Lc(3,"tem Master Data - "),n.Jc(4,P,2,0,"ng-container",1),n.Jc(5,A,2,0,"ng-container",1),n.Vb(6,"div",2),n.Vb(7,"button",3),n.dc("click",(function(){return e.utilsService.goBack()})),n.Qb(8,"i",4),n.Vb(9,"span"),n.Lc(10,"Back"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(11,"div",5),n.Vb(12,"div",6),n.Vb(13,"div",7),n.Qb(14,"i",8),n.Lc(15,"Item Info "),n.Ub(),n.Vb(16,"div",9),n.Vb(17,"div",10),n.Vb(18,"div",11),n.Vb(19,"div",12),n.Vb(20,"label",13),n.Lc(21,"Item Image"),n.Ub(),n.Vb(22,"div",14),n.Qb(23,"img",15),n.Ub(),n.Vb(24,"input",16),n.dc("change",(function(t){return e.uploadImage(t)})),n.Ub(),n.Qb(25,"input",17),n.Vb(26,"div",18),n.Lc(27,"Only jpg, png are allowed. Maximum 2 Mb"),n.Ub(),n.Ub(),n.Ub(),n.Vb(28,"div",19),n.Vb(29,"div",10),n.Vb(30,"div",20),n.Vb(31,"label",13),n.Lc(32,"Doc No"),n.Vb(33,"span",21),n.Lc(34,"*"),n.Ub(),n.Ub(),n.Vb(35,"div",10),n.Vb(36,"div",22),n.Vb(37,"ng-select",23),n.dc("change",(function(){return e.branchUtilsService.onDocumentNumberingChange(e.documentNumberingList,e.myForm1)})),n.Ub(),n.Ub(),n.Vb(38,"div",22),n.Qb(39,"input",24),n.Ub(),n.Ub(),n.Jc(40,w,2,1,"div",25),n.Ub(),n.Vb(41,"div",20),n.Vb(42,"label",13),n.Lc(43,"Item Code"),n.Vb(44,"span",21),n.Lc(45,"*"),n.Ub(),n.Ub(),n.Qb(46,"input",26),n.Jc(47,x,2,1,"div",25),n.Ub(),n.Vb(48,"div",20),n.Vb(49,"label",13),n.Lc(50,"Item Name"),n.Vb(51,"span",21),n.Lc(52,"*"),n.Ub(),n.Ub(),n.Qb(53,"input",27),n.Jc(54,M,2,1,"div",25),n.Ub(),n.Vb(55,"div",20),n.Vb(56,"label",13),n.Lc(57,"Foreign Name"),n.Ub(),n.Qb(58,"input",28),n.Ub(),n.Vb(59,"div",20),n.Vb(60,"label",13),n.Lc(61,"Stock"),n.Ub(),n.Qb(62,"input",29),n.Ub(),n.Vb(63,"div",20),n.Vb(64,"label",13),n.Lc(65,"Item Group"),n.Vb(66,"span",21),n.Lc(67,"*"),n.Ub(),n.Ub(),n.Vb(68,"div",30),n.Vb(69,"select",31),n.Vb(70,"option",32),n.Lc(71,"--SELECT--"),n.Ub(),n.Jc(72,k,2,2,"option",33),n.Ub(),n.Vb(73,"span"),n.Vb(74,"a",34),n.dc("click",(function(){return e.popupExternalService.showAddPopup("item-group")})),n.Qb(75,"i",35),n.Ub(),n.Ub(),n.Ub(),n.Jc(76,W,2,1,"div",25),n.Ub(),n.Vb(77,"div",20),n.Vb(78,"label",13),n.Lc(79,"UOM"),n.Vb(80,"span",18),n.Lc(81,"(Unit of Measure)"),n.Ub(),n.Vb(82,"span",21),n.Lc(83,"*"),n.Ub(),n.Ub(),n.Vb(84,"div",30),n.Vb(85,"select",36),n.Vb(86,"option",32),n.Lc(87,"--SELECT--"),n.Ub(),n.Jc(88,B,2,2,"option",33),n.Ub(),n.Vb(89,"a",34),n.dc("click",(function(){return e.popupExternalService.showAddPopup("uom")})),n.Qb(90,"i",35),n.Ub(),n.Ub(),n.Jc(91,Q,2,1,"div",25),n.Ub(),n.Vb(92,"div",20),n.Vb(93,"label",13),n.Lc(94,"Price List"),n.Vb(95,"span",21),n.Lc(96,"*"),n.Ub(),n.Ub(),n.Vb(97,"ng-select",37),n.dc("change",(function(){return e.onItemPriceChange()})),n.Ub(),n.Jc(98,J,2,1,"div",25),n.Ub(),n.Vb(99,"div",20),n.Vb(100,"label",13),n.Lc(101,"Unit Price"),n.Vb(102,"span",21),n.Lc(103,"*"),n.Ub(),n.Ub(),n.Qb(104,"input",38),n.Jc(105,O,2,1,"div",25),n.Ub(),n.Vb(106,"div",20),n.Vb(107,"label",13),n.Lc(108,"Item Weight (Kg)"),n.Ub(),n.Qb(109,"input",39),n.Ub(),n.Vb(110,"div",40),n.Qb(111,"label",13),n.Jc(112,K,6,4,"ng-container",41),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(113,"div",6),n.Vb(114,"div",7),n.Qb(115,"i",8),n.Lc(116,"General Info "),n.Ub(),n.Vb(117,"div",9),n.Vb(118,"div",10),n.Vb(119,"div",42),n.Vb(120,"label",13),n.Lc(121,"Manufacturer"),n.Ub(),n.Vb(122,"ng-select",43),n.Jc(123,q,4,2,"ng-template",44),n.Ub(),n.Ub(),n.Vb(124,"div",42),n.Vb(125,"label",13),n.Lc(126,"HSN"),n.Ub(),n.Vb(127,"div",30),n.Qb(128,"ng-select",45),n.Vb(129,"span"),n.Vb(130,"a",34),n.dc("click",(function(){return e.popupExternalService.showAddPopup("hsn")})),n.Qb(131,"i",35),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(132,"div",42),n.Vb(133,"label",13),n.Lc(134,"Remarks"),n.Ub(),n.Qb(135,"textarea",46),n.Ub(),n.Vb(136,"div",42),n.Vb(137,"label",13),n.Lc(138,"Status"),n.Vb(139,"span",21),n.Lc(140,"*"),n.Ub(),n.Ub(),n.Vb(141,"select",47),n.Jc(142,G,2,2,"option",33),n.Ub(),n.Jc(143,z,2,1,"div",25),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(144,"div",6),n.Vb(145,"div",7),n.Qb(146,"i",8),n.Lc(147,"Warehouse Info "),n.Ub(),n.Vb(148,"div",48),n.Vb(149,"div",49),n.Vb(150,"table",50),n.Vb(151,"thead"),n.Vb(152,"tr"),n.Vb(153,"th"),n.Lc(154,"Action"),n.Ub(),n.Vb(155,"th"),n.Lc(156,"Warehouse"),n.Vb(157,"span",21),n.Lc(158,"*"),n.Ub(),n.Ub(),n.Vb(159,"th"),n.Lc(160,"Bin Location"),n.Vb(161,"span",21),n.Lc(162,"*"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(163,"tbody",51),n.Jc(164,H,11,7,"tr",52),n.Ub(),n.Vb(165,"tfoot"),n.Vb(166,"tr"),n.Vb(167,"td",53),n.Vb(168,"button",54),n.dc("click",(function(){return e.addWarehouseFields()})),n.Qb(169,"i",35),n.Vb(170,"span"),n.Lc(171,"Add"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(172,"app-attachments",55),n.dc("doSuccess",(function(){return e.redirectToList()})),n.Ub(),n.Vb(173,"div",56),n.Jc(174,Y,4,0,"button",57),n.Jc(175,Z,4,0,"button",58),n.Jc(176,X,4,0,"button",57),n.Jc(177,tt,4,0,"button",59),n.Ub(),n.Jc(178,it,6,2,"div",60),n.Jc(179,st,7,0,"div",60),n.Ub()),2&t&&(n.Cb(4),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(6),n.oc("formGroup",e.myForm1),n.Cb(12),n.oc("src",e.photoUrl?e.photoUrl:e.appConstants.DEFAULT_IMAGE_ICON,n.Fc),n.Cb(14),n.oc("items",e.documentNumberingList),n.Cb(3),n.oc("ngIf",e.myFormErrors1.documentNumberingId||e.myFormErrors1.documentNumber),n.Cb(7),n.oc("ngIf",e.myFormErrors1.itemCode),n.Cb(7),n.oc("ngIf",e.myFormErrors1.itemName),n.Cb(18),n.oc("ngForOf",e.itemGroupList),n.Cb(4),n.oc("ngIf",e.myFormErrors1.itemGroupId),n.Cb(12),n.oc("ngForOf",e.uomList),n.Cb(3),n.oc("ngIf",e.myFormErrors1.uomId),n.Cb(6),n.oc("items",e.priceList),n.Cb(1),n.oc("ngIf",e.myFormErrors1.priceListId),n.Cb(7),n.oc("ngIf",e.myFormErrors1.unitPrice),n.Cb(7),n.oc("ngForOf",e.itemTypeList),n.Cb(10),n.oc("items",e.manufacturerList)("multiple",!1),n.Cb(6),n.oc("items",e.hsnList)("multiple",!1),n.Cb(14),n.oc("ngForOf",e.statusList),n.Cb(1),n.oc("ngIf",e.myFormErrors1.status),n.Cb(21),n.oc("ngForOf",e.myForm1.controls.warehouseListArray.controls),n.Cb(8),n.oc("type",e.branchUtilsService.screenAttributes.masterItem.backendKey),n.Cb(2),n.oc("ngIf",e.screenAcl.add&&!e.inputEditId),n.Cb(1),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.screenAcl.update&&e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(1),n.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[b.m,d.n,d.i,d.b,d.m,d.g,T.a,d.t,d.p,d.v,b.l,d.q,T.c,d.d,N.a,d.a,d.o,d.j,l.a,s.e],styles:[""]}),t})();function nt(t,e){1&t&&(n.Tb(0),n.Lc(1,"Add"),n.Sb())}function ot(t,e){1&t&&(n.Tb(0),n.Lc(1,"Edit"),n.Sb())}function ct(t,e){if(1&t&&(n.Vb(0,"div",19),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.binCode," ")}}function at(t,e){if(1&t&&(n.Vb(0,"div",19),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.binName," ")}}function bt(t,e){if(1&t&&(n.Vb(0,"option",20),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Mc(t.name)}}function ut(t,e){if(1&t&&(n.Vb(0,"div",19),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors1.status," ")}}function mt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",21),n.dc("click",(function(){return n.Dc(t),n.hc().saveUpdate()})),n.Qb(1,"i",22),n.Vb(2,"span"),n.Lc(3,"Save"),n.Ub(),n.Ub()}}function lt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",23),n.dc("click",(function(){return n.Dc(t),n.hc().clearForm()})),n.Qb(1,"i",24),n.Vb(2,"span"),n.Lc(3,"Clear"),n.Ub(),n.Ub()}}function dt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",21),n.dc("click",(function(){return n.Dc(t),n.hc().saveUpdate()})),n.Qb(1,"i",25),n.Vb(2,"span"),n.Lc(3,"Update"),n.Ub(),n.Ub()}}function ht(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",23),n.dc("click",(function(){return n.Dc(t),n.hc().activeModal.hide()})),n.Qb(1,"i",26),n.Vb(2,"span"),n.Lc(3,"Cancel"),n.Ub(),n.Ub()}}function pt(t,e){1&t&&(n.Vb(0,"div",27),n.Vb(1,"span",28),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"update"),n.Ub(),n.Lc(6," this transaction! "),n.Ub())}function ft(t,e){1&t&&(n.Vb(0,"div",27),n.Vb(1,"span",28),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"add"),n.Ub(),n.Lc(6," this transaction!. "),n.Ub())}let gt=(()=>{class t{constructor(t,e,i,s,r,n,o){this.utilsService=t,this.authGuardService=e,this.commonDataService=i,this.binDataService=s,this.branchUtilsService=r,this.activeModal=n,this.formBuilder=o,this.screenAcl={},this.statusList=[],this.myForm1Data={},this.myFormErrors1={binCode:"",binName:"",status:""},this.myFormValidationMsgs1={binCode:{required:"Code is required"},binName:{required:"Name is required"},status:{required:"Status is required"}}}ngOnInit(){this.screenAcl=this.authGuardService.getScreenAcl("27"),this.initializeForm1(),this.getAutoSuggestionList("getCommonStatusList"),this.inputEditId&&this.get()}initializeForm1(){this.myForm1=this.formBuilder.group({binCode:["",[d.u.required]],binName:["",[d.u.required]],status:["1",[d.u.required]]}),this.myForm1.valueChanges.subscribe(t=>{this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1),this.myForm1Data=this.myForm1.getRawValue()}),this.myForm1Data=this.myForm1.getRawValue()}saveUpdate(){if(!this.myForm1.valid)return this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1,!0),!1;const t={binCode:this.myForm1Data.binCode,binName:this.myForm1Data.binName,status:this.myForm1Data.status};let e;this.inputEditId?(e="update",t.id=this.inputEditId):e="save",this.binDataService[e](t).subscribe(t=>{"SUCCESS"===t.status?(this.utilsService.showSuccessMsg(t),this.branchUtilsService.actionSaveUpdate.next({triggerType:"bin-location"}),this.activeModal.hide()):this.utilsService.showFailureMsg(t)})}get(){this.binDataService.get(this.inputEditId).subscribe(t=>{if("SUCCESS"===t.status){const e=t.results[0];this.myForm1.patchValue({binCode:e.binCode,binName:e.binName,status:e.status})}else this.utilsService.showFailureMsg(t)})}clearForm(){this.initializeForm1()}getAutoSuggestionList(t){this.commonDataService.getAutoSuggestionList(t).subscribe(e=>{"SUCCESS"===e.status?"getCommonStatusList"===t&&(this.statusList=e.results):this.utilsService.showFailureMsg(e)})}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.g),n.Pb(r.a),n.Pb(o.l),n.Pb(o.i),n.Pb(c.a),n.Pb(E.a),n.Pb(d.e))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-bin-add-popup"]],decls:40,vars:13,consts:[[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],[1,"close",3,"click"],[1,"modal-body"],[1,"row",3,"formGroup"],[1,"form-group","col-sm-6"],[1,"form-label"],[1,"mandatory"],["type","text","formControlName","binCode",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],["type","text","formControlName","binName",1,"form-control","form-control-sm"],["formControlName","status",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],[1,"validation-error"],[3,"value"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-broom"],[1,"fa","fa-sync"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(n.Vb(0,"div",0),n.Vb(1,"h5",1),n.Lc(2," Bin Location Master Data - "),n.Jc(3,nt,2,0,"ng-container",2),n.Jc(4,ot,2,0,"ng-container",2),n.Ub(),n.Vb(5,"button",3),n.dc("click",(function(){return e.activeModal.hide()})),n.Vb(6,"span"),n.Lc(7,"\xd7"),n.Ub(),n.Ub(),n.Ub(),n.Vb(8,"div",4),n.Vb(9,"div",5),n.Vb(10,"div",6),n.Vb(11,"label",7),n.Lc(12,"Code"),n.Vb(13,"span",8),n.Lc(14,"*"),n.Ub(),n.Ub(),n.Qb(15,"input",9),n.Jc(16,ct,2,1,"div",10),n.Ub(),n.Vb(17,"div",6),n.Vb(18,"label",7),n.Lc(19,"Name"),n.Vb(20,"span",8),n.Lc(21,"*"),n.Ub(),n.Ub(),n.Qb(22,"input",11),n.Jc(23,at,2,1,"div",10),n.Ub(),n.Vb(24,"div",6),n.Vb(25,"label",7),n.Lc(26,"Status"),n.Vb(27,"span",8),n.Lc(28,"*"),n.Ub(),n.Ub(),n.Vb(29,"select",12),n.Jc(30,bt,2,2,"option",13),n.Ub(),n.Jc(31,ut,2,1,"div",10),n.Ub(),n.Ub(),n.Ub(),n.Vb(32,"div",14),n.Vb(33,"div",15),n.Jc(34,mt,4,0,"button",16),n.Jc(35,lt,4,0,"button",17),n.Jc(36,dt,4,0,"button",16),n.Jc(37,ht,4,0,"button",17),n.Ub(),n.Jc(38,pt,7,0,"div",18),n.Jc(39,ft,7,0,"div",18),n.Ub()),2&t&&(n.Cb(3),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(5),n.oc("formGroup",e.myForm1),n.Cb(7),n.oc("ngIf",e.myFormErrors1.binCode),n.Cb(7),n.oc("ngIf",e.myFormErrors1.binName),n.Cb(7),n.oc("ngForOf",e.statusList),n.Cb(1),n.oc("ngIf",e.myFormErrors1.status),n.Cb(3),n.oc("ngIf",e.screenAcl.add&&!e.inputEditId),n.Cb(1),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.screenAcl.update&&e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId&&!e.screenAcl.update),n.Cb(1),n.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[b.m,d.n,d.i,d.b,d.m,d.g,d.t,b.l,d.p,d.v],styles:[""]}),t})();const Lt=["dataTable"];function vt(t,e){1&t&&(n.Vb(0,"colgroup"),n.Qb(1,"col",14),n.Qb(2,"col",15),n.Qb(3,"col",16),n.Qb(4,"col",17),n.Ub())}function yt(t,e){if(1&t&&(n.Vb(0,"option",27),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Mc(t.name)}}function St(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"th"),n.Lc(2,"Actions"),n.Ub(),n.Vb(3,"th",18),n.Lc(4,"Bin Code"),n.Qb(5,"p-sortIcon",19),n.Ub(),n.Vb(6,"th",18),n.Lc(7,"Bin Name"),n.Qb(8,"p-sortIcon",19),n.Ub(),n.Vb(9,"th",18),n.Lc(10,"Status"),n.Qb(11,"p-sortIcon",19),n.Ub(),n.Ub(),n.Vb(12,"tr",20),n.Vb(13,"th"),n.Vb(14,"a",21),n.dc("click",(function(){return n.Dc(t),n.hc(2).clearSearchForm()})),n.Qb(15,"i",22),n.Lc(16,"Clear"),n.Ub(),n.Ub(),n.Vb(17,"th"),n.Vb(18,"input",23),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.binCode=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(19,"th"),n.Vb(20,"input",23),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.binName=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(21,"th"),n.Vb(22,"select",24),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.status=e}))("change",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Vb(23,"option",25),n.Lc(24,"--SELECT--"),n.Ub(),n.Jc(25,yt,2,2,"option",26),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=n.hc(2);n.Cb(3),n.oc("pSortableColumn","binCode"),n.Cb(2),n.oc("field","binCode"),n.Cb(1),n.oc("pSortableColumn","binName"),n.Cb(2),n.oc("field","binName"),n.Cb(1),n.oc("pSortableColumn","status"),n.Cb(2),n.oc("field","status"),n.Cb(7),n.oc("ngModel",t.searchForm.binCode),n.Cb(2),n.oc("ngModel",t.searchForm.binName),n.Cb(2),n.oc("ngModel",t.searchForm.status),n.Cb(3),n.oc("ngForOf",t.statusList)}}function Ct(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"td"),n.Vb(2,"a",28),n.dc("click",(function(){n.Dc(t);const i=e.$implicit;return n.hc(2).showAddPopup(i.id)})),n.Qb(3,"i",29),n.Ub(),n.Ub(),n.Vb(4,"td"),n.Lc(5),n.Ub(),n.Vb(6,"td"),n.Lc(7),n.Ub(),n.Vb(8,"td"),n.Vb(9,"span",30),n.Lc(10),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=e.$implicit,i=n.hc(2);n.Cb(5),n.Mc(t.binCode),n.Cb(2),n.Mc(t.binName),n.Cb(2),n.oc("ngClass",i.appConstants.STATUS_COLOR_CLS[t.status]),n.Cb(1),n.Mc(t.statusName)}}function Ut(t,e){if(1&t){const t=n.Wb();n.Tb(0),n.Vb(1,"div",1),n.Vb(2,"span"),n.Lc(3,"B"),n.Ub(),n.Lc(4,"in Location Master Data - List "),n.Vb(5,"div",2),n.Vb(6,"button",3),n.dc("click",(function(){return n.Dc(t),n.hc().showAddPopup()})),n.Qb(7,"i",4),n.Vb(8,"span"),n.Lc(9,"Add Bin Location Master Data"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(10,"div",5),n.Vb(11,"div",6),n.Vb(12,"div",7),n.Vb(13,"div",8),n.Vb(14,"p-table",9,10),n.dc("onLazyLoad",(function(e){return n.Dc(t),n.hc().getListing(e)})),n.Jc(16,vt,5,0,"ng-template",11),n.Jc(17,St,26,10,"ng-template",12),n.Jc(18,Ct,11,4,"ng-template",13),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Sb()}if(2&t){const t=n.hc();n.Cb(14),n.oc("value",t.listing.data)("lazy",!0)("paginator",!0)("rows",t.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",t.listing.totalRecords)}}let It=(()=>{class t{constructor(t,e,i,s,n,o){this.utilsService=t,this.authGuardService=e,this.commonDataService=i,this.binDataService=s,this.branchUtilsService=n,this.modalService=o,this.appConstants=r.h,this.screenAcl={},this.statusList=[],this.listing={data:[],totalRecords:0},this.searchForm={binCode:"",binName:"",status:"1"}}ngOnInit(){if(this.screenAcl=this.authGuardService.getScreenAcl("27"),!this.screenAcl.view)return this.utilsService.showFailureMsg(r.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.getAutoSuggestionList("getCommonStatusList"),this.branchUtilsService.actionSaveUpdate.subscribe(t=>{"bin-location"===t.triggerType&&this.resetListing()})}getListing(t){const e=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.binDataService.getList(e).subscribe(t=>{"SUCCESS"===t.status?(this.listing.data=t.results.searchResults,this.listing.totalRecords=t.results.totalRecords):this.utilsService.showFailureMsg(t)})}clearSearchForm(){this.searchForm={binCode:"",binName:"",status:"1"},this.resetListing()}resetListing(){this.dataTable.reset()}getAutoSuggestionList(t){this.commonDataService.getAutoSuggestionList(t).subscribe(e=>{"SUCCESS"===e.status?"getCommonStatusList"===t&&(this.statusList=e.results):this.utilsService.showFailureMsg(e)})}showAddPopup(t){const e={backdrop:"static"};t&&(e.initialState={inputEditId:t}),this.modalService.show(gt,e)}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.g),n.Pb(r.a),n.Pb(o.l),n.Pb(o.i),n.Pb(c.a),n.Pb(E.b))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-bin-list"]],viewQuery:function(t,e){var i;1&t&&n.Pc(Lt,!0),2&t&&n.zc(i=n.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],[2,"width","80px"],[2,"width","100px"],[2,"width","200px"],[2,"width","120px"],[3,"pSortableColumn"],[3,"field"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"],[1,"badge",3,"ngClass"]],template:function(t,e){1&t&&n.Jc(0,Ut,19,5,"ng-container",0),2&t&&n.oc("ngIf",e.screenAcl.view)},directives:[b.m,u.c,m.b,u.b,u.a,l.a,d.b,d.m,d.o,d.t,d.p,d.v,b.l,b.k],styles:[""]}),t})();var Vt=i("HDdC");let Ft=(()=>{class t{constructor(t,e,i,s,n,o){this.utilsService=t,this.storageService=e,this.branchUtilsService=i,this.inventoryRequestDataService=s,this.formBuilder=n,this.inventoryTransferDataService=o,this.appConstants=r.h,this.initializeSubscriptions()}initializeSubscriptions(){this.branchUtilsService.spiTxnOptionsDownloadPdf.subscribe(t=>{this.downloadPDF(t)})}checkScreenNameValid(t){return!(!this.branchUtilsService.screenAttributes.hasOwnProperty(t)||"inventoryRequest"!==t&&"inventoryTransfer"!==t)}getScreenDataService(t){return"inventoryRequest"===t?this.inventoryRequestDataService:"inventoryTransfer"===t?this.inventoryTransferDataService:void 0}getFormErrors(t,e){return"mainFields"===e?{documentNumberingId:"",documentNumber:"",fromWarehouseId:"",toWarehouseId:"",postingDate:"",dueDate:"",documentDate:"",status:"",itemListArray:[]}:"itemFields"===e?{itemId:"",quantity:"",fromWarehouseId:"",fromBinId:"",toWarehouseId:"",toBinId:""}:void 0}getFormValMsgs(t){return{documentNumberingId:{required:"Document No is required"},documentNumber:{required:"Document No is required"},fromWarehouseId:{required:"From Warehouse is required"},toWarehouseId:{required:"To Warehouse is required"},postingDate:{required:"Posting Date is required"},dueDate:{required:"Due Date is required"},documentDate:{required:"Document Date is required"},status:{required:"Status is required"},itemListArray:{itemId:{required:"Item Name is required"},quantity:{required:"Quantity is required",min:"Minimum 1",pattern:"Only positive numbers are allowed"},fromWarehouseId:{required:"Warehouse is required"},fromBinId:{required:"Bin is required"},toWarehouseId:{required:"Warehouse is required"},toBinId:{required:"Bin is required"}}}}getFormMainFields(t){const e={documentNumberingId:[null,[d.u.required]],documentNumber:["",[d.u.required]],documentNumberingType:[""],businessPartnerId:[null],bpContactsId:[null],referenceNumber:[""],intraBranchFlag:[!1],fromWarehouseId:[null,[d.u.required]],toWarehouseId:[null,[d.u.required]],postingDate:[new Date,[d.u.required]],dueDate:["",[d.u.required]],documentDate:[new Date,[d.u.required]],salesEmpId:[null],status:["1",[d.u.required]],dutyStatusId:[""],remarks:[""],deletedItemChildIds:[[]],approvalStatus:["4"],showAddButton:[""]};"inventoryRequest"===t&&(e.toWarehouseId[0]=this.storageService.get("defaultWarehouseId")?this.storageService.get("defaultWarehouseId"):null),"inventoryTransfer"===t&&(e.fromWarehouseId[0]=this.storageService.get("defaultWarehouseId")?this.storageService.get("defaultWarehouseId"):null),e.itemListArray=this.formBuilder.array([]);const i=this.formBuilder.group(e);return this.setMainFieldsCustomValidation(i,t),i}setMainFieldsCustomValidation(t,e){const i=[];i.push(this.utilsService.startEndDateValidator("documentDate","dueDate","invalidDueDate","Should => Document Date")),i.push(this.utilsService.startEndDateValidator("postingDate","documentDate","invalidPostingDate","Should <= Document Date")),t.setValidators(d.u.compose(i)),t.updateValueAndValidity()}getMainFieldsWithData(t,e){const i={};return this.utilsService.updateObject(i,"documentNumberingId",e.documentNumberingId),this.utilsService.updateObject(i,"documentNumber",e.documentNumber),e.documentNumberingInfo&&this.utilsService.updateObject(i,"documentNumberingType",e.documentNumberingInfo.length>0?e.documentNumberingInfo[0].documentNumberingType:""),this.utilsService.updateObject(i,"businessPartnerId",e.businessPartnerId),this.utilsService.updateObject(i,"bpContactsId",e.bpContactsId),this.utilsService.updateObject(i,"referenceNumber",e.referenceNumber),this.utilsService.isEmpty(e.intraBranchFlag)||(i.intraBranchFlag="1"===e.intraBranchFlag),this.utilsService.updateObject(i,"intraBranchFlag",e.intraBranchFlag),this.utilsService.updateObject(i,"fromWarehouseId",e.fromWarehouseId),this.utilsService.updateObject(i,"toWarehouseId",e.toWarehouseId),this.utilsService.updateObject(i,"postingDate",e.postingDate,"date"),this.utilsService.updateObject(i,"dueDate",e.dueDate,"date"),this.utilsService.updateObject(i,"documentDate",e.documentDate,"date"),this.utilsService.updateObject(i,"salesEmpId",e.salesEmpId),this.utilsService.updateObject(i,"status",e.status),this.utilsService.updateObject(i,"dutyStatusId",e.dutyStatusId),this.utilsService.updateObject(i,"remarks",e.remarks),this.utilsService.updateObject(i,"showAddButton",e.showAddButton),this.utilsService.updateObject(i,"approvalStatus",e.approvalStatus),i}getFormItemFields(t,e,i){const s={itemId:[null,[d.u.required]],quantity:[1,[d.u.required,d.u.min(1),d.u.pattern(this.appConstants.VALIDATION_PATTERNS.positiveIntNumber)]],openQuantity:[0],uomId:[null],fromWarehouseId:[null,[d.u.required]],fromBinId:[null,[d.u.required]],fromBinList:[[]],toWarehouseId:[null,[d.u.required]],toBinId:[null,[d.u.required]],toBinList:[[]],id:[""],copyFromType:[""],copyFromId:[""],showDeleteIcon:[!0],orderedQuantity:[0],fromStockDetails:[""],toStockDetails:[""]};e&&this.setDataToItemFields(t,s,e);const r=this.formBuilder.group(s);return i&&this.setItemFieldsCustomValidation(r),r}setDataToItemFields(t,e,i){this.utilsService.updateObject(e,"itemId",i.itemId),this.utilsService.updateObject(e,"quantity",i.quantity),this.utilsService.updateObject(e,"openQuantity",parseInt(i.openQuantity,0)<0?0:i.openQuantity),this.utilsService.updateObject(e,"uomId",i.uomId),this.utilsService.updateObject(e,"fromWarehouseId",i.fromWarehouseId),this.utilsService.updateObject(e,"fromBinId",i.fromBinId),this.utilsService.updateObject(e,"toWarehouseId",i.toWarehouseId),this.utilsService.updateObject(e,"toBinId",i.toBinId),this.utilsService.updateObject(e,"id",i.id),this.utilsService.updateObject(e,"copyFromType",i.copyFromType),this.utilsService.updateObject(e,"copyFromId",i.copyFromId),this.utilsService.updateObject(e,"orderedQuantity",i.orderedQuantity)}setItemFieldsCustomValidation(t){const e=t.getRawValue(),i=[];i.push(this.utilsService.minValidator("quantity",e.orderedQuantity,"invalidMinQuantity","Minimum : "+e.orderedQuantity)),t.setValidators(d.u.compose(i)),t.updateValueAndValidity()}getSaveUpdateDataFormation(t,e){const i=e.getRawValue(),s={documentNumberingId:i.documentNumberingId,documentNumberingType:i.documentNumberingType,documentNumber:i.documentNumber,businessPartnerId:i.businessPartnerId,bpContactsId:i.bpContactsId,referenceNumber:i.referenceNumber,intraBranchFlag:i.intraBranchFlag?"1":"0",fromWarehouseId:i.fromWarehouseId,toWarehouseId:i.toWarehouseId,postingDate:this.utilsService.getBackendDateFormat(i.postingDate),dueDate:this.utilsService.getBackendDateFormat(i.dueDate),documentDate:this.utilsService.getBackendDateFormat(i.documentDate),salesEmpId:i.salesEmpId,status:i.status,dutyStatusId:i.dutyStatusId,remarks:i.remarks,itemListArray:[]};return i.itemListArray.forEach(t=>{"3"===i.status&&this.utilsService.isEmpty(t.id)||s.itemListArray.push({itemId:t.itemId,quantity:t.quantity,uomId:t.uomId,fromWarehouseId:t.fromWarehouseId,fromBinId:t.fromBinId,toWarehouseId:t.toWarehouseId,toBinId:t.toBinId,id:t.id,copyFromType:t.copyFromType,copyFromId:t.copyFromId})}),s}manipulationsOnEdit(t,e){"1"===e.value.status?(e.controls.intraBranchFlag.disable(),e.controls.documentNumberingId.disable(),e.controls.documentNumber.disable(),"inventoryTransfer"===t&&(e.controls.fromWarehouseId.disable(),e.controls.toWarehouseId.disable()),e.controls.itemListArray.controls.forEach(e=>{const i=e.getRawValue();e.controls.itemId.disable(),parseInt(i.orderedQuantity,0)>0&&e.patchValue({showDeleteIcon:!1}),parseInt(i.openQuantity,0)<=0&&(e.disable(),e.patchValue({showDeleteIcon:!1})),"inventoryTransfer"===t&&e.patchValue({showDeleteIcon:!1})}),"inventoryTransfer"===t&&(e.disable(),e.controls.bpContactsId.enable(),e.controls.documentDate.enable(),e.controls.dueDate.enable(),e.controls.salesEmpId.enable(),e.controls.remarks.enable(),e.controls.status.enable())):e.enable()}manipulationsOnCopy(t,e){e.controls.intraBranchFlag.disable(),e.controls.toWarehouseId.disable(),e.controls.itemListArray.controls.forEach(t=>{t.controls.itemId.disable(),t.controls.toWarehouseId.disable(),t.controls.toBinId.disable()})}redirectToList(t){this.utilsService.redirect("/branch/inventory/inventory-txn-list/"+t)}getFormSearchFields(t){return{fromDate:"",toDate:"",isDraft:!1,branchName:"",documentNumber:"",sapId:"",partnerName:"",postingDate:"",dueDate:"",documentDate:"",status:1,salesEmpName:""}}getSearchDataFormation(t,e){return{fromDate:this.utilsService.getBackendDateFormat(e.fromDate),toDate:this.utilsService.getBackendDateFormat(e.toDate),isDraft:e.isDraft?1:0,branchName:e.branchName,partnerName:e.partnerName,documentNumber:e.documentNumber,sapId:e.sapId,postingDate:this.utilsService.getBackendDateFormat(e.postingDate),dueDate:this.utilsService.getBackendDateFormat(e.dueDate),documentDate:this.utilsService.getBackendDateFormat(e.documentDate),status:e.status,salesEmpName:e.salesEmpName}}redirectToAdd(t){this.utilsService.redirect("/branch/inventory/inventory-txn-add/"+t)}redirectToEdit(t,e,i){this.utilsService.redirect("1"===i?"/branch/inventory/inventory-txn-edit-draft/"+t+"/"+this.utilsService.encrypt(e):"/branch/inventory/inventory-txn-edit/"+t+"/"+this.utilsService.encrypt(e))}getAnalyticsData(t){const e=this.getScreenDataService(t);return new Vt.a(t=>{e.getAnalyticsData().subscribe(e=>{if("SUCCESS"===e.status){const i=D.orderBy(e.results,["id"],["asc"]);t.next(i),t.complete()}else this.utilsService.showFailureMsg(e),t.error(),t.complete()})})}downloadAsExcel(t,e){this.utilsService.showSuccessMsg("Processing to download the Excel..."),this.getScreenDataService(t).downloadAsExcel(e).subscribe(t=>{"SUCCESS"===t.status?this.utilsService.externalRedirect(t.fileUrl):this.utilsService.showFailureMsg(t)})}downloadPDF(t){t.spiName===this.branchUtilsService.spiTxnId.inventory&&(this.utilsService.showSuccessMsg("Processing to download the PDF..."),this.getScreenDataService(t.screenName).downloadPDF(t.id).subscribe(t=>{this.utilsService.externalRedirect(t.url,!0)}))}}return t.\u0275fac=function(e){return new(e||t)(n.Zb(r.g),n.Zb(r.f),n.Zb(c.a),n.Zb(o.z),n.Zb(d.e),n.Zb(o.A))},t.\u0275prov=n.Lb({token:t,factory:t.\u0275fac}),t})();var Dt=i("eO1q");const Nt=["dataTable"];function Et(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",24),n.dc("click",(function(){n.Dc(t);const e=n.hc(2);return e.iTxnUtilsService.downloadAsExcel(e.inputScreenName,e.listingProperties)})),n.Qb(1,"i",25),n.Vb(2,"span"),n.Lc(3,"Download as Excel"),n.Ub(),n.Ub()}}function Tt(t,e){if(1&t&&(n.Vb(0,"div",26),n.Vb(1,"div",27),n.Vb(2,"div",28),n.Lc(3),n.Ub(),n.Vb(4,"div",29),n.Lc(5),n.Ub(),n.Ub(),n.Ub()),2&t){const t=e.$implicit,i=n.hc(2);n.Cb(3),n.Nc(" ",t.name," "),n.Cb(1),n.oc("ngClass",i.appConstants.TXN_STATUS_COLOR_CLS[t.id]),n.Cb(1),n.Mc(t.count)}}function Pt(t,e){1&t&&(n.Vb(0,"th",47),n.Lc(1,"Branch Name"),n.Qb(2,"p-sortIcon",33),n.Ub()),2&t&&(n.oc("pSortableColumn","branchName"),n.Cb(2),n.oc("field","branchName"))}function At(t,e){1&t&&(n.Vb(0,"th",48),n.Lc(1,"Sap Doc No "),n.Qb(2,"p-sortIcon",33),n.Ub()),2&t&&(n.oc("pSortableColumn","sapId"),n.Cb(2),n.oc("field","sapId"))}function wt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"th"),n.Vb(1,"input",43),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(3).searchForm.branchName=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(3).resetListing()})),n.Ub(),n.Ub()}if(2&t){const t=n.hc(3);n.Cb(1),n.oc("ngModel",t.searchForm.branchName)}}function xt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"th"),n.Vb(1,"input",43),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(3).searchForm.sapId=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(3).resetListing()})),n.Ub(),n.Ub()}if(2&t){const t=n.hc(3);n.Cb(1),n.oc("ngModel",t.searchForm.sapId)}}function Mt(t,e){if(1&t&&(n.Vb(0,"option",49),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Nc(" ",t.name," ")}}function kt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"th",30),n.Lc(2,"Actions"),n.Ub(),n.Jc(3,Pt,3,2,"th",31),n.Vb(4,"th",32),n.Lc(5,"Overdue"),n.Qb(6,"p-sortIcon",33),n.Ub(),n.Vb(7,"th",34),n.Lc(8,"Doc No"),n.Qb(9,"p-sortIcon",33),n.Ub(),n.Jc(10,At,3,2,"th",35),n.Vb(11,"th",36),n.Lc(12,"Business Partner Name"),n.Qb(13,"p-sortIcon",33),n.Ub(),n.Vb(14,"th",37),n.Lc(15,"Line Items Count"),n.Ub(),n.Vb(16,"th",38),n.Lc(17,"Posting Date"),n.Qb(18,"p-sortIcon",33),n.Ub(),n.Vb(19,"th",38),n.Lc(20,"Due Date"),n.Qb(21,"p-sortIcon",33),n.Ub(),n.Vb(22,"th",39),n.Lc(23,"Document Date"),n.Qb(24,"p-sortIcon",33),n.Ub(),n.Vb(25,"th",38),n.Lc(26,"Status"),n.Qb(27,"p-sortIcon",33),n.Ub(),n.Vb(28,"th",36),n.Lc(29,"Sales Employee"),n.Qb(30,"p-sortIcon",33),n.Ub(),n.Ub(),n.Vb(31,"tr",40),n.Vb(32,"th"),n.Vb(33,"a",41),n.dc("click",(function(){return n.Dc(t),n.hc(2).clearSearchForm()})),n.Qb(34,"i",42),n.Lc(35,"Clear"),n.Ub(),n.Ub(),n.Jc(36,wt,2,1,"th",0),n.Qb(37,"th"),n.Vb(38,"th"),n.Vb(39,"input",43),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.documentNumber=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Jc(40,xt,2,1,"th",0),n.Vb(41,"th"),n.Vb(42,"input",43),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.partnerName=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Qb(43,"th"),n.Vb(44,"th"),n.Vb(45,"p-calendar",12),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.postingDate=e}))("onSelect",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(46,"th"),n.Vb(47,"p-calendar",12),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.dueDate=e}))("onSelect",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(48,"th"),n.Vb(49,"p-calendar",12),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.documentDate=e}))("onSelect",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(50,"th"),n.Vb(51,"select",44),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.status=e}))("change",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Vb(52,"option",45),n.Lc(53,"--SELECT--"),n.Ub(),n.Jc(54,Mt,2,2,"option",46),n.Ub(),n.Ub(),n.Vb(55,"th"),n.Vb(56,"input",43),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.salesEmpName=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=n.hc(2);n.Cb(3),n.oc("ngIf",!t.storageService.get("isSingleBranchUser")),n.Cb(1),n.oc("pSortableColumn","overDueValue"),n.Cb(2),n.oc("field","overDueValue"),n.Cb(1),n.oc("pSortableColumn","documentNumber"),n.Cb(2),n.oc("field","documentNumber"),n.Cb(1),n.oc("ngIf",t.storageService.get("isSap")),n.Cb(1),n.oc("pSortableColumn","partnerName"),n.Cb(2),n.oc("field","partnerName"),n.Cb(3),n.oc("pSortableColumn","postingDate"),n.Cb(2),n.oc("field","postingDate"),n.Cb(1),n.oc("pSortableColumn","dueDate"),n.Cb(2),n.oc("field","dueDate"),n.Cb(1),n.oc("pSortableColumn","documentDate"),n.Cb(2),n.oc("field","documentDate"),n.Cb(1),n.oc("pSortableColumn","status"),n.Cb(2),n.oc("field","status"),n.Cb(1),n.oc("pSortableColumn","salesEmpName"),n.Cb(2),n.oc("field","salesEmpName"),n.Cb(6),n.oc("ngIf",!t.storageService.get("isSingleBranchUser")),n.Cb(3),n.oc("ngModel",t.searchForm.documentNumber),n.Cb(1),n.oc("ngIf",t.storageService.get("isSap")),n.Cb(2),n.oc("ngModel",t.searchForm.partnerName),n.Cb(3),n.oc("ngModel",t.searchForm.postingDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",t.appConstants.PICKER_YEAR_RANGE)("dateFormat",t.appConstants.PICKER_DATE_FORMAT),n.Cb(2),n.oc("ngModel",t.searchForm.dueDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",t.appConstants.PICKER_YEAR_RANGE)("dateFormat",t.appConstants.PICKER_DATE_FORMAT),n.Cb(2),n.oc("ngModel",t.searchForm.documentDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",t.appConstants.PICKER_YEAR_RANGE)("dateFormat",t.appConstants.PICKER_DATE_FORMAT),n.Cb(2),n.oc("ngModel",t.searchForm.status),n.Cb(3),n.oc("ngForOf",t.statusList),n.Cb(2),n.oc("ngModel",t.searchForm.salesEmpName)}}function Wt(t,e){if(1&t&&(n.Vb(0,"td"),n.Lc(1),n.Ub()),2&t){const t=n.hc().$implicit;n.Cb(1),n.Mc(t.branchName)}}function Bt(t,e){if(1&t&&(n.Vb(0,"span",55),n.Lc(1),n.Ub()),2&t){const t=n.hc().$implicit;n.Cb(1),n.Nc("",t.overDueValue," Days")}}function Qt(t,e){if(1&t&&(n.Vb(0,"td"),n.Lc(1),n.Ub()),2&t){const t=n.hc().$implicit;n.Cb(1),n.Mc(t.sapId)}}function Jt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"td"),n.Vb(2,"a",50),n.dc("click",(function(){n.Dc(t);const i=e.$implicit,s=n.hc(2);return s.iTxnUtilsService.redirectToEdit(s.inputScreenName,i.id,i.isDraft)})),n.Qb(3,"i",51),n.Ub(),n.Ub(),n.Jc(4,Wt,2,1,"td",0),n.Vb(5,"td"),n.Jc(6,Bt,2,1,"span",52),n.Ub(),n.Vb(7,"td"),n.Lc(8),n.Ub(),n.Jc(9,Qt,2,1,"td",0),n.Vb(10,"td"),n.Lc(11),n.Ub(),n.Vb(12,"td"),n.Lc(13),n.Ub(),n.Vb(14,"td"),n.Lc(15),n.Ub(),n.Vb(16,"td"),n.Lc(17),n.Ub(),n.Vb(18,"td"),n.Lc(19),n.Ub(),n.Vb(20,"td"),n.Vb(21,"span",53),n.Lc(22),n.Ub(),n.Ub(),n.Vb(23,"td"),n.Qb(24,"img",54),n.Lc(25),n.Ub(),n.Ub()}if(2&t){const t=e.$implicit,i=n.hc(2);n.Cb(4),n.oc("ngIf",!i.storageService.get("isSingleBranchUser")),n.Cb(2),n.oc("ngIf",1==t.status&&t.overDueValue<0),n.Cb(2),n.Mc(t.documentNumber),n.Cb(1),n.oc("ngIf",i.storageService.get("isSap")),n.Cb(2),n.Oc("",t.partnerCode," - ",t.partnerName,""),n.Cb(2),n.Mc(t.lineItemInfo.length),n.Cb(2),n.Mc(t.postingDate),n.Cb(2),n.Mc(t.dueDate),n.Cb(2),n.Mc(t.documentDate),n.Cb(2),n.oc("ngClass",i.appConstants.TXN_STATUS_COLOR_CLS[t.status]),n.Cb(1),n.Mc(t.statusName),n.Cb(2),n.oc("src",t.salesEmpImgUrl?t.salesEmpImgUrl:i.appConstants.DEFAULT_USER_ICON,n.Fc),n.Cb(1),n.Oc("\xa0",t.salesEmpCode," - ",t.salesEmpName,"")}}function Ot(t,e){if(1&t){const t=n.Wb();n.Tb(0),n.Vb(1,"div",1),n.Vb(2,"span"),n.Lc(3),n.Ub(),n.Lc(4),n.Vb(5,"div",2),n.Jc(6,Et,4,0,"button",3),n.Vb(7,"button",4),n.dc("click",(function(){n.Dc(t);const e=n.hc();return e.iTxnUtilsService.redirectToAdd(e.inputScreenName)})),n.Qb(8,"i",5),n.Vb(9,"span"),n.Lc(10),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(11,"div",6),n.Vb(12,"div",7),n.Vb(13,"div",8),n.Jc(14,Tt,6,3,"div",9),n.Ub(),n.Ub(),n.Vb(15,"div",8),n.Vb(16,"div",10),n.Vb(17,"label",11),n.Vb(18,"strong"),n.Lc(19,"From Date"),n.Ub(),n.Ub(),n.Vb(20,"p-calendar",12),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc().searchForm.fromDate=e}))("onSelect",(function(){return n.Dc(t),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Vb(21,"div",10),n.Vb(22,"label",11),n.Vb(23,"strong"),n.Lc(24,"To Date"),n.Ub(),n.Ub(),n.Vb(25,"p-calendar",13),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc().searchForm.toDate=e}))("onSelect",(function(){return n.Dc(t),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Vb(26,"div",14),n.Vb(27,"label",15),n.Vb(28,"input",16),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc().searchForm.isDraft=e}))("change",(function(){return n.Dc(t),n.hc().resetListing()})),n.Ub(),n.Qb(29,"span",17),n.Lc(30," Show Only Drafts "),n.Ub(),n.Ub(),n.Ub(),n.Vb(31,"div",8),n.Vb(32,"div",18),n.Vb(33,"div",19),n.Vb(34,"p-table",20,21),n.dc("onLazyLoad",(function(e){return n.Dc(t),n.hc().getListing(e)})),n.Jc(36,kt,57,40,"ng-template",22),n.Jc(37,Jt,26,15,"ng-template",23),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Sb()}if(2&t){const t=n.hc();n.Cb(3),n.Mc(t.branchUtilsService.txnGetTitle(t.screenAttributes.title,!0)),n.Cb(1),n.Nc("",t.branchUtilsService.txnGetTitle(t.screenAttributes.title)," - List "),n.Cb(2),n.oc("ngIf",t.screenAcl.download),n.Cb(4),n.Nc("Add ",t.screenAttributes.title,""),n.Cb(4),n.oc("ngForOf",t.analyticsData),n.Cb(6),n.oc("ngModel",t.searchForm.fromDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",t.appConstants.PICKER_YEAR_RANGE)("dateFormat",t.appConstants.PICKER_DATE_FORMAT),n.Cb(5),n.oc("ngModel",t.searchForm.toDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",t.appConstants.PICKER_YEAR_RANGE)("dateFormat",t.appConstants.PICKER_DATE_FORMAT)("minDate",t.searchForm.fromDate),n.Cb(3),n.oc("ngModel",t.searchForm.isDraft),n.Cb(6),n.oc("value",t.listing.data)("lazy",!0)("paginator",!0)("rows",t.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",t.listing.totalRecords)}}let Rt=(()=>{class t{constructor(t,e,i,s,n,o,c){this.activatedRoute=t,this.utilsService=e,this.storageService=i,this.authGuardService=s,this.branchUtilsService=n,this.iTxnUtilsService=o,this.commonDataService=c,this.appConstants=r.h,this.screenAcl={},this.analyticsData=[],this.statusList=[],this.screenAttributes={},this.screenDataService={},this.listingProperties={},this.listing={data:[],totalRecords:0},this.searchForm={}}ngOnInit(){this.initializeSubscriptions()}initializeSubscriptions(){this.activatedRoute.params.subscribe(t=>this.iTxnUtilsService.checkScreenNameValid(t.screenName)?(this.screenAcl=this.authGuardService.getScreenAcl(this.branchUtilsService.screenAttributes[t.screenName].documentTypeId),this.screenAcl.view?(this.reInitializeGlobalVariables(),this.inputScreenName=t.screenName,void this.transactionInitialization()):(this.utilsService.showFailureMsg(r.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1)):(this.utilsService.showFailureMsg("Screen that you are trying to is not valid!"),this.utilsService.goBack(),!1))}reInitializeGlobalVariables(){this.inputScreenName="",this.screenAttributes={},this.screenDataService={},this.analyticsData=[],this.statusList=[],this.listingProperties={},this.listing={data:[],totalRecords:0},this.searchForm={}}transactionInitialization(){this.screenAttributes=this.branchUtilsService.screenAttributes[this.inputScreenName],this.screenDataService=this.iTxnUtilsService.getScreenDataService(this.inputScreenName),this.searchForm=this.iTxnUtilsService.getFormSearchFields(this.inputScreenName),this.getAutoSuggestionList("getInventoryTransStatusList"),this.getAnalyticsData(),this.dataTable&&this.resetListing()}getListing(t){const e=this.iTxnUtilsService.getSearchDataFormation(this.inputScreenName,this.searchForm),i=this.utilsService.dataTableParameterFormation(t,e);this.listingProperties=i,this.screenDataService.getList(i).subscribe(t=>{"SUCCESS"===t.status?(this.listing.data=t.results.searchResults,this.listing.totalRecords=t.results.totalRecords):this.utilsService.showFailureMsg(t)})}clearSearchForm(){this.searchForm=this.iTxnUtilsService.getFormSearchFields(this.inputScreenName),this.resetListing()}resetListing(){this.dataTable.reset()}getAutoSuggestionList(t){this.commonDataService.getAutoSuggestionList(t).subscribe(e=>{"SUCCESS"===e.status?"getInventoryTransStatusList"===t&&(this.statusList=e.results):this.utilsService.showFailureMsg(e)})}getAnalyticsData(){this.iTxnUtilsService.getAnalyticsData(this.inputScreenName).subscribe(t=>{this.analyticsData=t})}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(s.a),n.Pb(r.g),n.Pb(r.f),n.Pb(r.a),n.Pb(c.a),n.Pb(Ft),n.Pb(o.l))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-inventory-txn-list"]],viewQuery:function(t,e){var i;1&t&&n.Pc(Nt,!0),2&t&&n.zc(i=n.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],["class","btn btn-success btn-sm",3,"click",4,"ngIf"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"analytics"],[1,"row"],["class","col-lg-2 col-md-3 col-sm-4 col-xs-12",4,"ngFor","ngForOf"],[1,"form-group","col-sm-3"],[1,"form-label"],["appendTo","body",3,"ngModel","monthNavigator","yearNavigator","yearRange","dateFormat","ngModelChange","onSelect"],["appendTo","body",3,"ngModel","monthNavigator","yearNavigator","yearRange","dateFormat","minDate","ngModelChange","onSelect"],[1,"form-group","col-sm-6","text-right"],[1,"checkbox","mt-3"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"checkmark"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa","fa-file-excel"],[1,"col-lg-2","col-md-3","col-sm-4","col-xs-12"],[1,"item"],[1,"name"],[1,"count",3,"ngClass"],[2,"width","80px"],["style","width:150px",3,"pSortableColumn",4,"ngIf"],[2,"width","100px",3,"pSortableColumn"],[3,"field"],[2,"width","90px",3,"pSortableColumn"],["style","width:110px",3,"pSortableColumn",4,"ngIf"],[2,"width","250px",3,"pSortableColumn"],[2,"width","130px"],[2,"width","120px",3,"pSortableColumn"],[2,"width","140px",3,"pSortableColumn"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[2,"width","150px",3,"pSortableColumn"],[2,"width","110px",3,"pSortableColumn"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"],["class","badge badge-danger",4,"ngIf"],[1,"badge",3,"ngClass"],["height","20px",3,"src"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&n.Jc(0,Ot,38,22,"ng-container",0),2&t&&n.oc("ngIf",e.screenAcl.view)},directives:[b.m,b.l,Dt.a,d.m,d.o,d.a,u.c,m.b,b.k,u.b,u.a,l.a,d.b,d.t,d.p,d.v],styles:[""]}),t})();var Kt=i("Kj3r"),qt=i("/uUt"),Gt=i("vkgz"),zt=i("TlXv"),_t=i("umDy"),jt=i("EDFS");const $t=["hActions"],Ht=["hSno"],Yt=["hItemName"],Zt=["hQuantity"],Xt=["hOpenQty"],te=["hUOM"],ee=["hFromWarehouse"],ie=["hFromBin"],se=["hToWarehouse"],re=["hToBin"],ne=["bActions"],oe=["bSno"],ce=["bItemName"],ae=["bQuantity"],be=["bOpenQty"],ue=["bUOM"],me=["bFromWarehouse"],le=["bFromBin"],de=["bToWarehouse"],he=["bToBin"];function pe(t,e){1&t&&(n.Tb(0),n.Lc(1,"Add"),n.Sb())}function fe(t,e){1&t&&(n.Tb(0),n.Lc(1,"Edit"),n.Sb())}function ge(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",5),n.dc("click",(function(){return n.Dc(t),n.hc(2).downloadPdf()})),n.Qb(1,"i",74),n.Vb(2,"span"),n.Lc(3,"Print"),n.Ub(),n.Ub()}}function Le(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.Nc(" ",t.myFormErrors1.documentNumberingId?t.myFormErrors1.documentNumberingId:t.myFormErrors1.documentNumber," ")}}function ve(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.partnerName,"\xa0"),n.Cb(2),n.Nc("(",t.partnerCode,")")}}function ye(t,e){if(1&t){const t=n.Wb();n.Vb(0,"a",76),n.dc("click",(function(){return n.Dc(t),n.hc(2).bizRefreshFlag=!0})),n.Qb(1,"i",77),n.Ub()}}function Se(t,e){if(1&t){const t=n.Wb();n.Vb(0,"a",78),n.dc("click",(function(){n.Dc(t);const e=n.hc(2);return e.getBusinessPartnerList(),e.bizRefreshFlag=!1})),n.Qb(1,"i",79),n.Ub()}}function Ce(t,e){if(1&t){const t=n.Wb();n.Vb(0,"span",80),n.dc("click",(function(){n.Dc(t);const e=n.hc(2);return e.popupExternalService.showDetailPopup("biz-partner",e.myForm1Data.businessPartnerId)})),n.Qb(1,"i",81),n.Ub()}}function Ue(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Ub(),n.Vb(2,"small"),n.Lc(3),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Mc(t.contactName),n.Cb(2),n.Oc("",t.contactTypeName," / ",t.contactNumber,"")}}function Ie(t,e){if(1&t){const t=n.Wb();n.Vb(0,"div",82),n.Vb(1,"input",83),n.dc("change",(function(){return n.Dc(t),n.hc(2).setIntraBranch()})),n.Ub(),n.Lc(2," Intra Branch "),n.Ub()}}function Ve(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub(),n.Vb(4,"small"),n.Lc(5),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.warehouseName,"\xa0"),n.Cb(2),n.Nc("(",t.warehouseCode,")"),n.Cb(2),n.Mc(t.branchName)}}function Fe(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.Nc(" ",t.myFormErrors1.fromWarehouseId," ")}}function De(t,e){if(1&t){const t=n.Wb();n.Vb(0,"div",82),n.Vb(1,"input",83),n.dc("change",(function(){return n.Dc(t),n.hc(2).setIntraBranch()})),n.Ub(),n.Lc(2," Intra Branch "),n.Ub()}}function Ne(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub(),n.Vb(4,"small"),n.Lc(5),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.warehouseName,"\xa0"),n.Cb(2),n.Nc("(",t.warehouseCode,")"),n.Cb(2),n.Mc(t.branchName)}}function Ee(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.Nc(" ",t.myFormErrors1.toWarehouseId," ")}}function Te(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.Nc(" ",t.myFormErrors1.postingDate," ")}}function Pe(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.Nc(" ",null==t.myForm1.errors?null:t.myForm1.errors.invalidPostingDate," ")}}function Ae(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.Nc(" ",t.myFormErrors1.dueDate," ")}}function we(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.Nc(" ",null==t.myForm1.errors?null:t.myForm1.errors.invalidDueDate," ")}}function xe(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.Nc(" ",t.myFormErrors1.documentDate," ")}}function Me(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.employeeName,"\xa0"),n.Cb(2),n.Nc("(",t.empCode,")")}}function ke(t,e){if(1&t){const t=n.Wb();n.Vb(0,"span",80),n.dc("click",(function(){n.Dc(t);const e=n.hc(2);return e.popupExternalService.showDetailPopup("employee",e.myForm1Data.salesEmpId)})),n.Qb(1,"i",81),n.Ub()}}function We(t,e){if(1&t&&(n.Vb(0,"option",84),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Nc(" ",t.name," ")}}function Be(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.Nc(" ",t.myFormErrors1.status," ")}}function Qe(t,e){if(1&t&&(n.Vb(0,"option",84),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Nc(" ",t.name," ")}}function Je(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.Nc(" ",t.myFormErrors1.remarks," ")}}const Oe=function(t){return{data:t}};function Re(t,e){if(1&t&&(n.Tb(0),n.Qb(1,"template",85),n.Sb()),2&t){const t=e.$implicit,i=n.hc(2);n.Cb(1),n.oc("ngTemplateOutlet",i[t.headerRef])("ngTemplateOutletContext",n.sc(2,Oe,t))}}const Ke=function(t,e){return{formItemListRow:t,i:e}};function qe(t,e){if(1&t&&(n.Tb(0),n.Qb(1,"template",85),n.Sb()),2&t){const t=e.$implicit,i=n.hc(),s=i.$implicit,r=i.index,o=n.hc(2);n.Cb(1),n.oc("ngTemplateOutlet",o[t.bodyRef])("ngTemplateOutletContext",n.tc(2,Ke,s,r))}}function Ge(t,e){if(1&t&&(n.Vb(0,"tr",86),n.Jc(1,qe,2,5,"ng-container",46),n.Ub()),2&t){const t=e.index,i=n.hc(2);n.oc("formGroupName",t),n.Cb(1),n.oc("ngForOf",i.itemListColumnOrder)}}function ze(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tfoot"),n.Vb(1,"tr"),n.Vb(2,"td",87),n.Vb(3,"button",88),n.dc("click",(function(){return n.Dc(t),n.hc(2).addItemFields()})),n.Qb(4,"i",77),n.Vb(5,"span"),n.Lc(6,"Add Item"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub()}}function _e(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",5),n.dc("click",(function(){return n.Dc(t),n.hc(2).saveUpdate()})),n.Qb(1,"i",89),n.Vb(2,"span"),n.Lc(3,"Save"),n.Ub(),n.Ub()}}function je(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",5),n.dc("click",(function(){return n.Dc(t),n.hc(2).addUpdateDraft()})),n.Qb(1,"i",89),n.Vb(2,"span"),n.Lc(3,"Save as Draft"),n.Ub(),n.Ub()}}function $e(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",3),n.dc("click",(function(){return n.Dc(t),n.hc(2).clearForm()})),n.Qb(1,"i",90),n.Vb(2,"span"),n.Lc(3,"Clear"),n.Ub(),n.Ub()}}function He(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",5),n.dc("click",(function(){return n.Dc(t),n.hc(2).saveUpdate("add")})),n.Qb(1,"i",79),n.Vb(2,"span"),n.Lc(3,"Add"),n.Ub(),n.Ub()}}function Ye(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",5),n.dc("click",(function(){return n.Dc(t),n.hc(2).saveUpdate()})),n.Qb(1,"i",79),n.Vb(2,"span"),n.Lc(3,"Update"),n.Ub(),n.Ub()}}function Ze(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",3),n.dc("click",(function(){n.Dc(t);const e=n.hc(2);return e.iTxnUtilsService.redirectToList(e.txnKeys.inputScreenName)})),n.Qb(1,"i",91),n.Vb(2,"span"),n.Lc(3,"Cancel"),n.Ub(),n.Ub()}}function Xe(t,e){1&t&&(n.Vb(0,"div",94),n.Vb(1,"span",95),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"update"),n.Ub(),n.Lc(6," this transaction! "),n.Ub())}function ti(t,e){1&t&&(n.Vb(0,"div",94),n.Vb(1,"span",95),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," Cannot update "),n.Vb(4,"strong"),n.Lc(5,"Cancelled"),n.Ub(),n.Lc(6," / "),n.Vb(7,"strong"),n.Lc(8,"Closed"),n.Ub(),n.Lc(9," / "),n.Vb(10,"strong"),n.Lc(11," Approved"),n.Ub(),n.Lc(12," transactions! "),n.Ub())}function ei(t,e){if(1&t&&(n.Vb(0,"div",92),n.Vb(1,"div"),n.Vb(2,"strong"),n.Lc(3,"Created By:"),n.Ub(),n.Lc(4),n.Ub(),n.Jc(5,Xe,7,0,"div",93),n.Jc(6,ti,13,0,"div",93),n.Ub()),2&t){const t=n.hc(2);n.Cb(4),n.Nc(" ",t.txnKeys.editCreatedName,""),n.Cb(1),n.oc("ngIf",t.branchUtilsService.txnValidateBtn(t.myForm1,t.txnKeys,"updateAclNote")),n.Cb(1),n.oc("ngIf",t.branchUtilsService.txnValidateBtn(t.myForm1,t.txnKeys,"updateNote"))}}function ii(t,e){1&t&&(n.Vb(0,"div",92),n.Vb(1,"span",95),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"add"),n.Ub(),n.Lc(6," this transaction!. "),n.Ub())}function si(t,e){if(1&t&&(n.Vb(0,"th",96),n.Lc(1),n.Ub()),2&t){const t=e.data;n.Cb(1),n.Mc(t.name)}}function ri(t,e){if(1&t&&(n.Vb(0,"th",97),n.Lc(1),n.Ub()),2&t){const t=e.data;n.Cb(1),n.Mc(t.name)}}function ni(t,e){if(1&t&&(n.Vb(0,"th",98),n.Lc(1),n.Vb(2,"span",17),n.Lc(3,"*"),n.Ub(),n.Ub()),2&t){const t=e.data;n.Cb(1),n.Mc(t.name)}}function oi(t,e){if(1&t&&(n.Vb(0,"th",99),n.Lc(1),n.Vb(2,"span",17),n.Lc(3,"*"),n.Ub(),n.Ub()),2&t){const t=e.data;n.Cb(1),n.Mc(t.name)}}function ci(t,e){if(1&t&&(n.Vb(0,"th",99),n.Lc(1),n.Ub()),2&t){const t=e.data;n.Cb(1),n.Mc(t.name)}}function ai(t,e){if(1&t&&(n.Vb(0,"th",99),n.Lc(1),n.Ub()),2&t){const t=e.data;n.Cb(1),n.Mc(t.name)}}function bi(t,e){if(1&t&&(n.Vb(0,"th",100),n.Lc(1),n.Vb(2,"span",17),n.Lc(3,"*"),n.Ub(),n.Ub()),2&t){const t=e.data;n.Cb(1),n.Mc(t.name)}}function ui(t,e){if(1&t&&(n.Vb(0,"th",99),n.Lc(1),n.Vb(2,"span",17),n.Lc(3,"*"),n.Ub(),n.Ub()),2&t){const t=e.data;n.Cb(1),n.Mc(t.name)}}function mi(t,e){if(1&t&&(n.Vb(0,"th",101),n.Lc(1),n.Vb(2,"span",17),n.Lc(3,"*"),n.Ub(),n.Ub()),2&t){const t=e.data;n.Cb(1),n.Mc(t.name)}}function li(t,e){if(1&t&&(n.Vb(0,"th",99),n.Lc(1),n.Vb(2,"span",17),n.Lc(3,"*"),n.Ub(),n.Ub()),2&t){const t=e.data;n.Cb(1),n.Mc(t.name)}}function di(t,e){if(1&t){const t=n.Wb();n.Tb(0),n.Vb(1,"a",103),n.dc("click",(function(){n.Dc(t);const e=n.hc().i;return n.hc(2).removeItemFields(e)})),n.Qb(2,"i",104),n.Ub(),n.Sb()}}function hi(t,e){if(1&t&&(n.Tb(0,102),n.Tb(1,47),n.Vb(2,"td",86),n.Jc(3,di,3,0,"ng-container",0),n.Ub(),n.Sb(),n.Sb()),2&t){const t=e.i,i=n.hc(2);n.oc("formGroup",i.myForm1),n.Cb(2),n.oc("formGroupName",t),n.Cb(1),n.oc("ngIf",i.myForm1Data.itemListArray[t].showDeleteIcon)}}function pi(t,e){if(1&t&&(n.Tb(0,102),n.Tb(1,47),n.Vb(2,"td",86),n.Lc(3),n.Ub(),n.Sb(),n.Sb()),2&t){const t=e.i,i=n.hc(2);n.oc("formGroup",i.myForm1),n.Cb(2),n.oc("formGroupName",t),n.Cb(1),n.Mc(t+1)}}function fi(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.itemName,"\xa0"),n.Cb(2),n.Nc("(",t.itemCode,")")}}function gi(t,e){if(1&t){const t=n.Wb();n.Vb(0,"span",80),n.dc("click",(function(){n.Dc(t);const e=n.hc().i,i=n.hc(2);return i.popupExternalService.showDetailPopup("item",i.myForm1Data.itemListArray[e].itemId)})),n.Qb(1,"i",81),n.Ub()}}function Li(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc().i,e=n.hc(2);n.Cb(1),n.Nc(" ",e.myFormErrors1.itemListArray[t].itemId," ")}}function vi(t,e){if(1&t){const t=n.Wb();n.Tb(0,102),n.Tb(1,47),n.Vb(2,"td",86),n.Vb(3,"div",36),n.Vb(4,"ng-select",105),n.dc("search",(function(e){return n.Dc(t),n.hc(2).onItemSearch(e)}))("change",(function(){n.Dc(t);const i=e.i;return n.hc(2).onItemChange(i)})),n.Jc(5,fi,4,2,"ng-template",24),n.Ub(),n.Jc(6,gi,2,0,"span",27),n.Ub(),n.Jc(7,Li,2,1,"div",21),n.Ub(),n.Sb(),n.Sb()}if(2&t){const t=e.i,i=n.hc(2);n.oc("formGroup",i.myForm1),n.Cb(2),n.oc("formGroupName",t),n.Cb(2),n.oc("items",i.itemList)("multiple",!1)("virtualScroll",!0),n.Cb(2),n.oc("ngIf",i.myForm1Data.itemListArray[t].itemId),n.Cb(1),n.oc("ngIf",i.myFormErrors1.itemListArray[t].itemId)}}function yi(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc().formItemListRow;n.Cb(1),n.Nc(" ",null==t.errors?null:t.errors.invalidMinQuantity," ")}}function Si(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc().i,e=n.hc(2);n.Cb(1),n.Nc(" ",e.myFormErrors1.itemListArray[t].quantity," ")}}function Ci(t,e){if(1&t&&(n.Tb(0,102),n.Tb(1,47),n.Vb(2,"td",86),n.Qb(3,"input",106),n.Jc(4,yi,2,1,"div",21),n.Jc(5,Si,2,1,"div",21),n.Ub(),n.Sb(),n.Sb()),2&t){const t=e.formItemListRow,i=e.i,s=n.hc(2);n.oc("formGroup",s.myForm1),n.Cb(2),n.oc("formGroupName",i),n.Cb(2),n.oc("ngIf",null==t.errors?null:t.errors.invalidMinQuantity),n.Cb(1),n.oc("ngIf",s.myFormErrors1.itemListArray[i].quantity)}}function Ui(t,e){if(1&t&&(n.Tb(0,102),n.Tb(1,47),n.Vb(2,"td",86),n.Lc(3),n.Ub(),n.Sb(),n.Sb()),2&t){const t=e.i,i=n.hc(2);n.oc("formGroup",i.myForm1),n.Cb(2),n.oc("formGroupName",t),n.Cb(1),n.Nc(" ",i.myForm1Data.itemListArray[t].openQuantity," ")}}function Ii(t,e){if(1&t&&(n.Tb(0,102),n.Tb(1,47),n.Vb(2,"td",86),n.Qb(3,"ng-select",107),n.Ub(),n.Sb(),n.Sb()),2&t){const t=e.i,i=n.hc(2);n.oc("formGroup",i.myForm1),n.Cb(2),n.oc("formGroupName",t),n.Cb(1),n.oc("items",i.uomList)("multiple",!1)}}function Vi(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.warehouseName,"\xa0"),n.Cb(2),n.Nc("(",t.warehouseCode,")")}}function Fi(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc().i,e=n.hc(2);n.Cb(1),n.Nc(" ",e.myFormErrors1.itemListArray[t].fromWarehouseId," ")}}function Di(t,e){if(1&t){const t=n.Wb();n.Tb(0,102),n.Tb(1,47),n.Vb(2,"td",86),n.Vb(3,"ng-select",108),n.dc("change",(function(){n.Dc(t);const i=e.i;return n.hc(2).setBinList("from",i)})),n.Jc(4,Vi,4,2,"ng-template",24),n.Ub(),n.Jc(5,Fi,2,1,"div",21),n.Ub(),n.Sb(),n.Sb()}if(2&t){const t=e.i,i=n.hc(2);n.oc("formGroup",i.myForm1),n.Cb(2),n.oc("formGroupName",t),n.Cb(1),n.oc("items",i.itemFromWarehouseList)("multiple",!1),n.Cb(2),n.oc("ngIf",i.myFormErrors1.itemListArray[t].fromWarehouseId)}}function Ni(t,e){if(1&t&&(n.Vb(0,"div",113),n.Vb(1,"strong"),n.Lc(2,"Only available stock bin's will be listed"),n.Ub(),n.Ub(),n.Lc(3)),2&t){const t=n.hc().i,e=n.hc(2);n.Cb(3),n.Nc(" ",e.myForm1Data.itemListArray[t].fromStockDetails?e.myForm1Data.itemListArray[t].fromStockDetails:"..."," ")}}function Ei(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc().i,e=n.hc(2);n.Cb(1),n.Nc(" ",e.myFormErrors1.itemListArray[t].fromBinId," ")}}function Ti(t,e){if(1&t){const t=n.Wb();n.Tb(0,102),n.Tb(1,47),n.Vb(2,"td",86),n.Vb(3,"div",36),n.Qb(4,"ng-select",109),n.Vb(5,"span",110),n.dc("click",(function(){n.Dc(t);const i=e.i,s=n.hc(2);return s.branchUtilsService.txnSetItemStockToBinTooltip(s.myForm1,i,"fromWarehouseId","fromStockDetails")})),n.Jc(6,Ni,4,1,"ng-template",null,111,n.Kc),n.Vb(8,"span",112),n.Qb(9,"i",81),n.Ub(),n.Ub(),n.Ub(),n.Jc(10,Ei,2,1,"div",21),n.Ub(),n.Sb(),n.Sb()}if(2&t){const t=e.i,i=n.Ac(7),s=n.hc(2);n.oc("formGroup",s.myForm1),n.Cb(2),n.oc("formGroupName",t),n.Cb(2),n.oc("items",s.myForm1Data.itemListArray[t].fromBinList)("multiple",!1),n.Cb(4),n.oc("popover",i)("outsideClick",!0),n.Cb(2),n.oc("ngIf",s.myFormErrors1.itemListArray[t].fromBinId)}}function Pi(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.warehouseName,"\xa0"),n.Cb(2),n.Nc("(",t.warehouseCode,")")}}function Ai(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc().i,e=n.hc(2);n.Cb(1),n.Nc(" ",e.myFormErrors1.itemListArray[t].toWarehouseId," ")}}function wi(t,e){if(1&t){const t=n.Wb();n.Tb(0,102),n.Tb(1,47),n.Vb(2,"td",86),n.Vb(3,"ng-select",114),n.dc("change",(function(){n.Dc(t);const i=e.i;return n.hc(2).setBinList("to",i)})),n.Jc(4,Pi,4,2,"ng-template",24),n.Ub(),n.Jc(5,Ai,2,1,"div",21),n.Ub(),n.Sb(),n.Sb()}if(2&t){const t=e.i,i=n.hc(2);n.oc("formGroup",i.myForm1),n.Cb(2),n.oc("formGroupName",t),n.Cb(1),n.oc("items",i.itemToWarehouseList)("multiple",!1),n.Cb(2),n.oc("ngIf",i.myFormErrors1.itemListArray[t].toWarehouseId)}}function xi(t,e){if(1&t&&(n.Vb(0,"div",113),n.Vb(1,"strong"),n.Lc(2,"Only available stocks bin's are listed"),n.Ub(),n.Ub(),n.Lc(3)),2&t){const t=n.hc().i,e=n.hc(2);n.Cb(3),n.Nc(" ",e.myForm1Data.itemListArray[t].toStockDetails?e.myForm1Data.itemListArray[t].toStockDetails:"Loading..."," ")}}function Mi(t,e){if(1&t&&(n.Vb(0,"div",75),n.Lc(1),n.Ub()),2&t){const t=n.hc().i,e=n.hc(2);n.Cb(1),n.Nc(" ",e.myFormErrors1.itemListArray[t].toBinId," ")}}function ki(t,e){if(1&t){const t=n.Wb();n.Tb(0,102),n.Tb(1,47),n.Vb(2,"td",86),n.Vb(3,"div",36),n.Qb(4,"ng-select",115),n.Vb(5,"span",110),n.dc("click",(function(){n.Dc(t);const i=e.i,s=n.hc(2);return s.branchUtilsService.txnSetItemStockToBinTooltip(s.myForm1,i,"toWarehouseId","toStockDetails")})),n.Jc(6,xi,4,1,"ng-template",null,116,n.Kc),n.Vb(8,"span",112),n.Qb(9,"i",81),n.Ub(),n.Ub(),n.Ub(),n.Jc(10,Mi,2,1,"div",21),n.Ub(),n.Sb(),n.Sb()}if(2&t){const t=e.i,i=n.Ac(7),s=n.hc(2);n.oc("formGroup",s.myForm1),n.Cb(2),n.oc("formGroupName",t),n.Cb(2),n.oc("items",s.myForm1Data.itemListArray[t].toBinList)("multiple",!1),n.Cb(4),n.oc("popover",i)("outsideClick",!0),n.Cb(2),n.oc("ngIf",s.myFormErrors1.itemListArray[t].toBinId)}}const Wi=function(){return{"max-height.px":300}};function Bi(t,e){if(1&t){const t=n.Wb();n.Tb(0),n.Vb(1,"div",1),n.Vb(2,"span"),n.Lc(3),n.Ub(),n.Lc(4),n.Jc(5,pe,2,0,"ng-container",0),n.Jc(6,fe,2,0,"ng-container",0),n.Vb(7,"div",2),n.Vb(8,"button",3),n.dc("click",(function(){return n.Dc(t),n.hc().utilsService.goBack()})),n.Qb(9,"i",4),n.Vb(10,"span"),n.Lc(11,"Back"),n.Ub(),n.Ub(),n.Vb(12,"button",5),n.dc("click",(function(){n.Dc(t);const e=n.hc();return e.popupExternalService.showManageColumnsPopup(e.txnKeys.inputScreenName)})),n.Qb(13,"i",6),n.Vb(14,"span"),n.Lc(15,"Manage Item Columns"),n.Ub(),n.Ub(),n.Jc(16,ge,4,0,"button",7),n.Vb(17,"button",5),n.dc("click",(function(){return n.Dc(t),n.hc().showTxnOptionsSidebar()})),n.Qb(18,"i",8),n.Vb(19,"span"),n.Lc(20,"More"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(21,"div",9),n.Vb(22,"div",10),n.Vb(23,"div",11),n.Qb(24,"i",12),n.Lc(25,"Basic Info "),n.Ub(),n.Vb(26,"div",13),n.Vb(27,"div",14),n.Vb(28,"div",15),n.Vb(29,"label",16),n.Lc(30,"Doc No"),n.Vb(31,"span",17),n.Lc(32,"*"),n.Ub(),n.Ub(),n.Vb(33,"div",14),n.Vb(34,"div",18),n.Vb(35,"ng-select",19),n.dc("change",(function(){n.Dc(t);const e=n.hc();return e.branchUtilsService.onDocumentNumberingChange(e.documentNumberingList,e.myForm1)})),n.Ub(),n.Ub(),n.Vb(36,"div",18),n.Qb(37,"input",20),n.Ub(),n.Ub(),n.Jc(38,Le,2,1,"div",21),n.Ub(),n.Vb(39,"div",15),n.Vb(40,"label",16),n.Lc(41,"Business Partner Name"),n.Ub(),n.Vb(42,"div",22),n.Vb(43,"ng-select",23),n.dc("change",(function(){n.Dc(t);const e=n.hc();return e.getBpContactList(),e.showTxnOptionsSidebar(!1)})),n.Jc(44,ve,4,2,"ng-template",24),n.Ub(),n.Vb(45,"span"),n.Jc(46,ye,2,0,"a",25),n.Jc(47,Se,2,0,"a",26),n.Ub(),n.Jc(48,Ce,2,0,"span",27),n.Ub(),n.Ub(),n.Vb(49,"div",15),n.Vb(50,"label",16),n.Lc(51,"Contact Person"),n.Ub(),n.Vb(52,"ng-select",28),n.Jc(53,Ue,4,3,"ng-template",24),n.Ub(),n.Ub(),n.Vb(54,"div",15),n.Vb(55,"label",16),n.Lc(56,"Reference No"),n.Ub(),n.Qb(57,"input",29),n.Ub(),n.Vb(58,"div",15),n.Vb(59,"label",16),n.Lc(60," From Warehouse"),n.Vb(61,"span",17),n.Lc(62,"*"),n.Ub(),n.Jc(63,Ie,3,0,"div",30),n.Ub(),n.Vb(64,"ng-select",31),n.dc("change",(function(){return n.Dc(t),n.hc().confirmFromWarehouseChanges()}))("open",(function(){n.Dc(t);const e=n.hc();return e.fromWarehousePrevValue=e.myForm1Data.fromWarehouseId})),n.Jc(65,Ve,6,3,"ng-template",24),n.Ub(),n.Jc(66,Fe,2,1,"div",21),n.Ub(),n.Vb(67,"div",15),n.Vb(68,"label",16),n.Lc(69," To Warehouse"),n.Vb(70,"span",17),n.Lc(71,"*"),n.Ub(),n.Jc(72,De,3,0,"div",30),n.Ub(),n.Vb(73,"ng-select",32),n.dc("change",(function(){return n.Dc(t),n.hc().confirmToWarehouseChanges()}))("open",(function(){n.Dc(t);const e=n.hc();return e.toWarehousePrevValue=e.myForm1Data.toWarehouseId})),n.Jc(74,Ne,6,3,"ng-template",24),n.Ub(),n.Jc(75,Ee,2,1,"div",21),n.Ub(),n.Vb(76,"div",15),n.Vb(77,"label",16),n.Lc(78,"Posting Date"),n.Vb(79,"span",17),n.Lc(80,"*"),n.Ub(),n.Ub(),n.Qb(81,"p-calendar",33),n.Jc(82,Te,2,1,"div",21),n.Jc(83,Pe,2,1,"div",21),n.Ub(),n.Vb(84,"div",15),n.Vb(85,"label",16),n.Lc(86,"Due Date"),n.Vb(87,"span",17),n.Lc(88,"*"),n.Ub(),n.Ub(),n.Qb(89,"p-calendar",34),n.Jc(90,Ae,2,1,"div",21),n.Jc(91,we,2,1,"div",21),n.Ub(),n.Vb(92,"div",15),n.Vb(93,"label",16),n.Lc(94,"Document Date"),n.Vb(95,"span",17),n.Lc(96,"*"),n.Ub(),n.Ub(),n.Qb(97,"p-calendar",35),n.Jc(98,xe,2,1,"div",21),n.Ub(),n.Vb(99,"div",15),n.Vb(100,"label",16),n.Lc(101,"Sales Employee"),n.Ub(),n.Vb(102,"div",36),n.Vb(103,"ng-select",37),n.Jc(104,Me,4,2,"ng-template",24),n.Ub(),n.Jc(105,ke,2,0,"span",27),n.Ub(),n.Ub(),n.Vb(106,"div",15),n.Vb(107,"label",16),n.Lc(108,"Status"),n.Vb(109,"span",17),n.Lc(110,"*"),n.Ub(),n.Ub(),n.Vb(111,"select",38),n.Jc(112,We,2,2,"option",39),n.Ub(),n.Jc(113,Be,2,1,"div",21),n.Ub(),n.Vb(114,"div",15),n.Vb(115,"label",16),n.Lc(116,"Duty Status"),n.Ub(),n.Vb(117,"select",40),n.Vb(118,"option",41),n.Lc(119,"--SELECT--"),n.Ub(),n.Jc(120,Qe,2,2,"option",39),n.Ub(),n.Ub(),n.Vb(121,"div",15),n.Vb(122,"label",16),n.Lc(123,"Remarks"),n.Ub(),n.Qb(124,"textarea",42),n.Jc(125,Je,2,1,"div",21),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(126,"div",10),n.Vb(127,"div",11),n.Qb(128,"i",12),n.Lc(129,"Content Info "),n.Ub(),n.Vb(130,"div",43),n.Vb(131,"div",44),n.Vb(132,"table",45),n.Vb(133,"thead"),n.Vb(134,"tr"),n.Jc(135,Re,2,4,"ng-container",46),n.Ub(),n.Ub(),n.Vb(136,"tbody",47),n.Jc(137,Ge,2,2,"tr",48),n.Ub(),n.Jc(138,ze,7,0,"tfoot",0),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Qb(139,"app-udf-viewer",49),n.Vb(140,"app-attachments",50),n.dc("doSuccess",(function(){n.Dc(t);const e=n.hc();return e.iTxnUtilsService.redirectToList(e.txnKeys.inputScreenName)})),n.Ub(),n.Vb(141,"div",51),n.Jc(142,_e,4,0,"button",7),n.Jc(143,je,4,0,"button",7),n.Jc(144,$e,4,0,"button",52),n.Jc(145,He,4,0,"button",7),n.Jc(146,Ye,4,0,"button",7),n.Jc(147,Ze,4,0,"button",52),n.Ub(),n.Jc(148,ei,7,3,"div",53),n.Jc(149,ii,7,0,"div",53),n.Ub(),n.Qb(150,"app-spi-txn-options"),n.Jc(151,si,2,1,"ng-template",null,54,n.Kc),n.Jc(153,ri,2,1,"ng-template",null,55,n.Kc),n.Jc(155,ni,4,1,"ng-template",null,56,n.Kc),n.Jc(157,oi,4,1,"ng-template",null,57,n.Kc),n.Jc(159,ci,2,1,"ng-template",null,58,n.Kc),n.Jc(161,ai,2,1,"ng-template",null,59,n.Kc),n.Jc(163,bi,4,1,"ng-template",null,60,n.Kc),n.Jc(165,ui,4,1,"ng-template",null,61,n.Kc),n.Jc(167,mi,4,1,"ng-template",null,62,n.Kc),n.Jc(169,li,4,1,"ng-template",null,63,n.Kc),n.Jc(171,hi,4,3,"ng-template",null,64,n.Kc),n.Jc(173,pi,4,3,"ng-template",null,65,n.Kc),n.Jc(175,vi,8,7,"ng-template",null,66,n.Kc),n.Jc(177,Ci,6,4,"ng-template",null,67,n.Kc),n.Jc(179,Ui,4,3,"ng-template",null,68,n.Kc),n.Jc(181,Ii,4,4,"ng-template",null,69,n.Kc),n.Jc(183,Di,6,5,"ng-template",null,70,n.Kc),n.Jc(185,Ti,11,7,"ng-template",null,71,n.Kc),n.Jc(187,wi,6,5,"ng-template",null,72,n.Kc),n.Jc(189,ki,11,7,"ng-template",null,73,n.Kc),n.Sb()}if(2&t){const t=n.hc();n.Cb(3),n.Mc(t.branchUtilsService.txnGetTitle(t.screenAttributes.title,!0)),n.Cb(1),n.Nc("",t.branchUtilsService.txnGetTitle(t.screenAttributes.title)," - "),n.Cb(1),n.oc("ngIf",!t.txnKeys.inputEditId),n.Cb(1),n.oc("ngIf",t.txnKeys.inputEditId),n.Cb(10),n.oc("ngIf",t.txnKeys.inputEditId),n.Cb(5),n.oc("formGroup",t.myForm1),n.Cb(14),n.oc("items",t.documentNumberingList),n.Cb(3),n.oc("ngIf",t.myFormErrors1.documentNumberingId||t.myFormErrors1.documentNumber),n.Cb(5),n.oc("items",t.businessPartnerList)("multiple",!1),n.Cb(3),n.oc("ngIf",!t.bizRefreshFlag),n.Cb(1),n.oc("ngIf",t.bizRefreshFlag),n.Cb(1),n.oc("ngIf",t.myForm1Data.businessPartnerId),n.Cb(4),n.oc("items",t.bpContactList)("multiple",!1),n.Cb(11),n.oc("ngIf","inventoryRequest"===t.txnKeys.inputScreenName),n.Cb(1),n.oc("items",t.fromWarehouseList)("multiple",!1),n.Cb(2),n.oc("ngIf",t.myFormErrors1.fromWarehouseId),n.Cb(6),n.oc("ngIf","inventoryTransfer"===t.txnKeys.inputScreenName),n.Cb(1),n.oc("items",t.toWarehouseList)("multiple",!1),n.Cb(2),n.oc("ngIf",t.myFormErrors1.toWarehouseId),n.Cb(6),n.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",t.appConstants.PICKER_YEAR_RANGE)("dateFormat",t.appConstants.PICKER_DATE_FORMAT),n.Cb(1),n.oc("ngIf",t.myFormErrors1.postingDate),n.Cb(1),n.oc("ngIf",null==t.myForm1.errors?null:t.myForm1.errors.invalidPostingDate),n.Cb(6),n.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",t.appConstants.PICKER_YEAR_RANGE)("dateFormat",t.appConstants.PICKER_DATE_FORMAT),n.Cb(1),n.oc("ngIf",t.myFormErrors1.dueDate),n.Cb(1),n.oc("ngIf",null==t.myForm1.errors?null:t.myForm1.errors.invalidDueDate),n.Cb(6),n.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",t.appConstants.PICKER_YEAR_RANGE)("dateFormat",t.appConstants.PICKER_DATE_FORMAT),n.Cb(1),n.oc("ngIf",t.myFormErrors1.documentDate),n.Cb(5),n.oc("items",t.salesEmployeeList)("multiple",!1),n.Cb(2),n.oc("ngIf",t.myForm1Data.salesEmpId),n.Cb(7),n.oc("ngForOf",t.statusList),n.Cb(1),n.oc("ngIf",t.myFormErrors1.status),n.Cb(7),n.oc("ngForOf",t.dutyStatusList),n.Cb(5),n.oc("ngIf",t.myFormErrors1.remarks),n.Cb(6),n.oc("ngStyle",n.rc(61,Wi)),n.Cb(4),n.oc("ngForOf",t.itemListColumnOrder),n.Cb(2),n.oc("ngForOf",t.myForm1.controls.itemListArray.controls),n.Cb(1),n.oc("ngIf",t.branchUtilsService.txnAddItemAccess(t.txnKeys.inputScreenName,t.myForm1,t.txnKeys.inputEditId)),n.Cb(1),n.oc("type",t.screenAttributes.backendKey),n.Cb(1),n.oc("type",t.screenAttributes.backendKey),n.Cb(2),n.oc("ngIf",t.branchUtilsService.txnValidateBtn(t.myForm1,t.txnKeys,"save")),n.Cb(1),n.oc("ngIf",t.branchUtilsService.txnValidateBtn(t.myForm1,t.txnKeys,"saveDraft")),n.Cb(1),n.oc("ngIf",t.branchUtilsService.txnValidateBtn(t.myForm1,t.txnKeys,"clear")),n.Cb(1),n.oc("ngIf",t.branchUtilsService.txnValidateBtn(t.myForm1,t.txnKeys,"add")),n.Cb(1),n.oc("ngIf",t.branchUtilsService.txnValidateBtn(t.myForm1,t.txnKeys,"update")),n.Cb(1),n.oc("ngIf",t.branchUtilsService.txnValidateBtn(t.myForm1,t.txnKeys,"cancel")),n.Cb(1),n.oc("ngIf",t.branchUtilsService.txnValidateBtn(t.myForm1,t.txnKeys,"editMsgContainer")),n.Cb(1),n.oc("ngIf",t.branchUtilsService.txnValidateBtn(t.myForm1,t.txnKeys,"addAclNote"))}}let Qi=(()=>{class t{constructor(t,e,i,s,n,o,c,a,b,u,m){this.utilsService=t,this.storageService=e,this.authGuardService=i,this.commonDataService=s,this.branchUtilsService=n,this.iTxnUtilsService=o,this.popupExternalService=c,this.formBuilder=a,this.activatedRoute=b,this.changeDetectorRef=u,this.modalService=m,this.appConstants=r.h,this.screenAcl={},this.txnKeys={inputScreenName:"",inputEditId:"",inputDraftId:"",inputCopyId:"",inputCopyScreenName:"",inputDuplicateId:"",editStatusId:"",editCreatedName:""},this.screenAttributes={},this.screenDataService={},this.itemListColumnOrder=[],this.bizRefreshFlag=!1,this.documentNumberingList=[],this.businessPartnerList=[],this.bpContactList=[],this.fromWarehouseList=[],this.fromWarehousePrevValue=[],this.toWarehouseList=[],this.toWarehousePrevValue=[],this.salesEmployeeList=[],this.statusList=[],this.dutyStatusList=[],this.itemList=[],this.uomList=[],this.itemFromWarehouseList=[],this.itemToWarehouseList=[],this.myForm1Data={},this.myFormErrors1={},this.myFormValidationMsgs1={}}ngOnInit(){this.initializeSubscriptions()}ngAfterViewInit(){this.attachmentsComponent&&this.udfViewerComponent&&(this.attachmentsComponent.loadAttachments(this.txnKeys.inputEditId||this.txnKeys.inputDraftId),this.udfViewerComponent.getFields(this.txnKeys.inputEditId||this.txnKeys.inputDuplicateId||this.txnKeys.inputDraftId),this.changeDetectorRef.detectChanges())}initializeSubscriptions(){this.activatedRoute.params.subscribe(t=>this.iTxnUtilsService.checkScreenNameValid(t.screenName)?(this.screenAcl=this.authGuardService.getScreenAcl(this.branchUtilsService.screenAttributes[t.screenName].documentTypeId),this.screenAcl.view?(this.reInitializeGlobalVariables(),this.txnKeys.inputScreenName=t.screenName,this.transactionInitialization(),t.id&&(this.txnKeys.inputEditId=this.utilsService.decrypt(t.id),this.get()),t.copyScreenName&&t.copyId&&(this.txnKeys.inputCopyId=this.utilsService.decrypt(t.copyId),this.txnKeys.inputCopyScreenName=t.copyScreenName,this.copyFrom()),t.duplicateId&&(this.txnKeys.inputDuplicateId=this.utilsService.decrypt(t.duplicateId),this.getDuplicate()),t.draftId&&(this.txnKeys.inputDraftId=this.utilsService.decrypt(t.draftId),this.getDraft()),void(this.txnKeys.inputEditId||this.txnKeys.inputCopyId||this.txnKeys.inputDuplicateId||this.txnKeys.inputDraftId||(this.branchUtilsService.getMasterDocumentNumbering(this.myForm1,this.screenAttributes.documentTypeId).subscribe(t=>{this.documentNumberingList=t}),this.getBusinessPartnerList(),this.getWarehouseList(),this.getSalesEmployeeList(),this.getAutoSuggestionList("getUomList")))):(this.utilsService.showFailureMsg(r.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1)):(this.utilsService.showFailureMsg("Screen that you are trying to is not valid!"),this.utilsService.goBack(),!1)),this.branchUtilsService.itemSearch.pipe(Object(Kt.a)(700),Object(qt.a)(),Object(Gt.a)(t=>{this.getItemList(t)})).subscribe(),this.itemListColumnOrderChangesSubscription=this.branchUtilsService.itemListColumnOrderChanges.subscribe(t=>{"inventoryRequest"!==t.triggerType&&"inventoryTransfer"!==t.triggerType||(this.itemListColumnOrder=this.branchUtilsService.getSelectedItemColumnDataByTxn(this.txnKeys.inputScreenName))})}reInitializeGlobalVariables(){this.txnKeys.inputScreenName="",this.txnKeys.inputEditId="",this.txnKeys.inputCopyId="",this.txnKeys.inputCopyScreenName="",this.txnKeys.inputDuplicateId="",this.txnKeys.editStatusId="",this.txnKeys.editCreatedName="",this.screenAttributes={},this.screenDataService={},this.itemListColumnOrder=[],this.bizRefreshFlag=!1,this.documentNumberingList=[],this.businessPartnerList=[],this.bpContactList=[],this.fromWarehouseList=[],this.toWarehouseList=[],this.salesEmployeeList=[],this.statusList=[],this.dutyStatusList=[],this.itemList=[],this.uomList=[],this.itemFromWarehouseList=[],this.itemToWarehouseList=[]}transactionInitialization(){this.screenAttributes=this.branchUtilsService.screenAttributes[this.txnKeys.inputScreenName],this.screenDataService=this.iTxnUtilsService.getScreenDataService(this.txnKeys.inputScreenName),this.itemListColumnOrder=this.branchUtilsService.getSelectedItemColumnDataByTxn(this.txnKeys.inputScreenName),this.myFormErrors1=this.iTxnUtilsService.getFormErrors(this.txnKeys.inputScreenName,"mainFields"),this.myFormValidationMsgs1=this.iTxnUtilsService.getFormValMsgs(this.txnKeys.inputScreenName),this.initializeForm1(),this.getAutoSuggestionList("getInventoryTransStatusList"),this.getAutoSuggestionList("getDutyStatusList"),this.branchUtilsService.spiTxnOptions.next({show:!1})}initializeForm1(){this.myForm1=this.iTxnUtilsService.getFormMainFields(this.txnKeys.inputScreenName),this.myForm1.valueChanges.subscribe(t=>{this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1),this.myForm1Data=this.myForm1.getRawValue()}),this.myForm1Data=this.myForm1.getRawValue()}addItemFields(t,e){const i=this.myForm1.controls.itemListArray;if(i.push(this.initItemFields(t,e)),!t){const t=i.length-1;i.at(t).patchValue({fromWarehouseId:this.myForm1Data.fromWarehouseId,toWarehouseId:this.myForm1Data.toWarehouseId}),this.setBinList("from",t),this.setBinList("to",t)}}initItemFields(t,e){return this.myFormErrors1.itemListArray.push(this.iTxnUtilsService.getFormErrors(this.txnKeys.inputScreenName,"itemFields")),this.iTxnUtilsService.getFormItemFields(this.txnKeys.inputScreenName,t,e)}removeItemFields(t){const e=this.myForm1Data.itemListArray[t].id;if(e){const t=this.myForm1Data.deletedItemChildIds;t.push(e),this.myForm1.patchValue({deletedItemChildIds:t})}this.myForm1.controls.itemListArray.removeAt(t)}saveUpdate(t){const e=this.myForm1.getRawValue();if("3"!==e.approvalStatus&&"1"!==e.approvalStatus){const i=D.findIndex(this.documentNumberingList,{id:e.documentNumberingId});if("DRAFT"===this.documentNumberingList[i].documentNumberingType&&"add"!==t)return this.utilsService.showFailureMsg("Cannot Proceed - Select other than draft document numbering from Doc No field!"),!1}if(!this.myForm1.valid||!this.udfViewerComponent.valid())return this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1,!0),this.udfViewerComponent.checkValidations(),!1;if(0===e.itemListArray.length)return this.utilsService.showFailureMsg("Cannot save / update - No item added!"),!1;let i=!1;const s=this.myForm1Data.itemListArray.length;for(let o=0;o<s;o++){const t=this.myForm1Data.itemListArray[o];if(t.fromWarehouseId===t.toWarehouseId&&t.fromBinId===t.toBinId){i=!0;break}}if(i)return this.utilsService.showFailureMsg("From Warehouse/Bin and To Warehouse/Bin cannot be same!"),!1;const r=this.iTxnUtilsService.getSaveUpdateDataFormation(this.txnKeys.inputScreenName,this.myForm1);let n;r.udfFields=JSON.stringify(this.udfViewerComponent.getFormValues()),r.isDraft=this.txnKeys.inputDraftId?"2":"0","add"===t?(r.id=this.txnKeys.inputEditId||this.txnKeys.inputDraftId,n="proceed"):this.txnKeys.inputEditId||this.txnKeys.inputDraftId?(n="update",r.id=this.txnKeys.inputEditId||this.txnKeys.inputDraftId,r.deletedItemChildIds=this.myForm1Data.deletedItemChildIds):n="save",this.screenDataService[n](r).subscribe(t=>{"SUCCESS"===t.status?(this.utilsService.showSuccessMsg(t),this.attachmentsComponent.save("save"===n?t.sId:this.txnKeys.inputEditId||this.txnKeys.inputDraftId)):this.utilsService.showFailureMsg(t)})}addUpdateDraft(){const t=this.myForm1.getRawValue(),e=D.findIndex(this.documentNumberingList,{id:t.documentNumberingId});if("DRAFT"!==this.documentNumberingList[e].documentNumberingType)return this.utilsService.showFailureMsg("Cannot Proceed - Select draft document numbering from Doc No field!"),!1;if(0===t.itemListArray.length)return this.utilsService.showFailureMsg("Cannot save / update draft - No item added!"),!1;const i=this.iTxnUtilsService.getSaveUpdateDataFormation(this.txnKeys.inputScreenName,this.myForm1);let s;i.udfFields=JSON.stringify(this.udfViewerComponent.getFormValues()),i.isDraft="1",this.txnKeys.inputDraftId?(s="update",i.id=this.txnKeys.inputDraftId,i.deletedItemChildIds=this.myForm1Data.deletedItemChildIds):s="save",this.screenDataService[s](i).subscribe(t=>{"SUCCESS"===t.status?(this.utilsService.showSuccessMsg(t),this.attachmentsComponent.save("save"===s?t.sId:this.txnKeys.inputDraftId)):this.utilsService.showFailureMsg(t)})}get(){this.screenDataService.get(this.txnKeys.inputEditId).subscribe(t=>{if("SUCCESS"===t.status){const e=t.results,i=this.iTxnUtilsService.getMainFieldsWithData(this.txnKeys.inputScreenName,e);this.myForm1.patchValue(i);const s=[],r=[];e.fromWarehouseInfo[0]&&s.push(e.fromWarehouseInfo[0]),e.toWarehouseInfo[0]&&r.push(e.toWarehouseInfo[0]),this.branchUtilsService.getMasterDocumentNumbering(this.myForm1,this.screenAttributes.documentTypeId,"edit",e.documentNumberingInfo).subscribe(t=>{this.documentNumberingList=t}),this.getBusinessPartnerList(!0,e.bpInfo),this.getBpContactList(!0,e.bpContactsInfo),this.getSalesEmployeeList(e.salesEmpInfo);const n=[],o=[];e.itemListArray.forEach(t=>{this.addItemFields(t,"edit"),t.itemInfo[0]&&n.push(t.itemInfo[0]),t.uomInfo[0]&&o.push(t.uomInfo[0]),t.fromWarehouseInfo[0]&&s.push(t.fromWarehouseInfo[0]),t.toWarehouseInfo[0]&&r.push(t.toWarehouseInfo[0])}),this.getAutoSuggestionList("getUomList",o),this.getItemList("",!0,n),this.getWarehouseList(!0,s,r,e),this.txnKeys.editStatusId=e.status,this.txnKeys.editCreatedName=e.createdByInfo[0].employeeName,this.iTxnUtilsService.manipulationsOnEdit(this.txnKeys.inputScreenName,this.myForm1)}else this.utilsService.showFailureMsg(t),this.utilsService.goBack()})}copyFrom(){const t=this.iTxnUtilsService.getScreenDataService(this.txnKeys.inputCopyScreenName),e=this.branchUtilsService.screenAttributes[this.txnKeys.inputCopyScreenName];t.get(this.txnKeys.inputCopyId).subscribe(t=>{if("SUCCESS"===t.status){const i=t.results;delete i.documentNumber,delete i.documentNumberingId,delete i.documentNumberingInfo,delete i.salesEmpId;const s=this.iTxnUtilsService.getMainFieldsWithData(this.txnKeys.inputScreenName,i);this.myForm1.patchValue(s);const r=[],n=[];i.fromWarehouseInfo[0]&&r.push(i.fromWarehouseInfo[0]),i.toWarehouseInfo[0]&&n.push(i.toWarehouseInfo[0]),this.branchUtilsService.getMasterDocumentNumbering(this.myForm1,this.screenAttributes.documentTypeId).subscribe(t=>{this.documentNumberingList=t}),this.getBusinessPartnerList(!0,i.bpInfo),this.getBpContactList(!0,i.bpContactsInfo),this.getSalesEmployeeList(i.salesEmpInfo);const o=[],c=[],a=i.itemListArray.filter(t=>parseInt(t.openQuantity,0)>0);i.itemListArray=a,i.itemListArray.forEach(t=>{t.copyFromId=t.id,t.copyFromType=e.backendKey,t.quantity=t.openQuantity,delete t.openQuantity,delete t.orderedQuantity,delete t.id,this.addItemFields(t),t.itemInfo[0]&&o.push(t.itemInfo[0]),t.uomInfo[0]&&c.push(t.uomInfo[0]),t.fromWarehouseInfo[0]&&r.push(t.fromWarehouseInfo[0]),t.toWarehouseInfo[0]&&n.push(t.toWarehouseInfo[0])}),this.getAutoSuggestionList("getUomList",c),this.getItemList("",!0,o),this.getWarehouseList(!0,r,n,i),this.iTxnUtilsService.manipulationsOnCopy(this.txnKeys.inputScreenName,this.myForm1)}else this.utilsService.showFailureMsg(t),this.utilsService.goBack()})}getDraft(){this.screenDataService.get(this.txnKeys.inputDraftId).subscribe(t=>{if("SUCCESS"===t.status){const e=t.results,i=this.iTxnUtilsService.getMainFieldsWithData(this.txnKeys.inputScreenName,e);this.myForm1.patchValue(i);const s=[],r=[];e.fromWarehouseInfo[0]&&s.push(e.fromWarehouseInfo[0]),e.toWarehouseInfo[0]&&r.push(e.toWarehouseInfo[0]),this.branchUtilsService.getMasterDocumentNumbering(this.myForm1,this.screenAttributes.documentTypeId,"draft",e.documentNumberingInfo).subscribe(t=>{this.documentNumberingList=t}),this.getBusinessPartnerList(!0,e.bpInfo),this.getBpContactList(!0,e.bpContactsInfo),this.getSalesEmployeeList(e.salesEmpInfo);const n=[],o=[];e.itemListArray.forEach(t=>{this.addItemFields(t,"edit"),t.itemInfo[0]&&n.push(t.itemInfo[0]),t.uomInfo[0]&&o.push(t.uomInfo[0]),t.fromWarehouseInfo[0]&&s.push(t.fromWarehouseInfo[0]),t.toWarehouseInfo[0]&&r.push(t.toWarehouseInfo[0])}),this.getAutoSuggestionList("getUomList",o),this.getItemList("",!0,n),this.getWarehouseList(!0,s,r,e),this.txnKeys.editStatusId=e.status,this.txnKeys.editCreatedName=e.createdByInfo[0].employeeName,"1"===e.isDraft&&"4"===e.approvalStatus?(this.myForm1.controls.documentNumberingId.enable(),this.myForm1.controls.documentNumber.enable()):(this.myForm1.controls.documentNumberingId.disable(),this.myForm1.controls.documentNumber.disable())}else this.utilsService.showFailureMsg(t),this.utilsService.goBack()})}getDuplicate(){this.screenDataService.get(this.txnKeys.inputDuplicateId).subscribe(t=>{if("SUCCESS"===t.status){const e=t.results;delete e.documentNumber,delete e.documentNumberingId,delete e.documentNumberingInfo,delete e.status;const i=this.iTxnUtilsService.getMainFieldsWithData(this.txnKeys.inputScreenName,e);this.myForm1.patchValue(i);const s=[],r=[];e.fromWarehouseInfo[0]&&s.push(e.fromWarehouseInfo[0]),e.toWarehouseInfo[0]&&r.push(e.toWarehouseInfo[0]),this.branchUtilsService.getMasterDocumentNumbering(this.myForm1,this.screenAttributes.documentTypeId).subscribe(t=>{this.documentNumberingList=t}),this.getBusinessPartnerList(),this.getSalesEmployeeList(e.salesEmpInfo);const n=[],o=[];e.itemListArray.forEach(t=>{delete t.id,delete t.openQuantity,delete t.orderedQuantity,delete t.copyFromType,delete t.copyFromId,this.addItemFields(t),t.itemInfo[0]&&n.push(t.itemInfo[0]),t.uomInfo[0]&&o.push(t.uomInfo[0]),t.fromWarehouseInfo[0]&&s.push(t.fromWarehouseInfo[0]),t.toWarehouseInfo[0]&&r.push(t.toWarehouseInfo[0])}),this.getAutoSuggestionList("getUomList",o),this.getItemList("",!0,n),this.getWarehouseList(!0,s,r,e)}else this.utilsService.showFailureMsg(t),this.utilsService.goBack()})}clearForm(){this.initializeForm1()}onItemChange(t){this.branchUtilsService.txnSetUom(this.itemList,this.myForm1,t,"itemId"),this.branchUtilsService.txnCheckItemDuplicate(this.myForm1,t,"itemId",this.itemList),this.branchUtilsService.txnSetDefaultItemBin(this.itemList,this.myForm1,t,"fromWarehouseId","fromBinId","fromBinList"),this.branchUtilsService.txnSetDefaultItemBin(this.itemList,this.myForm1,t,"toWarehouseId","toBinId","toBinList")}onItemSearch(t){this.branchUtilsService.itemSearch.next(t)}getAutoSuggestionList(t,e){this.commonDataService.getAutoSuggestionList(t).subscribe(i=>{"SUCCESS"===i.status?(this.utilsService.ifNotPushToList(i.results,e),"getInventoryTransStatusList"===t?(this.txnKeys.inputEditId||(i.results=i.results.filter(t=>"1"===t.id)),this.statusList=i.results):"getDutyStatusList"===t?this.dutyStatusList=i.results:"getUomList"===t&&(this.uomList=i.results)):this.utilsService.showFailureMsg(i)})}getBusinessPartnerList(t,e){this.commonDataService.getBusinessPartnerList([1]).subscribe(t=>{"SUCCESS"===t.status?(this.utilsService.ifNotPushToList(t.results,e),this.businessPartnerList=t.results.map(t=>(t.searchText=t.partnerName+" - "+t.partnerCode,t))):this.utilsService.showFailureMsg(t)})}getBpContactList(t,e){this.bpContactList=[],this.branchUtilsService.getBpContactListAndSet(this.myForm1,"bpContactsId","businessPartnerId",t,e).subscribe(t=>{this.bpContactList=t})}getSalesEmployeeList(t){this.commonDataService.getEmployeeList(1).subscribe(e=>{"SUCCESS"===e.status?(this.utilsService.ifNotPushToList(e.results,t),this.salesEmployeeList=e.results.map(t=>(t.searchText=t.employeeName+" - "+t.empCode,t))):this.utilsService.showFailureMsg(e)})}getItemList(t,e,i){return e?(this.itemList=i.map(t=>(t.searchText=t.itemName+" - "+t.itemCode,t)),!1):!t.term||t.term.length<3?(this.itemList=[],!1):void this.commonDataService.getItemList(t.term,3).subscribe(t=>{"SUCCESS"===t.status?this.itemList=t.results.map(t=>(t.searchText=t.itemName+" - "+t.itemCode,t)):this.utilsService.showFailureMsg(t)})}getWarehouseList(t,e,i,s){this.screenDataService.getFromToWarehouseList().subscribe(r=>{"SUCCESS"===r.status?(this.utilsService.ifNotPushToList(r.results.fromList,e),this.fromWarehouseList=r.results.fromList.map(t=>(t.searchText=t.warehouseName+" - "+t.warehouseCode,t)),this.utilsService.ifNotPushToList(r.results.toList,i),this.toWarehouseList=r.results.toList.map(t=>(t.searchText=t.warehouseName+" - "+t.warehouseCode,t)),this.myForm1Data.intraBranchFlag?(this.setIntraBranch(t,s),"inventoryRequest"===this.txnKeys.inputScreenName?this.setItemToWarehouseList(t,s):"inventoryTransfer"===this.txnKeys.inputScreenName&&this.setItemFromWarehouseList(t,s)):(this.setItemFromWarehouseList(t,s),this.setItemToWarehouseList(t,s))):this.utilsService.showFailureMsg(r)})}setIntraBranch(t,e){this.myForm1Data.intraBranchFlag?"inventoryRequest"===this.txnKeys.inputScreenName?(t||this.myForm1.patchValue({fromWarehouseId:null}),this.fromWarehouseList=[...this.toWarehouseList],this.setItemFromWarehouseList(t,e)):"inventoryTransfer"===this.txnKeys.inputScreenName&&(t||this.myForm1.patchValue({toWarehouseId:null}),this.toWarehouseList=[...this.fromWarehouseList],this.setItemToWarehouseList(t,e)):this.getWarehouseList()}confirmFromWarehouseChanges(){if(0===this.itemFromWarehouseList.length)return this.setItemFromWarehouseList(),!1;this.utilsService.confirmDialog("Confirmation",'Changing the warehouse will clear all the "From Warehouse / From Bin" in the items').content.confirmation.subscribe(t=>{t?this.setItemFromWarehouseList():this.myForm1.patchValue({fromWarehouseId:this.fromWarehousePrevValue})})}setItemFromWarehouseList(t,e){if(this.itemFromWarehouseList=[],this.myForm1.controls.itemListArray.controls.forEach(e=>{e.patchValue({fromBinList:[[]]}),t||e.patchValue({fromWarehouseId:null,fromBinId:null})}),!this.myForm1Data.fromWarehouseId)return!1;const i=D.findIndex(this.fromWarehouseList,{id:this.myForm1Data.fromWarehouseId});if(i>=0){const t=this.fromWarehouseList[i].branchId;this.itemFromWarehouseList=this.fromWarehouseList.filter(e=>e.branchId===t)}t&&e.itemListArray.forEach((t,e)=>{this.setBinList("from",e,!0,t.fromBinInfo)})}confirmToWarehouseChanges(){if(0===this.itemToWarehouseList.length)return this.setItemToWarehouseList(),!1;this.utilsService.confirmDialog("Confirmation",'Changing the warehouse will clear all the "To Warehouse / To Bin" in the items').content.confirmation.subscribe(t=>{t?this.setItemToWarehouseList():this.myForm1.patchValue({toWarehouseId:this.toWarehousePrevValue})})}setItemToWarehouseList(t,e){if(this.itemToWarehouseList=[],this.myForm1.controls.itemListArray.controls.forEach(e=>{e.patchValue({toBinList:[[]]}),t||e.patchValue({toWarehouseId:null,toBinId:null})}),!this.myForm1Data.toWarehouseId)return!1;const i=D.findIndex(this.toWarehouseList,{id:this.myForm1Data.toWarehouseId});if(i>=0){const t=this.toWarehouseList[i].branchId;this.itemToWarehouseList=this.toWarehouseList.filter(e=>e.branchId===t)}t&&e.itemListArray.forEach((t,e)=>{this.setBinList("to",e,!0,t.toBinInfo)})}setBinList(t,e,i,s){const r=this.myForm1.controls.itemListArray.at(e);"from"===t?(this.branchUtilsService.txnSetBinListAndPreselect(this.itemFromWarehouseList,this.itemList,this.myForm1,e,"fromWarehouseId","fromBinId","fromBinList",i,s),r.patchValue({fromStockDetails:""})):"to"===t&&(this.branchUtilsService.txnSetBinListAndPreselect(this.itemToWarehouseList,this.itemList,this.myForm1,e,"toWarehouseId","toBinId","toBinList",i,s),r.patchValue({toStockDetails:""}))}showTxnOptionsSidebar(t){this.branchUtilsService.spiTxnOptions.next(!1===t?{show:!1}:{show:!0,spiName:this.branchUtilsService.spiTxnId.inventory,screenName:this.txnKeys.inputScreenName,editId:this.txnKeys.inputEditId,bpId:this.myForm1Data.businessPartnerId,status:this.myForm1Data.status})}downloadPdf(){this.branchUtilsService.spiTxnOptionsDownloadPdf.next({spiName:this.branchUtilsService.spiTxnId.inventory,screenName:this.txnKeys.inputScreenName,id:this.txnKeys.inputEditId})}onKeydownHandler(t){t.ctrlKey&&"s"===t.key.toLowerCase()&&(this.txnKeys.inputEditId&&"1"===this.txnKeys.editStatusId||!this.txnKeys.inputEditId)&&(this.saveUpdate(),t.preventDefault()),this.txnKeys.inputEditId&&t.ctrlKey&&-1!=="p".indexOf(t.key)&&(this.downloadPdf(),t.preventDefault())}ngOnDestroy(){this.reInitializeGlobalVariables(),this.itemListColumnOrderChangesSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.g),n.Pb(r.f),n.Pb(r.a),n.Pb(o.l),n.Pb(c.a),n.Pb(Ft),n.Pb(a.a),n.Pb(d.e),n.Pb(s.a),n.Pb(n.h),n.Pb(E.b))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-inventory-txn-add"]],viewQuery:function(t,e){var i;1&t&&(n.Pc(N.a,!0),n.Pc(zt.a,!0),n.Pc($t,!0),n.Pc(Ht,!0),n.Pc(Yt,!0),n.Pc(Zt,!0),n.Pc(Xt,!0),n.Pc(te,!0),n.Pc(ee,!0),n.Pc(ie,!0),n.Pc(se,!0),n.Pc(re,!0),n.Pc(ne,!0),n.Pc(oe,!0),n.Pc(ce,!0),n.Pc(ae,!0),n.Pc(be,!0),n.Pc(ue,!0),n.Pc(me,!0),n.Pc(le,!0),n.Pc(de,!0),n.Pc(he,!0)),2&t&&(n.zc(i=n.ec())&&(e.attachmentsComponent=i.first),n.zc(i=n.ec())&&(e.udfViewerComponent=i.first),n.zc(i=n.ec())&&(e.hActions=i.first),n.zc(i=n.ec())&&(e.hSno=i.first),n.zc(i=n.ec())&&(e.hItemName=i.first),n.zc(i=n.ec())&&(e.hQuantity=i.first),n.zc(i=n.ec())&&(e.hOpenQty=i.first),n.zc(i=n.ec())&&(e.hUOM=i.first),n.zc(i=n.ec())&&(e.hFromWarehouse=i.first),n.zc(i=n.ec())&&(e.hFromBin=i.first),n.zc(i=n.ec())&&(e.hToWarehouse=i.first),n.zc(i=n.ec())&&(e.hToBin=i.first),n.zc(i=n.ec())&&(e.bActions=i.first),n.zc(i=n.ec())&&(e.bSno=i.first),n.zc(i=n.ec())&&(e.bItemName=i.first),n.zc(i=n.ec())&&(e.bQuantity=i.first),n.zc(i=n.ec())&&(e.bOpenQty=i.first),n.zc(i=n.ec())&&(e.bUOM=i.first),n.zc(i=n.ec())&&(e.bFromWarehouse=i.first),n.zc(i=n.ec())&&(e.bFromBin=i.first),n.zc(i=n.ec())&&(e.bToWarehouse=i.first),n.zc(i=n.ec())&&(e.bToBin=i.first))},hostBindings:function(t,e){1&t&&n.dc("keydown",(function(t){return e.onKeydownHandler(t)}),!1,n.Bc)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-arrow-left"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-columns"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],[1,"fa","fa-plus-square"],[1,"working-container","spi-txn-add",3,"formGroup"],[1,"box"],[1,"box-header"],[1,"fa","fa-angle-right"],[1,"box-body","box-form"],[1,"row"],[1,"form-group","col-sm-3"],[1,"form-label"],[1,"mandatory"],[1,"col-sm-6"],["formControlName","documentNumberingId","bindLabel","documentNumberingName","bindValue","id","placeholder","--SELECT--",3,"items","change"],["type","text","formControlName","documentNumber",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],[1,"action-control"],["formControlName","businessPartnerId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple","change"],["ng-option-tmp",""],["target","_blank","routerLink","/branch/bp/biz-partner-add",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["class","info-icon","container","body","tooltip","View Details",3,"click",4,"ngIf"],["formControlName","bpContactsId","bindLabel","contactName","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["type","text","formControlName","referenceNumber",1,"form-control","form-control-sm"],["class","float-right",4,"ngIf"],["formControlName","fromWarehouseId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple","change","open"],["formControlName","toWarehouseId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple","change","open"],["formControlName","postingDate",3,"monthNavigator","yearNavigator","yearRange","dateFormat"],["formControlName","dueDate",3,"monthNavigator","yearNavigator","yearRange","dateFormat"],["formControlName","documentDate",3,"monthNavigator","yearNavigator","yearRange","dateFormat"],[1,"position-relative"],["formControlName","salesEmpId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["formControlName","status",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],["formControlName","dutyStatusId",1,"form-control","form-control-sm"],["value",""],["formControlName","remarks","rows","2",1,"form-control","form-control-sm"],[1,"box-body","box-table"],[1,"table-responsive",3,"ngStyle"],[1,"table","table-striped","table-bordered"],[4,"ngFor","ngForOf"],["formArrayName","itemListArray"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"type"],[3,"type","doSuccess"],[1,"btn-group","text-right"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],["hActions",""],["hSno",""],["hItemName",""],["hQuantity",""],["hOpenQty",""],["hUOM",""],["hFromWarehouse",""],["hFromBin",""],["hToWarehouse",""],["hToBin",""],["bActions",""],["bSno",""],["bItemName",""],["bQuantity",""],["bOpenQty",""],["bUOM",""],["bFromWarehouse",""],["bFromBin",""],["bToWarehouse",""],["bToBin",""],[1,"fa","fa-print"],[1,"validation-error"],["target","_blank","routerLink","/branch/bp/biz-partner-add",3,"click"],[1,"fa","fa-plus"],[3,"click"],[1,"fa","fa-redo-alt"],["container","body","tooltip","View Details",1,"info-icon",3,"click"],[1,"fa","fa-info-circle"],[1,"float-right"],["type","checkbox","formControlName","intraBranchFlag",3,"change"],[3,"value"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"formGroupName"],["colspan","10"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"fa","fa-broom"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],["class","mt-2",4,"ngIf"],[1,"mt-2"],[1,"badge","badge-danger"],[2,"min-width","80px"],[2,"min-width","30px"],[2,"min-width","200px"],[2,"min-width","100px"],[2,"min-width","135px"],[2,"min-width","120px"],[3,"formGroup"],["placement","top","container","body","tooltip","Delete",1,"action","red",3,"click"],[1,"fa","fa-minus-circle"],["formControlName","itemId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple","virtualScroll","search","change"],["type","text","formControlName","quantity",1,"form-control","form-control-sm","text-right"],["formControlName","uomId","bindLabel","uomName","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["formControlName","fromWarehouseId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple","change"],["formControlName","fromBinId","bindLabel","binName","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["tooltip","Click to get stock details","container","body","placement","bottom",1,"info-icon",3,"click"],["popTemplate",""],["container","body","placement","bottom",3,"popover","outsideClick"],[1,"mb-1"],["formControlName","toWarehouseId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple","change"],["formControlName","toBinId","bindLabel","binName","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["popTemplate1",""]],template:function(t,e){1&t&&n.Jc(0,Bi,191,62,"ng-container",0),2&t&&n.oc("ngIf",e.screenAcl.view)},directives:[b.m,d.n,d.i,T.a,d.m,d.g,d.b,T.c,Dt.a,d.t,b.l,d.p,d.v,b.n,d.d,zt.a,N.a,_t.a,s.g,l.a,d.a,b.q,d.j,jt.a],styles:[""]}),t})();var Ji=i("xKhi");const Oi=["dataTable"];function Ri(t,e){1&t&&(n.Vb(0,"colgroup"),n.Qb(1,"col",13),n.Qb(2,"col",14),n.Qb(3,"col",15),n.Qb(4,"col",15),n.Qb(5,"col",15),n.Qb(6,"col",15),n.Qb(7,"col",16),n.Ub())}function Ki(t,e){if(1&t&&(n.Vb(0,"option",26),n.Lc(1),n.Ub()),2&t){const t=e.$implicit;n.oc("value",t.id),n.Cb(1),n.Mc(t.name)}}function qi(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"th"),n.Lc(2,"Actions"),n.Ub(),n.Vb(3,"th",17),n.Lc(4,"Code"),n.Qb(5,"p-sortIcon",18),n.Ub(),n.Vb(6,"th",17),n.Lc(7,"Chapter"),n.Qb(8,"p-sortIcon",18),n.Ub(),n.Vb(9,"th",17),n.Lc(10,"Heading"),n.Qb(11,"p-sortIcon",18),n.Ub(),n.Vb(12,"th",17),n.Lc(13,"Sub Heading"),n.Qb(14,"p-sortIcon",18),n.Ub(),n.Vb(15,"th",17),n.Lc(16,"Description"),n.Qb(17,"p-sortIcon",18),n.Ub(),n.Vb(18,"th",17),n.Lc(19,"Status"),n.Qb(20,"p-sortIcon",18),n.Ub(),n.Ub(),n.Vb(21,"tr",19),n.Vb(22,"th"),n.Vb(23,"a",20),n.dc("click",(function(){return n.Dc(t),n.hc().clearSearchForm()})),n.Qb(24,"i",21),n.Lc(25,"Clear"),n.Ub(),n.Ub(),n.Vb(26,"th"),n.Vb(27,"input",22),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc().searchForm.hsnCode=e}))("keyup.enter",(function(){return n.Dc(t),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Vb(28,"th"),n.Vb(29,"input",22),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc().searchForm.chapter=e}))("keyup.enter",(function(){return n.Dc(t),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Vb(30,"th"),n.Vb(31,"input",22),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc().searchForm.heading=e}))("keyup.enter",(function(){return n.Dc(t),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Vb(32,"th"),n.Vb(33,"input",22),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc().searchForm.subHeading=e}))("keyup.enter",(function(){return n.Dc(t),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Vb(34,"th"),n.Vb(35,"input",22),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc().searchForm.hsnDescription=e}))("keyup.enter",(function(){return n.Dc(t),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Vb(36,"th"),n.Vb(37,"select",23),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc().searchForm.status=e}))("change",(function(){return n.Dc(t),n.hc().resetListing()})),n.Vb(38,"option",24),n.Lc(39,"--SELECT--"),n.Ub(),n.Jc(40,Ki,2,2,"option",25),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=n.hc();n.Cb(3),n.oc("pSortableColumn","hsnCode"),n.Cb(2),n.oc("field","hsnCode"),n.Cb(1),n.oc("pSortableColumn","chapter"),n.Cb(2),n.oc("field","chapter"),n.Cb(1),n.oc("pSortableColumn","heading"),n.Cb(2),n.oc("field","heading"),n.Cb(1),n.oc("pSortableColumn","subHeading"),n.Cb(2),n.oc("field","subHeading"),n.Cb(1),n.oc("pSortableColumn","hsnDescription"),n.Cb(2),n.oc("field","hsnDescription"),n.Cb(1),n.oc("pSortableColumn","status"),n.Cb(2),n.oc("field","status"),n.Cb(7),n.oc("ngModel",t.searchForm.hsnCode),n.Cb(2),n.oc("ngModel",t.searchForm.chapter),n.Cb(2),n.oc("ngModel",t.searchForm.heading),n.Cb(2),n.oc("ngModel",t.searchForm.subHeading),n.Cb(2),n.oc("ngModel",t.searchForm.hsnDescription),n.Cb(2),n.oc("ngModel",t.searchForm.status),n.Cb(3),n.oc("ngForOf",t.statusList)}}function Gi(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"td"),n.Vb(2,"a",27),n.dc("click",(function(){n.Dc(t);const i=e.$implicit;return n.hc().showAddPopup(i.id)})),n.Qb(3,"i",28),n.Ub(),n.Ub(),n.Vb(4,"td"),n.Lc(5),n.Ub(),n.Vb(6,"td"),n.Lc(7),n.Ub(),n.Vb(8,"td"),n.Lc(9),n.Ub(),n.Vb(10,"td"),n.Lc(11),n.Ub(),n.Vb(12,"td"),n.Lc(13),n.Ub(),n.Vb(14,"td"),n.Vb(15,"span",29),n.Lc(16),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=e.$implicit,i=n.hc();n.Cb(5),n.Mc(t.hsnCode),n.Cb(2),n.Mc(t.chapter),n.Cb(2),n.Mc(t.heading),n.Cb(2),n.Mc(t.subHeading),n.Cb(2),n.Mc(t.hsnDescription),n.Cb(2),n.oc("ngClass",i.appConstants.STATUS_COLOR_CLS[t.status]),n.Cb(1),n.Mc(t.statusName)}}let zi=(()=>{class t{constructor(t,e,i,s,n){this.utilsService=t,this.commonDataService=e,this.hsnDataService=i,this.branchUtilsService=s,this.modalService=n,this.appConstants=r.h,this.statusList=[],this.listing={data:[],totalRecords:0},this.searchForm={hsnCode:"",chapter:"",heading:"",subHeading:"",hsnDescription:"",status:"1"}}ngOnInit(){this.getAutoSuggestionList("getCommonStatusList"),this.branchUtilsService.actionSaveUpdate.subscribe(t=>{"bin-location"===t.triggerType&&this.resetListing()})}getListing(t){const e=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.hsnDataService.getList(e).subscribe(t=>{"SUCCESS"===t.status?(this.listing.data=t.results.searchResults,this.listing.totalRecords=t.results.totalRecords):this.utilsService.showFailureMsg(t)})}clearSearchForm(){this.searchForm={hsnCode:"",chapter:"",heading:"",subHeading:"",hsnDescription:"",status:"1"},this.resetListing()}resetListing(){this.dataTable.reset()}getAutoSuggestionList(t){this.commonDataService.getAutoSuggestionList(t).subscribe(e=>{"SUCCESS"===e.status?"getCommonStatusList"===t&&(this.statusList=e.results):this.utilsService.showFailureMsg(e)})}showAddPopup(t){const e={backdrop:"static"};t&&(e.initialState={inputEditId:t}),this.modalService.show(Ji.a,e)}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.g),n.Pb(o.l),n.Pb(o.t),n.Pb(c.a),n.Pb(E.b))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-hsn-list"]],viewQuery:function(t,e){var i;1&t&&n.Pc(Oi,!0),2&t&&n.zc(i=n.ec())&&(e.dataTable=i.first)},decls:18,vars:5,consts:[[1,"page-title"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],[2,"width","80px"],[2,"width","100px"],[2,"width","200px"],[2,"width","120px"],[3,"pSortableColumn"],[3,"field"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"],[1,"badge",3,"ngClass"]],template:function(t,e){1&t&&(n.Vb(0,"div",0),n.Vb(1,"span"),n.Lc(2,"H"),n.Ub(),n.Lc(3,"SN - List "),n.Vb(4,"div",1),n.Vb(5,"button",2),n.dc("click",(function(){return e.showAddPopup()})),n.Qb(6,"i",3),n.Vb(7,"span"),n.Lc(8,"Add HSN"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(9,"div",4),n.Vb(10,"div",5),n.Vb(11,"div",6),n.Vb(12,"div",7),n.Vb(13,"p-table",8,9),n.dc("onLazyLoad",(function(t){return e.getListing(t)})),n.Jc(15,Ri,8,0,"ng-template",10),n.Jc(16,qi,41,19,"ng-template",11),n.Jc(17,Gi,17,7,"ng-template",12),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub()),2&t&&(n.Cb(13),n.oc("value",e.listing.data)("lazy",!0)("paginator",!0)("rows",e.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",e.listing.totalRecords))},directives:[u.c,m.b,u.b,u.a,l.a,d.b,d.m,d.o,d.t,d.p,d.v,b.l,b.k],styles:[""]}),t})();function _i(t,e){1&t&&(n.Tb(0),n.Lc(1,"Add"),n.Sb())}function ji(t,e){1&t&&(n.Tb(0),n.Lc(1,"Edit"),n.Sb())}function $i(t,e){if(1&t&&(n.Vb(0,"div",18),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors.priceListName," ")}}function Hi(t,e){if(1&t&&(n.Vb(0,"div",18),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors.defaultPriceListId," ")}}function Yi(t,e){if(1&t&&(n.Vb(0,"div",18),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors.defaultFactor," ")}}function Zi(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",19),n.dc("click",(function(){return n.Dc(t),n.hc().saveUpdate()})),n.Qb(1,"i",20),n.Vb(2,"span"),n.Lc(3,"Save"),n.Ub(),n.Ub()}}function Xi(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",21),n.dc("click",(function(){return n.Dc(t),n.hc().clearForm()})),n.Qb(1,"i",22),n.Vb(2,"span"),n.Lc(3,"Clear"),n.Ub(),n.Ub()}}function ts(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",19),n.dc("click",(function(){return n.Dc(t),n.hc().saveUpdate()})),n.Qb(1,"i",23),n.Vb(2,"span"),n.Lc(3,"Update"),n.Ub(),n.Ub()}}function es(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",21),n.dc("click",(function(){return n.Dc(t),n.hc().activeModal.hide()})),n.Qb(1,"i",24),n.Vb(2,"span"),n.Lc(3,"Cancel"),n.Ub(),n.Ub()}}function is(t,e){1&t&&(n.Vb(0,"div",25),n.Vb(1,"span",26),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"update"),n.Ub(),n.Lc(6," this transaction! "),n.Ub())}function ss(t,e){1&t&&(n.Vb(0,"div",25),n.Vb(1,"span",26),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"add"),n.Ub(),n.Lc(6," this transaction!. "),n.Ub())}let rs=(()=>{class t{constructor(t,e,i,s,r,n,o){this.utilsService=t,this.authGuardService=e,this.commonDataService=i,this.pricingDataService=s,this.branchUtilsService=r,this.activeModal=n,this.formBuilder=o,this.screenAcl={},this.defaultBasePriceList=[],this.myFormData={},this.myFormErrors={priceListName:"",defaultPriceListId:"",defaultFactor:""},this.myFormValidationMsgs={priceListName:{required:"Price List Name is required"},defaultPriceListId:{required:"Default Base Price List is required"},defaultFactor:{required:"Default Factor is required"}}}ngOnInit(){this.screenAcl=this.authGuardService.getScreenAcl("28"),this.initializeForm(),this.inputEditId?this.get():this.getAutoSuggestionList("getPriceList")}initializeForm(){this.myForm=this.formBuilder.group({priceListName:["",[d.u.required]],defaultPriceListId:[null,[d.u.required]],defaultFactor:[{value:"",disabled:!1},[d.u.required]],defaultPriceListName:[""]}),this.myForm.valueChanges.subscribe(t=>{this.utilsService.validation(this.myForm,this.myFormErrors,this.myFormValidationMsgs),this.myFormData=this.myForm.getRawValue()}),this.myFormData=this.myForm.getRawValue()}saveUpdate(){if(!this.myForm.valid)return this.utilsService.validation(this.myForm,this.myFormErrors,this.myFormValidationMsgs,!0),!1;const t={priceListName:this.myFormData.priceListName,defaultPriceListId:0===this.myFormData.defaultPriceListId?"":this.myFormData.defaultPriceListId,defaultFactor:this.myFormData.defaultFactor,defaultPriceListName:this.myFormData.defaultPriceListName};let e;this.inputEditId?(e="update",t.id=this.inputEditId):e="save",this.pricingDataService[e](t).subscribe(t=>{"SUCCESS"===t.status?(this.utilsService.showSuccessMsg(t),this.branchUtilsService.actionSaveUpdate.next({triggerType:"price"}),this.activeModal.hide()):this.utilsService.showFailureMsg(t)})}get(){this.pricingDataService.get(this.inputEditId).subscribe(t=>{if("SUCCESS"===t.status){const e=t.results[0];this.myForm.patchValue({priceListName:e.priceListName,defaultPriceListId:e.defaultPriceListId,defaultFactor:e.defaultFactor}),this.getAutoSuggestionList("getPriceList",e.defaultPriceListId)}else this.utilsService.showFailureMsg(t)})}clearForm(){this.initializeForm()}onPriceListNameChange(){let t;t=D.findIndex(this.defaultBasePriceList,this.inputEditId?t=>t.id===this.inputEditId:t=>0===t.id),t>=0?(this.defaultBasePriceList[t].priceListName=this.myFormData.priceListName,this.myFormData.defaultPriceListId||this.myFormData.priceListName!==this.defaultBasePriceList[t].priceListName||this.myForm.patchValue({defaultPriceListId:this.defaultBasePriceList[t].id})):(this.defaultBasePriceList.push({id:0,priceListName:this.myFormData.priceListName}),this.myForm.patchValue({defaultPriceListId:0})),this.defaultBasePriceList=this.defaultBasePriceList.slice(0),this.setDefaultFactor()}onDefaultPriceListNameChange(){const t=D.find(this.defaultBasePriceList,t=>t.id===this.myFormData.defaultPriceListId);this.myForm.patchValue({defaultPriceListName:t.priceListName}),this.setDefaultFactor()}setDefaultFactor(){const t=D.find(this.defaultBasePriceList,t=>t.id===this.myFormData.defaultPriceListId);t&&t.priceListName===this.myFormData.priceListName?(this.myForm.patchValue({defaultFactor:1}),this.myForm.controls.defaultFactor.disable()):(this.myForm.controls.defaultFactor.enable(),this.myFormData.defaultFactor||this.myForm.patchValue({defaultFactor:""}))}getAutoSuggestionList(t,e){this.commonDataService.getAutoSuggestionList(t).subscribe(t=>{"SUCCESS"===t.status?(this.utilsService.ifNotPushToList(t.results,e),this.defaultBasePriceList=t.results,this.setDefaultFactor()):this.utilsService.showFailureMsg(t)})}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.g),n.Pb(r.a),n.Pb(o.l),n.Pb(o.I),n.Pb(c.a),n.Pb(E.a),n.Pb(d.e))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-pricing-add-popup"]],decls:39,vars:13,consts:[[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],[1,"close",3,"click"],[1,"modal-body"],[1,"row",3,"formGroup"],[1,"form-group","col-sm-6"],[1,"form-label"],[1,"mandatory"],["type","text","formControlName","priceListName",1,"form-control","form-control-sm",3,"change"],["class","validation-error",4,"ngIf"],["formControlName","defaultPriceListId","bindLabel","priceListName","bindValue","id","placeholder","--SELECT--",3,"items","change"],["type","text","formControlName","defaultFactor",1,"form-control","form-control-sm"],[1,"modal-footer"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],[1,"validation-error"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-broom"],[1,"fa","fa-sync"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(n.Vb(0,"div",0),n.Vb(1,"h5",1),n.Jc(2,_i,2,0,"ng-container",2),n.Jc(3,ji,2,0,"ng-container",2),n.Lc(4," Price "),n.Ub(),n.Vb(5,"button",3),n.dc("click",(function(){return e.activeModal.hide()})),n.Vb(6,"span"),n.Lc(7,"\xd7"),n.Ub(),n.Ub(),n.Ub(),n.Vb(8,"div",4),n.Vb(9,"div",5),n.Vb(10,"div",6),n.Vb(11,"label",7),n.Lc(12,"Price List Name"),n.Vb(13,"span",8),n.Lc(14,"*"),n.Ub(),n.Ub(),n.Vb(15,"input",9),n.dc("change",(function(){return e.onPriceListNameChange()})),n.Ub(),n.Jc(16,$i,2,1,"div",10),n.Ub(),n.Vb(17,"div",6),n.Vb(18,"label",7),n.Lc(19,"Default Base Price List"),n.Vb(20,"span",8),n.Lc(21,"*"),n.Ub(),n.Ub(),n.Vb(22,"ng-select",11),n.dc("change",(function(){return e.onDefaultPriceListNameChange()})),n.Ub(),n.Jc(23,Hi,2,1,"div",10),n.Ub(),n.Vb(24,"div",6),n.Vb(25,"label",7),n.Lc(26,"Default Factor"),n.Vb(27,"span",8),n.Lc(28,"*"),n.Ub(),n.Ub(),n.Qb(29,"input",12),n.Jc(30,Yi,2,1,"div",10),n.Ub(),n.Ub(),n.Ub(),n.Vb(31,"div",13),n.Vb(32,"div",14),n.Jc(33,Zi,4,0,"button",15),n.Jc(34,Xi,4,0,"button",16),n.Jc(35,ts,4,0,"button",15),n.Jc(36,es,4,0,"button",16),n.Ub(),n.Jc(37,is,7,0,"div",17),n.Jc(38,ss,7,0,"div",17),n.Ub()),2&t&&(n.Cb(2),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(6),n.oc("formGroup",e.myForm),n.Cb(7),n.oc("ngIf",e.myFormErrors.priceListName),n.Cb(6),n.oc("items",e.defaultBasePriceList),n.Cb(1),n.oc("ngIf",e.myFormErrors.defaultPriceListId),n.Cb(7),n.oc("ngIf",e.myFormErrors.defaultFactor),n.Cb(3),n.oc("ngIf",e.screenAcl.add&&!e.inputEditId),n.Cb(1),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.screenAcl.update&&e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId&&!e.screenAcl.update),n.Cb(1),n.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[b.m,d.n,d.i,d.b,d.m,d.g,T.a],styles:[""]}),t})();const ns=["dataTable"];function os(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"th",13),n.Lc(2,"Actions"),n.Ub(),n.Vb(3,"th",14),n.Lc(4,"Price List Name"),n.Qb(5,"p-sortIcon",15),n.Ub(),n.Vb(6,"th",14),n.Lc(7,"Default Base Price List "),n.Qb(8,"p-sortIcon",15),n.Ub(),n.Vb(9,"th",14),n.Lc(10,"Default Factor "),n.Qb(11,"p-sortIcon",15),n.Ub(),n.Ub(),n.Vb(12,"tr",16),n.Vb(13,"th"),n.Vb(14,"a",17),n.dc("click",(function(){return n.Dc(t),n.hc(2).clearSearchForm()})),n.Qb(15,"i",18),n.Lc(16,"Clear"),n.Ub(),n.Ub(),n.Vb(17,"th"),n.Vb(18,"input",19),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.priceListName=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(19,"th"),n.Vb(20,"input",19),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.defaultPriceListName=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(21,"th"),n.Vb(22,"input",19),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.defaultFactor=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=n.hc(2);n.Cb(3),n.oc("pSortableColumn","priceListName"),n.Cb(2),n.oc("field","priceListName"),n.Cb(1),n.oc("pSortableColumn","defaultPriceListName"),n.Cb(2),n.oc("field","defaultPriceListName"),n.Cb(1),n.oc("pSortableColumn","defaultFactor"),n.Cb(2),n.oc("field","defaultFactor"),n.Cb(7),n.oc("ngModel",t.searchForm.priceListName),n.Cb(2),n.oc("ngModel",t.searchForm.defaultPriceListName),n.Cb(2),n.oc("ngModel",t.searchForm.defaultFactor)}}function cs(t,e){if(1&t){const t=n.Wb();n.Vb(0,"a",22),n.dc("click",(function(){n.Dc(t);const e=n.hc().$implicit;return n.hc(2).showAddPopup(e.id)})),n.Qb(1,"i",23),n.Ub()}}function as(t,e){1&t&&(n.Vb(0,"span",24),n.Lc(1,"System"),n.Ub())}function bs(t,e){if(1&t&&(n.Vb(0,"tr"),n.Vb(1,"td"),n.Jc(2,cs,2,0,"a",20),n.Jc(3,as,2,0,"span",21),n.Ub(),n.Vb(4,"td"),n.Lc(5),n.Ub(),n.Vb(6,"td"),n.Lc(7),n.Ub(),n.Vb(8,"td"),n.Lc(9),n.Ub(),n.Ub()),2&t){const t=e.$implicit;n.Cb(2),n.oc("ngIf","0"===t.isSystemConfig),n.Cb(1),n.oc("ngIf","1"===t.isSystemConfig),n.Cb(2),n.Mc(t.priceListName),n.Cb(2),n.Mc(t.defaultPriceListName),n.Cb(2),n.Mc(t.defaultFactor)}}function us(t,e){if(1&t){const t=n.Wb();n.Tb(0),n.Vb(1,"div",1),n.Vb(2,"span"),n.Lc(3,"P"),n.Ub(),n.Lc(4,"rice - List "),n.Vb(5,"div",2),n.Vb(6,"button",3),n.dc("click",(function(){return n.Dc(t),n.hc().showAddPopup()})),n.Qb(7,"i",4),n.Vb(8,"span"),n.Lc(9,"Add Price"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(10,"div",5),n.Vb(11,"div",6),n.Vb(12,"div",7),n.Vb(13,"div",8),n.Vb(14,"p-table",9,10),n.dc("onLazyLoad",(function(e){return n.Dc(t),n.hc().getListing(e)})),n.Jc(16,os,23,9,"ng-template",11),n.Jc(17,bs,10,5,"ng-template",12),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Sb()}if(2&t){const t=n.hc();n.Cb(14),n.oc("value",t.listing.data)("lazy",!0)("paginator",!0)("rows",t.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",t.listing.totalRecords)}}let ms=(()=>{class t{constructor(t,e,i,s,n){this.utilsService=t,this.authGuardService=e,this.pricingDataService=i,this.branchUtilsService=s,this.modalService=n,this.appConstants=r.h,this.screenAcl={},this.listing={data:[],totalRecords:0},this.searchForm={priceListName:"",defaultPriceListName:"",defaultFactor:""}}ngOnInit(){if(this.screenAcl=this.authGuardService.getScreenAcl("28"),!this.screenAcl.view)return this.utilsService.showFailureMsg(r.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.branchUtilsService.actionSaveUpdate.subscribe(t=>{"price"===t.triggerType&&this.resetListing()})}getListing(t){const e=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.pricingDataService.getList(e).subscribe(t=>{"SUCCESS"===t.status?(this.listing.data=t.results.searchResults,this.listing.totalRecords=t.results.totalRecords):this.utilsService.showFailureMsg(t)})}clearSearchForm(){this.searchForm={priceListName:"",defaultPriceListName:"",defaultFactor:""},this.resetListing()}resetListing(){this.dataTable.reset()}showAddPopup(t){const e={backdrop:"static"};t&&(e.initialState={inputEditId:t}),this.modalService.show(rs,e)}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.g),n.Pb(r.a),n.Pb(o.I),n.Pb(c.a),n.Pb(E.b))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-pricing-list"]],viewQuery:function(t,e){var i;1&t&&n.Pc(ns,!0),2&t&&n.zc(i=n.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[2,"width","100px"],[2,"width","100px",3,"pSortableColumn"],[3,"field"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],["class","action blue","placement","top","container","body","tooltip","Edit",3,"click",4,"ngIf"],["class","badge badge-danger",4,"ngIf"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&n.Jc(0,us,18,5,"ng-container",0),2&t&&n.oc("ngIf",e.screenAcl.view)},directives:[b.m,u.c,m.b,u.b,u.a,l.a,d.b,d.m,d.o],styles:[""]}),t})();function ls(t,e){1&t&&(n.Tb(0),n.Lc(1,"Add"),n.Sb())}function ds(t,e){1&t&&(n.Tb(0),n.Lc(1,"Edit"),n.Sb())}function hs(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.partnerName,"\xa0"),n.Cb(2),n.Nc("(",t.partnerCode,")")}}function ps(t,e){if(1&t){const t=n.Wb();n.Vb(0,"span",24),n.dc("click",(function(){n.Dc(t);const e=n.hc();return e.popupExternalService.showDetailPopup("biz-partner",e.myFormData.businessPartnerId)})),n.Qb(1,"i",25),n.Ub()}}function fs(t,e){if(1&t&&(n.Vb(0,"div",26),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors.businessPartnerId," ")}}function gs(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){const t=e.item;n.Cb(1),n.Nc("",t.itemName,"\xa0"),n.Cb(2),n.Nc("(",t.itemCode,")")}}function Ls(t,e){if(1&t){const t=n.Wb();n.Vb(0,"span",24),n.dc("click",(function(){n.Dc(t);const e=n.hc();return e.popupExternalService.showDetailPopup("item",e.myFormData.itemId)})),n.Qb(1,"i",25),n.Ub()}}function vs(t,e){if(1&t&&(n.Vb(0,"div",26),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors.itemName," ")}}function ys(t,e){if(1&t&&(n.Vb(0,"div",26),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors.priceListId," ")}}function Ss(t,e){if(1&t&&(n.Vb(0,"div",26),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors.unitPrice," ")}}function Cs(t,e){if(1&t&&(n.Vb(0,"div",26),n.Lc(1),n.Ub()),2&t){const t=n.hc();n.Cb(1),n.Nc(" ",t.myFormErrors.discountPercentage," ")}}function Us(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",27),n.dc("click",(function(){return n.Dc(t),n.hc().saveUpdate()})),n.Qb(1,"i",28),n.Vb(2,"span"),n.Lc(3,"Save"),n.Ub(),n.Ub()}}function Is(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",29),n.dc("click",(function(){return n.Dc(t),n.hc().clearForm()})),n.Qb(1,"i",30),n.Vb(2,"span"),n.Lc(3,"Clear"),n.Ub(),n.Ub()}}function Vs(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",27),n.dc("click",(function(){return n.Dc(t),n.hc().saveUpdate()})),n.Qb(1,"i",31),n.Vb(2,"span"),n.Lc(3,"Update"),n.Ub(),n.Ub()}}function Fs(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",29),n.dc("click",(function(){return n.Dc(t),n.hc().activeModal.hide()})),n.Qb(1,"i",32),n.Vb(2,"span"),n.Lc(3,"Cancel"),n.Ub(),n.Ub()}}function Ds(t,e){1&t&&(n.Vb(0,"div",33),n.Vb(1,"span",34),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"update"),n.Ub(),n.Lc(6," this transaction! "),n.Ub())}function Ns(t,e){1&t&&(n.Vb(0,"div",33),n.Vb(1,"span",34),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"add"),n.Ub(),n.Lc(6," this transaction!. "),n.Ub())}let Es=(()=>{class t{constructor(t,e,i,s,r,n,o,c){this.utilsService=t,this.authGuardService=e,this.commonDataService=i,this.spPricingSpDataService=s,this.branchUtilsService=r,this.activeModal=n,this.formBuilder=o,this.popupExternalService=c,this.screenAcl={},this.businessPartnerList=[],this.itemList=[],this.pricingList=[],this.myFormData={},this.myFormErrors={businessPartnerId:"",itemName:"",priceListId:"",unitPrice:"",discountPercentage:""},this.myFormValidationMsgs={businessPartnerId:{required:"Business Partner Name is required"},itemName:{required:"Item Name is required"},priceListId:{required:"Price List is required"},unitPrice:{required:"Unit price is required",pattern:"Only positive numbers are allowed"},discountPercentage:{required:"Discount Percentage is required"}}}ngOnInit(){this.screenAcl=this.authGuardService.getScreenAcl("29"),this.initializeForm(),this.branchUtilsService.itemSearch.pipe(Object(Kt.a)(700),Object(qt.a)(),Object(Gt.a)(t=>{this.getItemList(t)})).subscribe(),this.inputEditId?this.get():(this.getAutoSuggestionList("getBusinessPartnerList"),this.getAutoSuggestionList("getPriceList"))}initializeForm(){this.myForm=this.formBuilder.group({businessPartnerId:[null,[d.u.required]],itemId:[null,[d.u.required]],priceListId:[null,[d.u.required]],unitPrice:[0,[d.u.required,d.u.pattern(r.h.VALIDATION_PATTERNS.positiveFloatNumber)]],discountPercentage:["",[d.u.required]],priceAfterDiscount:[{value:"",disabled:!0}]}),this.myForm.valueChanges.subscribe(t=>{this.utilsService.validation(this.myForm,this.myFormErrors,this.myFormValidationMsgs),this.myFormData=this.myForm.getRawValue()}),this.myFormData=this.myForm.getRawValue()}saveUpdate(){if(!this.myForm.valid)return this.utilsService.validation(this.myForm,this.myFormErrors,this.myFormValidationMsgs,!0),!1;const t={businessPartnerId:this.myFormData.businessPartnerId,priceListId:this.myFormData.priceListId,itemId:this.myFormData.itemId,discountPercentage:this.myFormData.discountPercentage,unitPrice:this.myFormData.unitPrice,priceAfterDiscount:this.myFormData.priceAfterDiscount};let e;this.inputEditId?(e="update",t.id=this.inputEditId):e="save",this.spPricingSpDataService[e](t).subscribe(t=>{"SUCCESS"===t.status?(this.utilsService.showSuccessMsg(t),this.branchUtilsService.actionSaveUpdate.next({triggerType:"sp-price-bp"}),this.activeModal.hide()):this.utilsService.showFailureMsg(t)})}get(){this.spPricingSpDataService.get(this.inputEditId).subscribe(t=>{if("SUCCESS"===t.status){const e=t.results[0];this.myForm.patchValue({businessPartnerId:e.businessPartnerInfo[0].id,itemId:e.itemInfo[0].id,priceListId:e.priceListInfo[0].id,unitPrice:e.unitPrice,discountPercentage:e.discountPercentage,priceAfterDiscount:e.priceAfterDiscount}),this.getItemList("",!0,e.itemInfo),this.getAutoSuggestionList("getBusinessPartnerList",e.businessPartnerInfo),this.getAutoSuggestionList("getPriceList",e.priceListInfo)}else this.utilsService.showFailureMsg(t)})}clearForm(){this.initializeForm()}onItemSearch(t){this.branchUtilsService.itemSearch.next(t)}getAutoSuggestionList(t,e){this.commonDataService.getAutoSuggestionList(t).subscribe(i=>{"SUCCESS"===i.status?(this.utilsService.ifNotPushToList(i.results,e),"getPriceList"===t?this.pricingList=i.results:"getBusinessPartnerList"===t&&(this.businessPartnerList=i.results.map(t=>(t.searchText=t.partnerName+" - "+t.partnerCode,t)))):this.utilsService.showFailureMsg(i)})}onItemPriceChange(){this.myFormData.priceListId&&this.myFormData.itemId?this.commonDataService.getItemPriceValue({itemId:this.myFormData.itemId,priceListId:this.myFormData.priceListId,type:"SPB"}).subscribe(t=>{"SUCCESS"===t.status?(this.myForm.patchValue({discountPercentage:t.results.discountPercentage,unitPrice:t.results.unitPrice}),this.onDiscountChange()):this.utilsService.showFailureMsg(t)}):this.myFormData.itemId||this.utilsService.showFailureMsg("Select Item to get unit price")}onDiscountChange(){const t=this.myFormData.unitPrice?this.myFormData.unitPrice:0,e=this.myFormData.discountPercentage?this.myFormData.discountPercentage:0,i=parseInt(t,10)*(parseInt(e,10)/100),s=parseInt(t,10)-i;this.myForm.patchValue({priceAfterDiscount:s})}getItemList(t,e,i){return e?(this.itemList=i.map(t=>(t.searchText=t.itemName+" - "+t.itemCode,t)),!1):!t.term||t.term.length<3?(this.itemList=[],!1):void this.commonDataService.getItemList(t.term,3).subscribe(t=>{"SUCCESS"===t.status?this.itemList=t.results.map(t=>(t.searchText=t.itemName+" - "+t.itemCode,t)):this.utilsService.showFailureMsg(t)})}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.g),n.Pb(r.a),n.Pb(o.l),n.Pb(o.cb),n.Pb(c.a),n.Pb(E.a),n.Pb(d.e),n.Pb(a.a))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-sp-pricing-bp-add-popup"]],decls:63,vars:22,consts:[[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],[1,"close",3,"click"],[1,"modal-body"],[1,"row",3,"formGroup"],[1,"form-group","col-sm-6"],[1,"form-label"],[1,"mandatory"],[1,"position-relative"],["formControlName","businessPartnerId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["ng-option-tmp",""],["class","info-icon","container","body","tooltip","View Details",3,"click",4,"ngIf"],["class","validation-error",4,"ngIf"],["formControlName","itemId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple","virtualScroll","search","change"],["formControlName","priceListId","bindLabel","priceListName","bindValue","id","placeholder","--SELECT--",3,"items","change"],["type","text","formControlName","unitPrice",1,"form-control","form-control-sm",3,"keyup"],["type","text","formControlName","discountPercentage",1,"form-control","form-control-sm",3,"keyup"],["type","text","formControlName","priceAfterDiscount",1,"form-control","form-control-sm"],[1,"modal-footer"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],["container","body","tooltip","View Details",1,"info-icon",3,"click"],[1,"fa","fa-info-circle"],[1,"validation-error"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-broom"],[1,"fa","fa-sync"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(n.Vb(0,"div",0),n.Vb(1,"h5",1),n.Lc(2," Special Prices for Business Partners - "),n.Jc(3,ls,2,0,"ng-container",2),n.Jc(4,ds,2,0,"ng-container",2),n.Ub(),n.Vb(5,"button",3),n.dc("click",(function(){return e.activeModal.hide()})),n.Vb(6,"span"),n.Lc(7,"\xd7"),n.Ub(),n.Ub(),n.Ub(),n.Vb(8,"div",4),n.Vb(9,"div",5),n.Vb(10,"div",6),n.Vb(11,"label",7),n.Lc(12,"Business Partner Name"),n.Vb(13,"span",8),n.Lc(14,"*"),n.Ub(),n.Ub(),n.Vb(15,"div",9),n.Vb(16,"ng-select",10),n.Jc(17,hs,4,2,"ng-template",11),n.Ub(),n.Jc(18,ps,2,0,"span",12),n.Ub(),n.Jc(19,fs,2,1,"div",13),n.Ub(),n.Vb(20,"div",6),n.Vb(21,"label",7),n.Lc(22,"Item Name"),n.Vb(23,"span",8),n.Lc(24,"*"),n.Ub(),n.Ub(),n.Vb(25,"div",9),n.Vb(26,"ng-select",14),n.dc("search",(function(t){return e.onItemSearch(t)}))("change",(function(){return e.onItemPriceChange()})),n.Jc(27,gs,4,2,"ng-template",11),n.Ub(),n.Jc(28,Ls,2,0,"span",12),n.Ub(),n.Jc(29,vs,2,1,"div",13),n.Ub(),n.Vb(30,"div",6),n.Vb(31,"label",7),n.Lc(32,"Price List"),n.Vb(33,"span",8),n.Lc(34,"*"),n.Ub(),n.Ub(),n.Vb(35,"ng-select",15),n.dc("change",(function(){return e.onItemPriceChange()})),n.Ub(),n.Jc(36,ys,2,1,"div",13),n.Ub(),n.Vb(37,"div",6),n.Vb(38,"label",7),n.Lc(39,"Unit Price"),n.Vb(40,"span",8),n.Lc(41,"*"),n.Ub(),n.Ub(),n.Vb(42,"input",16),n.dc("keyup",(function(){return e.onDiscountChange()})),n.Ub(),n.Jc(43,Ss,2,1,"div",13),n.Ub(),n.Vb(44,"div",6),n.Vb(45,"label",7),n.Lc(46,"Discount Percentage"),n.Vb(47,"span",8),n.Lc(48,"*"),n.Ub(),n.Ub(),n.Vb(49,"input",17),n.dc("keyup",(function(){return e.onDiscountChange()})),n.Ub(),n.Jc(50,Cs,2,1,"div",13),n.Ub(),n.Vb(51,"div",6),n.Vb(52,"label",7),n.Lc(53,"Price After Discount"),n.Ub(),n.Qb(54,"input",18),n.Ub(),n.Ub(),n.Ub(),n.Vb(55,"div",19),n.Vb(56,"div",20),n.Jc(57,Us,4,0,"button",21),n.Jc(58,Is,4,0,"button",22),n.Jc(59,Vs,4,0,"button",21),n.Jc(60,Fs,4,0,"button",22),n.Ub(),n.Jc(61,Ds,7,0,"div",23),n.Jc(62,Ns,7,0,"div",23),n.Ub()),2&t&&(n.Cb(3),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(5),n.oc("formGroup",e.myForm),n.Cb(7),n.oc("items",e.businessPartnerList)("multiple",!1),n.Cb(2),n.oc("ngIf",e.myFormData.businessPartnerId),n.Cb(1),n.oc("ngIf",e.myFormErrors.businessPartnerId),n.Cb(7),n.oc("items",e.itemList)("multiple",!1)("virtualScroll",!0),n.Cb(2),n.oc("ngIf",e.myFormData.itemId),n.Cb(1),n.oc("ngIf",e.myFormErrors.itemName),n.Cb(6),n.oc("items",e.pricingList),n.Cb(1),n.oc("ngIf",e.myFormErrors.priceListId),n.Cb(7),n.oc("ngIf",e.myFormErrors.unitPrice),n.Cb(7),n.oc("ngIf",e.myFormErrors.discountPercentage),n.Cb(7),n.oc("ngIf",e.screenAcl.add&&!e.inputEditId),n.Cb(1),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.screenAcl.update&&e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId&&!e.screenAcl.update),n.Cb(1),n.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[b.m,d.n,d.i,T.a,d.m,d.g,T.c,d.b,l.a],styles:[""]}),t})();const Ts=["dataTable"];function Ps(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"th",13),n.Lc(2,"Actions"),n.Ub(),n.Vb(3,"th",14),n.Lc(4,"Business Partner Name"),n.Qb(5,"p-sortIcon",15),n.Ub(),n.Vb(6,"th",14),n.Lc(7,"Item Name "),n.Qb(8,"p-sortIcon",15),n.Ub(),n.Vb(9,"th",16),n.Lc(10,"Price List "),n.Qb(11,"p-sortIcon",15),n.Ub(),n.Vb(12,"th",16),n.Lc(13,"Unit Price "),n.Qb(14,"p-sortIcon",15),n.Ub(),n.Vb(15,"th",17),n.Lc(16,"Discount Percentage "),n.Qb(17,"p-sortIcon",15),n.Ub(),n.Vb(18,"th",18),n.Lc(19,"Price After Discount "),n.Qb(20,"p-sortIcon",15),n.Ub(),n.Ub(),n.Vb(21,"tr",19),n.Vb(22,"th"),n.Vb(23,"a",20),n.dc("click",(function(){return n.Dc(t),n.hc(2).clearSearchForm()})),n.Qb(24,"i",21),n.Lc(25,"Clear"),n.Ub(),n.Ub(),n.Vb(26,"th"),n.Vb(27,"input",22),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.partnerName=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Qb(28,"th"),n.Vb(29,"th"),n.Vb(30,"input",22),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.priceListName=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(31,"th"),n.Vb(32,"input",22),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.unitPrice=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(33,"th"),n.Vb(34,"input",22),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.discountPercentage=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(35,"th"),n.Vb(36,"input",22),n.dc("ngModelChange",(function(e){return n.Dc(t),n.hc(2).searchForm.priceAfterDiscount=e}))("keyup.enter",(function(){return n.Dc(t),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=n.hc(2);n.Cb(3),n.oc("pSortableColumn","partnerName"),n.Cb(2),n.oc("field","partnerName"),n.Cb(1),n.oc("pSortableColumn","itemName"),n.Cb(2),n.oc("field","itemName"),n.Cb(1),n.oc("pSortableColumn","priceListName"),n.Cb(2),n.oc("field","priceListName"),n.Cb(1),n.oc("pSortableColumn","unitPrice"),n.Cb(2),n.oc("field","unitPrice"),n.Cb(1),n.oc("pSortableColumn","discountPercentage"),n.Cb(2),n.oc("field","discountPercentage"),n.Cb(1),n.oc("pSortableColumn","priceAfterDiscount"),n.Cb(2),n.oc("field","priceAfterDiscount"),n.Cb(7),n.oc("ngModel",t.searchForm.partnerName),n.Cb(3),n.oc("ngModel",t.searchForm.priceListName),n.Cb(2),n.oc("ngModel",t.searchForm.unitPrice),n.Cb(2),n.oc("ngModel",t.searchForm.discountPercentage),n.Cb(2),n.oc("ngModel",t.searchForm.priceAfterDiscount)}}function As(t,e){if(1&t){const t=n.Wb();n.Vb(0,"tr"),n.Vb(1,"td"),n.Vb(2,"a",23),n.dc("click",(function(){n.Dc(t);const i=e.$implicit;return n.hc(2).showAddPopup(i.id)})),n.Qb(3,"i",24),n.Ub(),n.Ub(),n.Vb(4,"td"),n.Lc(5),n.Ub(),n.Vb(6,"td"),n.Lc(7),n.Ub(),n.Vb(8,"td"),n.Lc(9),n.Ub(),n.Vb(10,"td"),n.Lc(11),n.Ub(),n.Vb(12,"td"),n.Lc(13),n.Ub(),n.Vb(14,"td"),n.Lc(15),n.Ub(),n.Ub()}if(2&t){const t=e.$implicit;n.Cb(5),n.Oc("",t.partnerCode," - ",t.partnerName,""),n.Cb(2),n.Oc("",t.itemCode," - ",t.itemName,""),n.Cb(2),n.Mc(t.priceListName),n.Cb(2),n.Mc(t.unitPrice),n.Cb(2),n.Mc(t.discountPercentage),n.Cb(2),n.Mc(t.priceAfterDiscount)}}function ws(t,e){if(1&t){const t=n.Wb();n.Tb(0),n.Vb(1,"div",1),n.Vb(2,"span"),n.Lc(3,"S"),n.Ub(),n.Lc(4,"pecial Prices for Business Partners - List "),n.Vb(5,"div",2),n.Vb(6,"button",3),n.dc("click",(function(){return n.Dc(t),n.hc().showAddPopup()})),n.Qb(7,"i",4),n.Vb(8,"span"),n.Lc(9,"Add Special Prices"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(10,"div",5),n.Vb(11,"div",6),n.Vb(12,"div",7),n.Vb(13,"div",8),n.Vb(14,"p-table",9,10),n.dc("onLazyLoad",(function(e){return n.Dc(t),n.hc().getListing(e)})),n.Jc(16,Ps,37,17,"ng-template",11),n.Jc(17,As,16,8,"ng-template",12),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Sb()}if(2&t){const t=n.hc();n.Cb(14),n.oc("value",t.listing.data)("lazy",!0)("paginator",!0)("rows",t.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",t.listing.totalRecords)}}const xs=s.h.forChild([{path:"item-list",component:F},{path:"item-add",component:rt},{path:"item-edit/:id",component:rt},{path:"bin-list",component:It},{path:"inventory-txn-list/:screenName",component:Rt},{path:"inventory-txn-add/:screenName",component:Qi},{path:"inventory-txn-edit/:screenName/:id",component:Qi},{path:"inventory-txn-edit-draft/:screenName/:draftId",component:Qi},{path:"inventory-txn-copy/:screenName/:copyScreenName/:copyId",component:Qi},{path:"inventory-txn-duplicate/:screenName/:duplicateId",component:Qi},{path:"hsn-list",component:zi},{path:"pricing-list",component:ms},{path:"special-pricing-list",component:(()=>{class t{constructor(t,e,i,s,n){this.utilsService=t,this.authGuardService=e,this.spPricingSpDataService=i,this.branchUtilsService=s,this.modalService=n,this.appConstants=r.h,this.screenAcl={},this.listing={data:[],totalRecords:0},this.searchForm={partnerName:"",priceListName:"",unitPrice:"",discountPercentage:"",priceAfterDiscount:""}}ngOnInit(){if(this.screenAcl=this.authGuardService.getScreenAcl("29"),!this.screenAcl.view)return this.utilsService.showFailureMsg(r.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.branchUtilsService.actionSaveUpdate.subscribe(t=>{"sp-price-bp"===t.triggerType&&this.resetListing()})}getListing(t){const e=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.spPricingSpDataService.getList(e).subscribe(t=>{"SUCCESS"===t.status?(this.listing.data=t.results.searchResults,this.listing.totalRecords=t.results.totalRecords):this.utilsService.showFailureMsg(t)})}clearSearchForm(){this.searchForm={partnerName:"",priceListName:"",unitPrice:"",discountPercentage:"",priceAfterDiscount:""},this.resetListing()}resetListing(){this.dataTable.reset()}showAddPopup(t){const e={backdrop:"static"};t&&(e.initialState={inputEditId:t}),this.modalService.show(Es,e)}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.g),n.Pb(r.a),n.Pb(o.cb),n.Pb(c.a),n.Pb(E.b))},t.\u0275cmp=n.Jb({type:t,selectors:[["app-sp-pricing-bp-list"]],viewQuery:function(t,e){var i;1&t&&n.Pc(Ts,!0),2&t&&n.zc(i=n.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[2,"width","50px"],[2,"width","150px",3,"pSortableColumn"],[3,"field"],[2,"width","80px",3,"pSortableColumn"],[2,"width","100px",3,"pSortableColumn"],[2,"width","90px",3,"pSortableColumn"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"]],template:function(t,e){1&t&&n.Jc(0,ws,18,5,"ng-container",0),2&t&&n.oc("ngIf",e.screenAcl.view)},directives:[b.m,u.c,m.b,u.b,u.a,l.a,d.b,d.m,d.o],styles:[""]}),t})()}]);var Ms=i("o+NB"),ks=i("7zUj"),Ws=i("N5hj"),Bs=i("dJ0z");let Qs=(()=>{class t{}return t.\u0275mod=n.Nb({type:t}),t.\u0275inj=n.Mb({factory:function(e){return new(e||t)},providers:[Ft],imports:[[xs,Ms.BranchModule,ks.a,Ws.a,Bs.a]]}),t})()}}]);