function _createForOfIteratorHelper(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,n=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return n=t.done,t},e:function(t){s=!0,a=t},f:function(){try{n||null==i.return||i.return()}finally{if(s)throw a}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{J6bJ:function(t,e,i){"use strict";i.r(e),i.d(e,"CrmModule",(function(){return Re}));var r=i("tyNb"),o=i("LvDl"),a=i("ey9i"),n=i("fXoL"),s=i("oARB"),c=i("ofXK"),b=i("eO1q"),u=i("3Pt+"),l=i("rEr+"),d=i("7zfz"),m=i("Mfq2"),p=["dataTable"];function g(t,e){if(1&t){var i=n.Wb();n.Vb(0,"button",20),n.dc("click",(function(){return n.Dc(i),n.hc(2).downloadAsExcel()})),n.Qb(1,"i",21),n.Vb(2,"span"),n.Lc(3,"Download as Excel"),n.Ub(),n.Ub()}}function h(t,e){if(1&t&&(n.Vb(0,"div",22),n.Vb(1,"div",23),n.Vb(2,"div",24),n.Lc(3),n.Ub(),n.Vb(4,"div",25),n.Lc(5),n.Ub(),n.Ub(),n.Ub()),2&t){var i=e.$implicit,r=n.hc(2);n.Cb(3),n.Nc(" ",i.name," "),n.Cb(1),n.oc("ngClass",r.appConstants.ACTIVITY_STATUS_COLOR_CLS[i.id]),n.Cb(1),n.Mc(i.count)}}function f(t,e){1&t&&(n.Vb(0,"th",43),n.Lc(1,"Branch Name "),n.Qb(2,"p-sortIcon",30),n.Ub()),2&t&&(n.oc("pSortableColumn","branchName"),n.Cb(2),n.oc("field","branchName"))}function v(t,e){1&t&&(n.Vb(0,"th",44),n.Lc(1,"Sap Doc No"),n.Qb(2,"p-sortIcon",30),n.Ub()),2&t&&(n.oc("pSortableColumn","sapId"),n.Cb(2),n.oc("field","sapId"))}function y(t,e){if(1&t){var i=n.Wb();n.Vb(0,"th"),n.Vb(1,"input",41),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(3).searchForm.branchName=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(3).resetListing()})),n.Ub(),n.Ub()}if(2&t){var r=n.hc(3);n.Cb(1),n.oc("ngModel",r.searchForm.branchName)}}function C(t,e){if(1&t){var i=n.Wb();n.Vb(0,"th"),n.Vb(1,"input",41),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(3).searchForm.sapId=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(3).resetListing()})),n.Ub(),n.Ub()}if(2&t){var r=n.hc(3);n.Cb(1),n.oc("ngModel",r.searchForm.sapId)}}function L(t,e){if(1&t&&(n.Vb(0,"option",45),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.name)}}function S(t,e){if(1&t&&(n.Vb(0,"option",45),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.activityName)}}function I(t,e){if(1&t&&(n.Vb(0,"option",45),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Nc(" ",i.name," ")}}function U(t,e){if(1&t){var i=n.Wb();n.Vb(0,"tr"),n.Vb(1,"th",26),n.Lc(2,"Actions"),n.Ub(),n.Jc(3,f,3,2,"th",27),n.Jc(4,v,3,2,"th",28),n.Vb(5,"th",29),n.Lc(6,"Overdue "),n.Qb(7,"p-sortIcon",30),n.Ub(),n.Vb(8,"th",31),n.Lc(9,"Priority "),n.Qb(10,"p-sortIcon",30),n.Ub(),n.Vb(11,"th",29),n.Lc(12,"Activity No "),n.Qb(13,"p-sortIcon",30),n.Ub(),n.Vb(14,"th",29),n.Lc(15,"Activity Type "),n.Qb(16,"p-sortIcon",30),n.Ub(),n.Vb(17,"th",32),n.Lc(18,"Assigned To "),n.Qb(19,"p-sortIcon",30),n.Ub(),n.Vb(20,"th",29),n.Lc(21,"Status "),n.Qb(22,"p-sortIcon",30),n.Ub(),n.Vb(23,"th",33),n.Lc(24,"Start Time "),n.Qb(25,"p-sortIcon",30),n.Ub(),n.Vb(26,"th",32),n.Lc(27,"Business Partner Name "),n.Qb(28,"p-sortIcon",30),n.Ub(),n.Vb(29,"th",34),n.Lc(30,"Distribution Rules"),n.Ub(),n.Ub(),n.Vb(31,"tr",35),n.Vb(32,"th"),n.Vb(33,"a",36),n.dc("click",(function(){return n.Dc(i),n.hc(2).clearSearchForm()})),n.Qb(34,"i",37),n.Lc(35,"Clear"),n.Ub(),n.Ub(),n.Jc(36,y,2,1,"th",0),n.Jc(37,C,2,1,"th",0),n.Qb(38,"th"),n.Vb(39,"th"),n.Vb(40,"select",38),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.priorityId=t}))("change",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Vb(41,"option",39),n.Lc(42,"--SELECT--"),n.Ub(),n.Jc(43,L,2,2,"option",40),n.Ub(),n.Ub(),n.Vb(44,"th"),n.Vb(45,"input",41),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.activityNo=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(46,"th"),n.Vb(47,"select",42),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.activityTypeId=t}))("change",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Vb(48,"option",39),n.Lc(49,"--SELECT--"),n.Ub(),n.Jc(50,S,2,2,"option",40),n.Ub(),n.Ub(),n.Vb(51,"th"),n.Vb(52,"input",41),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.assignedToName=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(53,"th"),n.Vb(54,"select",42),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.status=t}))("change",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Vb(55,"option",39),n.Lc(56,"--SELECT--"),n.Ub(),n.Jc(57,I,2,2,"option",40),n.Ub(),n.Ub(),n.Vb(58,"th"),n.Vb(59,"p-calendar",12),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.startDateTime=t}))("onSelect",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(60,"th"),n.Vb(61,"input",41),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.partnerName=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Qb(62,"th"),n.Ub()}if(2&t){var r=n.hc(2);n.Cb(3),n.oc("ngIf",!r.storageService.get("isSingleBranchUser")),n.Cb(1),n.oc("ngIf",r.storageService.get("isSap")),n.Cb(1),n.oc("pSortableColumn","overDueValue"),n.Cb(2),n.oc("field","overDueValue"),n.Cb(1),n.oc("pSortableColumn","priorityId"),n.Cb(2),n.oc("field","priorityId"),n.Cb(1),n.oc("pSortableColumn","activityNo"),n.Cb(2),n.oc("field","activityNo"),n.Cb(1),n.oc("pSortableColumn","activityTypeId"),n.Cb(2),n.oc("field","activityTypeId"),n.Cb(1),n.oc("pSortableColumn","assignedToName"),n.Cb(2),n.oc("field","assignedToName"),n.Cb(1),n.oc("pSortableColumn","status"),n.Cb(2),n.oc("field","status"),n.Cb(1),n.oc("pSortableColumn","startDateTime"),n.Cb(2),n.oc("field","startDateTime"),n.Cb(1),n.oc("pSortableColumn","partnerName"),n.Cb(2),n.oc("field","partnerName"),n.Cb(8),n.oc("ngIf",!r.storageService.get("isSingleBranchUser")),n.Cb(1),n.oc("ngIf",r.storageService.get("isSap")),n.Cb(3),n.oc("ngModel",r.searchForm.priorityId),n.Cb(3),n.oc("ngForOf",r.priorityList),n.Cb(2),n.oc("ngModel",r.searchForm.activityNo),n.Cb(2),n.oc("ngModel",r.searchForm.activityTypeId),n.Cb(3),n.oc("ngForOf",r.activityTypeList),n.Cb(2),n.oc("ngModel",r.searchForm.assignedToName),n.Cb(2),n.oc("ngModel",r.searchForm.status),n.Cb(3),n.oc("ngForOf",r.statusList),n.Cb(2),n.oc("ngModel",r.searchForm.startDateTime)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),n.Cb(2),n.oc("ngModel",r.searchForm.partnerName)}}function V(t,e){if(1&t&&(n.Vb(0,"td"),n.Lc(1),n.Ub()),2&t){var i=n.hc().$implicit;n.Cb(1),n.Mc(i.branchName)}}function D(t,e){if(1&t&&(n.Vb(0,"td"),n.Lc(1),n.Ub()),2&t){var i=n.hc().$implicit;n.Cb(1),n.Mc(i.sapId)}}function F(t,e){if(1&t&&(n.Vb(0,"span",52),n.Lc(1),n.Ub()),2&t){var i=n.hc().$implicit;n.Cb(1),n.Nc("",i.overDueValue," Days")}}function N(t,e){if(1&t&&(n.Vb(0,"tr"),n.Vb(1,"td"),n.Vb(2,"a",46),n.Qb(3,"i",47),n.Ub(),n.Ub(),n.Jc(4,V,2,1,"td",0),n.Jc(5,D,2,1,"td",0),n.Vb(6,"td"),n.Jc(7,F,2,1,"span",48),n.Ub(),n.Vb(8,"td"),n.Vb(9,"span",49),n.Lc(10),n.Ub(),n.Ub(),n.Vb(11,"td"),n.Lc(12),n.Ub(),n.Vb(13,"td"),n.Lc(14),n.Ub(),n.Vb(15,"td"),n.Qb(16,"img",50),n.Lc(17),n.Ub(),n.Vb(18,"td"),n.Vb(19,"span",49),n.Lc(20),n.Ub(),n.Ub(),n.Vb(21,"td"),n.Lc(22),n.Ub(),n.Vb(23,"td"),n.Lc(24),n.Ub(),n.Vb(25,"td"),n.Vb(26,"div",51),n.Lc(27),n.Ub(),n.Ub(),n.Ub()),2&t){var i=e.$implicit,r=n.hc(2);n.Cb(2),n.qc("routerLink","/branch/crm/activity-edit/",r.utilsService.encrypt(i.id),""),n.Cb(2),n.oc("ngIf",!r.storageService.get("isSingleBranchUser")),n.Cb(1),n.oc("ngIf",r.storageService.get("isSap")),n.Cb(2),n.oc("ngIf",i.overDueValue<0),n.Cb(2),n.oc("ngClass",r.appConstants.PRIORITY_STATUS_COLOR_CLS[i.priorityId]),n.Cb(1),n.Mc(i.priorityName),n.Cb(2),n.Mc(i.activityNo),n.Cb(2),n.Mc(i.activityName),n.Cb(2),n.oc("src",i.assignedToImgUrl?i.assignedToImgUrl:r.appConstants.DEFAULT_USER_ICON,n.Fc),n.Cb(1),n.Oc("\xa0",i.assignedToCode," - ",i.assignedToName,""),n.Cb(2),n.oc("ngClass",r.appConstants.ACTIVITY_STATUS_COLOR_CLS[i.status]),n.Cb(1),n.Mc(i.statusName),n.Cb(2),n.Mc(i.startDateTime),n.Cb(2),n.Oc("",i.partnerCode," - ",i.partnerName,""),n.Cb(2),n.oc("tooltip",i.distributionRulesValues),n.Cb(1),n.Nc(" ",i.distributionRulesValues,"")}}function T(t,e){if(1&t){var i=n.Wb();n.Tb(0),n.Vb(1,"div",1),n.Vb(2,"span"),n.Lc(3,"A"),n.Ub(),n.Lc(4,"ctivity - List "),n.Vb(5,"div",2),n.Jc(6,g,4,0,"button",3),n.Vb(7,"button",4),n.Qb(8,"i",5),n.Vb(9,"span"),n.Lc(10,"Add Activity"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(11,"div",6),n.Vb(12,"div",7),n.Vb(13,"div",8),n.Jc(14,h,6,3,"div",9),n.Ub(),n.Ub(),n.Vb(15,"div",8),n.Vb(16,"div",10),n.Vb(17,"label",11),n.Vb(18,"strong"),n.Lc(19,"From Date"),n.Ub(),n.Ub(),n.Vb(20,"p-calendar",12),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc().searchForm.fromDate=t}))("onSelect",(function(){return n.Dc(i),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Vb(21,"div",10),n.Vb(22,"label",11),n.Vb(23,"strong"),n.Lc(24,"To Date"),n.Ub(),n.Ub(),n.Vb(25,"p-calendar",13),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc().searchForm.toDate=t}))("onSelect",(function(){return n.Dc(i),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Ub(),n.Vb(26,"div",8),n.Vb(27,"div",14),n.Vb(28,"div",15),n.Vb(29,"p-table",16,17),n.dc("onLazyLoad",(function(t){return n.Dc(i),n.hc().getListing(t)})),n.Jc(31,U,63,34,"ng-template",18),n.Jc(32,N,28,18,"ng-template",19),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Sb()}if(2&t){var r=n.hc();n.Cb(6),n.oc("ngIf",r.screenAcl.download),n.Cb(8),n.oc("ngForOf",r.analyticsData),n.Cb(6),n.oc("ngModel",r.searchForm.fromDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),n.Cb(5),n.oc("ngModel",r.searchForm.toDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT)("minDate",r.searchForm.fromDate),n.Cb(4),n.oc("value",r.listing.data)("lazy",!0)("paginator",!0)("rows",r.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",r.listing.totalRecords)}}var E,A=((E=function(){function t(e,i,r,o,n){_classCallCheck(this,t),this.utilsService=e,this.storageService=i,this.authGuardService=r,this.commonDataService=o,this.activityDataService=n,this.appConstants=a.h,this.screenAcl={},this.analyticsData=[],this.statusList=[],this.activityTypeList=[],this.priorityList=[],this.listingProperties={},this.listing={data:[],totalRecords:0},this.searchForm={sapId:"",activityNo:"",activityTypeId:"",assignedToName:"",partnerName:"",startDateTime:"",priorityId:"",status:"1",fromDate:"",toDate:"",branchName:""}}return _createClass(t,[{key:"ngOnInit",value:function(){if(this.screenAcl=this.authGuardService.getScreenAcl("4"),!this.screenAcl.view)return this.utilsService.showFailureMsg(a.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.getAutoSuggestionList("getActivityStatusList"),this.getAutoSuggestionList("getMasterActivityList"),this.getAutoSuggestionList("getActivityPriorityTypeList"),this.getAnalyticsData()}},{key:"getListing",value:function(t){var e=this,i=Object.assign({},this.searchForm);i.fromDate=this.utilsService.getBackendDateFormat(this.searchForm.fromDate),i.toDate=this.utilsService.getBackendDateFormat(this.searchForm.toDate),i.startDateTime=this.utilsService.getBackendDateFormat(this.searchForm.startDateTime);var r=this.utilsService.dataTableParameterFormation(t,i);this.listingProperties=r,this.activityDataService.getList(r).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"clearSearchForm",value:function(){this.searchForm={sapId:"",activityNo:"",activityTypeId:"",assignedToName:"",partnerName:"",startDateTime:"",priorityId:"",status:"1",fromDate:"",toDate:"",branchName:""},this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"getAutoSuggestionList",value:function(t){var e=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(i){if("SUCCESS"===i.status){var r="";"getActivityStatusList"===t?r="statusList":"getMasterActivityList"===t?r="activityTypeList":"getActivityPriorityTypeList"===t&&(r="priorityList"),e[r]=i.results}else e.utilsService.showFailureMsg(i)}))}},{key:"getAnalyticsData",value:function(){var t=this;this.activityDataService.getAnalyticsData().subscribe((function(e){"SUCCESS"===e.status?(t.analyticsData=e.results,t.analyticsData=o.orderBy(t.analyticsData,["id"],["asc"])):t.utilsService.showFailureMsg(e)}))}},{key:"downloadAsExcel",value:function(){var t=this;this.activityDataService.downloadAsExcel(this.listingProperties).subscribe((function(e){"SUCCESS"===e.status?t.utilsService.externalRedirect(e.fileUrl):t.utilsService.showFailureMsg(e)}))}}]),t}()).\u0275fac=function(t){return new(t||E)(n.Pb(a.g),n.Pb(a.f),n.Pb(a.a),n.Pb(s.l),n.Pb(s.b))},E.\u0275cmp=n.Jb({type:E,selectors:[["app-activity-list"]],viewQuery:function(t,e){var i;1&t&&n.Pc(p,!0),2&t&&n.zc(i=n.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],["class","btn btn-success btn-sm",3,"click",4,"ngIf"],["routerLink","/branch/crm/activity-add",1,"btn","btn-primary","btn-sm"],[1,"fa","fa-plus"],[1,"working-container"],[1,"analytics"],[1,"row"],["class","col-lg-2 col-md-3 col-sm-4 col-xs-12",4,"ngFor","ngForOf"],[1,"form-group","col-sm-3"],[1,"form-label"],["appendTo","body",3,"ngModel","monthNavigator","yearNavigator","yearRange","dateFormat","ngModelChange","onSelect"],["appendTo","body",3,"ngModel","monthNavigator","yearNavigator","yearRange","dateFormat","minDate","ngModelChange","onSelect"],[1,"col-12"],[1,"datatable-responsive"],["sortField","startDateTime",3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa","fa-file-excel"],[1,"col-lg-2","col-md-3","col-sm-4","col-xs-12"],[1,"item"],[1,"name"],[1,"count",3,"ngClass"],[2,"width","100px"],["style","width:150px",3,"pSortableColumn",4,"ngIf"],["style","width:110px",3,"pSortableColumn",4,"ngIf"],[2,"width","120px",3,"pSortableColumn"],[3,"field"],[2,"width","100px",3,"pSortableColumn"],[2,"width","250px",3,"pSortableColumn"],[2,"width","140px",3,"pSortableColumn"],[2,"width","200px"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],[2,"width","150px",3,"pSortableColumn"],[2,"width","110px",3,"pSortableColumn"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"routerLink"],[1,"fa","fa-edit"],["class","badge badge-danger",4,"ngIf"],[1,"badge",3,"ngClass"],["height","20px",3,"src"],["placement","top","container","body",1,"single-line",3,"tooltip"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&n.Jc(0,T,33,18,"ng-container",0),2&t&&n.oc("ngIf",e.screenAcl.view)},directives:[c.m,r.e,c.l,b.a,u.m,u.o,l.c,d.b,c.k,l.b,l.a,m.a,u.t,u.p,u.v,u.b,r.g],styles:[""]}),E),k=i("w9rb"),R=i("TlXv"),P=i("IzNV"),M=i("fIZe"),O=i("ZOsW");function w(t,e){1&t&&(n.Tb(0),n.Lc(1,"Add"),n.Sb())}function J(t,e){1&t&&(n.Tb(0),n.Lc(1,"Edit"),n.Sb())}function _(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.activityNo," ")}}function x(t,e){if(1&t&&(n.Vb(0,"option",50),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.activityName)}}function B(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.activityTypeId," ")}}function Q(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){var i=e.item;n.Cb(1),n.Nc("",i.employeeName,"\xa0"),n.Cb(2),n.Nc("(",i.empCode,")")}}function q(t,e){if(1&t){var i=n.Wb();n.Vb(0,"span",51),n.dc("click",(function(){n.Dc(i);var t=n.hc();return t.popupExternalService.showDetailPopup("employee",t.myForm1Data.assignedToId)})),n.Qb(1,"i",52),n.Ub()}}function j(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.assignedToId," ")}}function z(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){var i=e.item;n.Cb(1),n.Nc("",i.partnerName,"\xa0"),n.Cb(2),n.Nc("(",i.partnerCode,")")}}function K(t,e){if(1&t){var i=n.Wb();n.Vb(0,"a",53),n.dc("click",(function(){return n.Dc(i),n.hc().bizRefreshFlag=!0})),n.Qb(1,"i",54),n.Ub()}}function G(t,e){if(1&t){var i=n.Wb();n.Vb(0,"a",55),n.dc("click",(function(){n.Dc(i);var t=n.hc();return t.getAutoSuggestionList("getBusinessPartnerList"),t.bizRefreshFlag=!1})),n.Qb(1,"i",56),n.Ub()}}function W(t,e){if(1&t){var i=n.Wb();n.Vb(0,"span",51),n.dc("click",(function(){n.Dc(i);var t=n.hc();return t.popupExternalService.showDetailPopup("biz-partner",t.myForm1Data.businessPartnerId)})),n.Qb(1,"i",52),n.Ub()}}function $(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.businessPartnerId," ")}}function Y(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Ub(),n.Vb(2,"small"),n.Lc(3),n.Ub()),2&t){var i=e.item;n.Cb(1),n.Mc(i.contactName),n.Cb(2),n.Oc("",i.contactTypeName," / ",i.contactNumber,"")}}function H(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.bpContactsId," ")}}function Z(t,e){1&t&&(n.Vb(0,"span",13),n.Lc(1,"*"),n.Ub())}function X(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.distributionRulesId," ")}}function tt(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.remarks," ")}}function et(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.startDateTime," ")}}function it(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.endDateTime," ")}}function rt(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.reminderBeforeTime," ")}}function ot(t,e){if(1&t&&(n.Vb(0,"option",50),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.name)}}function at(t,e){if(1&t&&(n.Vb(0,"option",50),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.name)}}function nt(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.priorityId," ")}}function st(t,e){if(1&t&&(n.Vb(0,"option",50),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.name)}}function ct(t,e){if(1&t&&(n.Vb(0,"div",49),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.status," ")}}function bt(t,e){if(1&t&&(n.Vb(0,"option",50),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.screenName)}}function ut(t,e){if(1&t){var i=n.Wb();n.Vb(0,"button",57),n.dc("click",(function(){return n.Dc(i),n.hc().saveUpdate()})),n.Qb(1,"i",58),n.Vb(2,"span"),n.Lc(3,"Save"),n.Ub(),n.Ub()}}function lt(t,e){if(1&t){var i=n.Wb();n.Vb(0,"button",3),n.dc("click",(function(){return n.Dc(i),n.hc().clearForm()})),n.Qb(1,"i",59),n.Vb(2,"span"),n.Lc(3,"Clear"),n.Ub(),n.Ub()}}function dt(t,e){if(1&t){var i=n.Wb();n.Vb(0,"button",57),n.dc("click",(function(){return n.Dc(i),n.hc().saveUpdate()})),n.Qb(1,"i",56),n.Vb(2,"span"),n.Lc(3,"Update"),n.Ub(),n.Ub()}}function mt(t,e){if(1&t){var i=n.Wb();n.Vb(0,"button",3),n.dc("click",(function(){return n.Dc(i),n.hc().utilsService.goBack()})),n.Qb(1,"i",60),n.Vb(2,"span"),n.Lc(3,"Cancel"),n.Ub(),n.Ub()}}function pt(t,e){1&t&&(n.Vb(0,"div",63),n.Vb(1,"span",64),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"update"),n.Ub(),n.Lc(6," this transaction! "),n.Ub())}function gt(t,e){1&t&&(n.Vb(0,"div",63),n.Vb(1,"span",64),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," Cannot update "),n.Vb(4,"strong"),n.Lc(5,"In-Active"),n.Ub(),n.Lc(6," / "),n.Vb(7,"strong"),n.Lc(8,"Closed"),n.Ub(),n.Lc(9," transactions! "),n.Ub())}function ht(t,e){if(1&t&&(n.Vb(0,"div",61),n.Vb(1,"div"),n.Vb(2,"strong"),n.Lc(3,"Created By:"),n.Ub(),n.Lc(4),n.Ub(),n.Jc(5,pt,7,0,"div",62),n.Jc(6,gt,10,0,"div",62),n.Ub()),2&t){var i=n.hc();n.Cb(4),n.Nc(" ",i.editCreatedName,""),n.Cb(1),n.oc("ngIf",!i.screenAcl.update),n.Cb(1),n.oc("ngIf","1"!==i.editStatusId)}}function ft(t,e){1&t&&(n.Vb(0,"div",61),n.Vb(1,"span",64),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"add"),n.Ub(),n.Lc(6," this transaction!. "),n.Ub())}var vt,yt=((vt=function(){function t(e,i,r,o,n,s,c,b,u){_classCallCheck(this,t),this.utilsService=e,this.storageService=i,this.authGuardService=r,this.branchUtilsService=o,this.commonDataService=n,this.activityDataService=s,this.activatedRoute=c,this.formBuilder=b,this.popupExternalService=u,this.appConstants=a.h,this.screenAcl={},this.bizRefreshFlag=!1,this.statusList=[],this.businessPartnerList=[],this.bpContactList=[],this.distributionList=[],this.activityTypeList=[],this.priorityList=[],this.recurrenceList=[],this.documentTypeList=[],this.reminderTypeList=[],this.employeeList=[],this.documentList=[],this.myForm1Data={},this.myFormErrors1={activityNo:"",activityTypeId:"",assignedToId:"",businessPartnerId:"",bpContactsId:"",distributionRulesId:"",remarks:"",startDateTime:"",endDateTime:"",reminderBeforeTime:"",priorityId:"",status:""},this.myFormValidationMsgs1={activityNo:{required:"Activity Number is required"},activityTypeId:{required:"Activity Type is required"},assignedToId:{required:"Assigned To is required"},businessPartnerId:{required:"Business Partner Name is required"},bpContactsId:{required:"Business Partner Contact is required"},distributionRulesId:{required:"Dist.Rules is required"},remarks:{required:"Remarks is required"},startDateTime:{required:"Start Date Time is required"},endDateTime:{required:"End Date Time is required"},reminderBeforeTime:{pattern:"Only positive numbers are allowed"},priorityId:{required:"Priority is required"},status:{required:"Status is required"}}}return _createClass(t,[{key:"ngOnInit",value:function(){if(this.screenAcl=this.authGuardService.getScreenAcl("4"),!this.screenAcl.view)return this.utilsService.showFailureMsg(a.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.initializeForm1(),this.initializeSubscriptions(),this.getAutoSuggestionList("getActivityStatusList"),this.getAutoSuggestionList("getActivityReminderTypeList"),this.getAutoSuggestionList("getMasterActivityList"),this.getAutoSuggestionList("getActivityPriorityTypeList"),this.getAutoSuggestionList("getActivityRecurrenceTypeList"),this.getAutoSuggestionList("getDocumentTypeList")}},{key:"ngAfterViewInit",value:function(){this.attachmentsComponent.loadAttachments(this.inputEditId),this.udfViewerComponent.getFields(this.inputEditId)}},{key:"initializeSubscriptions",value:function(){var t=this;this.activatedRoute.params.subscribe((function(e){e.id?(t.inputEditId=t.utilsService.decrypt(e.id),t.get()):(t.getAutoSuggestionList("getBusinessPartnerList"),t.getAutoSuggestionList("getEmployeeList"),t.getDistributionList()),e.bpId&&t.myForm1.patchValue({businessPartnerId:e.bpId})}))}},{key:"initializeForm1",value:function(){var t=this;this.myForm1=this.formBuilder.group({activityNo:[{value:"AUTO",disabled:!0},[u.u.required]],activityTypeId:["",[u.u.required]],assignedToId:[this.storageService.get("userId"),[u.u.required]],businessPartnerId:[null,[u.u.required]],bpContactsId:[null,[u.u.required]],distributionRulesId:[null],remarks:["",[u.u.required]],startDateTime:["",[u.u.required]],endDateTime:["",[u.u.required]],recurrenceTypeId:[""],recurrenceEndDate:[""],reminderBeforeTime:[0,[u.u.pattern(a.h.VALIDATION_PATTERNS.positiveIntNumber)]],reminderTypeId:[""],priorityId:[2,[u.u.required]],status:[1,[u.u.required]],documentTypeId:[""],documentId:[null]}),this.myForm1.valueChanges.subscribe((function(e){t.utilsService.validation(t.myForm1,t.myFormErrors1,t.myFormValidationMsgs1),t.myForm1Data=t.myForm1.getRawValue()})),this.myForm1Data=this.myForm1.getRawValue(),this.storageService.get("distRulesMode")&&this.myForm1.controls.distributionRulesId.setValidators(u.u.required)}},{key:"saveUpdate",value:function(){var t=this;if(!this.myForm1.valid||!this.udfViewerComponent.valid())return this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1,!0),this.udfViewerComponent.checkValidations(),!1;var e,i={activityNo:this.myForm1Data.activityNo,activityTypeId:this.myForm1Data.activityTypeId,assignedToId:this.myForm1Data.assignedToId,businessPartnerId:this.myForm1Data.businessPartnerId,bpContactsId:this.myForm1Data.bpContactsId,distributionRulesId:Array.isArray(this.myForm1Data.distributionRulesId)?this.myForm1Data.distributionRulesId.join(","):"",remarks:this.myForm1Data.remarks,startDateTime:this.utilsService.getBackendDateFormat(this.myForm1Data.startDateTime,!0),endDateTime:this.utilsService.getBackendDateFormat(this.myForm1Data.endDateTime,!0),recurrenceTypeId:this.myForm1Data.recurrenceTypeId,recurrenceEndDate:this.utilsService.getBackendDateFormat(this.myForm1Data.recurrenceEndDate),reminderBeforeTime:this.myForm1Data.reminderBeforeTime,reminderTypeId:this.myForm1Data.reminderTypeId,priorityId:this.myForm1Data.priorityId,status:this.myForm1Data.status,documentTypeId:this.myForm1Data.documentTypeId,documentId:this.myForm1Data.documentId,udfFields:JSON.stringify(this.udfViewerComponent.getFormValues())};this.inputEditId?(e="update",i.id=this.inputEditId):e="save",this.activityDataService[e](i).subscribe((function(i){"SUCCESS"===i.status?(t.utilsService.showSuccessMsg(i),t.attachmentsComponent.save("save"===e?i.sId:t.inputEditId)):t.utilsService.showFailureMsg(i)}))}},{key:"get",value:function(){var t=this;this.activityDataService.get(this.inputEditId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results[0],r={};t.utilsService.updateObject(r,"activityNo",i.activityNo),t.utilsService.updateObject(r,"activityTypeId",i.activityTypeId),t.utilsService.updateObject(r,"assignedToId",i.assignedToId),t.utilsService.updateObject(r,"businessPartnerId",i.businessPartnerId),t.utilsService.updateObject(r,"bpContactsId",i.bpContactsId),t.utilsService.isEmpty(i.distributionRulesId)||(r.distributionRulesId=t.branchUtilsService.distRulesRemoveZeroPatternOnEdit(i.distributionRulesId)),t.utilsService.updateObject(r,"remarks",i.remarks),t.utilsService.updateObject(r,"startDateTime",i.startDateTime,"date"),t.utilsService.updateObject(r,"endDateTime",i.endDateTime,"date"),t.utilsService.updateObject(r,"recurrenceTypeId",i.recurrenceTypeId),t.utilsService.updateObject(r,"recurrenceEndDate",i.recurrenceEndDate,"date"),t.utilsService.updateObject(r,"reminderBeforeTime",i.reminderBeforeTime),t.utilsService.updateObject(r,"reminderTypeId",i.reminderTypeId),t.utilsService.updateObject(r,"priorityId",i.priorityId),t.utilsService.updateObject(r,"status",i.status),t.utilsService.updateObject(r,"documentTypeId",i.documentTypeId),t.utilsService.updateObject(r,"documentId",i.documentId),t.myForm1.patchValue(r),t.getAutoSuggestionList("getBusinessPartnerList",i.businessPartnerInfo),t.getAutoSuggestionList("getEmployeeList",i.assignedToInfo),t.getDistributionList(i.distributionRulesInfo),t.getBpContactList(!0,i.bpContactsInfo),t.getDocumentList(!0,i.documentInfo),t.editStatusId=i.status,t.editCreatedName=i.createdByInfo[0].employeeName,"1"===t.editStatusId?t.myForm1.controls.businessPartnerId.disable():t.myForm1.enable()}else t.utilsService.showFailureMsg(e)}))}},{key:"clearForm",value:function(){this.initializeForm1()}},{key:"redirectToList",value:function(){this.utilsService.redirect("/branch/crm/activity-list")}},{key:"onStartTimeChange",value:function(){this.myForm1.patchValue({endDateTime:""})}},{key:"resetDocument",value:function(){this.myForm1.patchValue({documentTypeId:"",documentId:null})}},{key:"onDistRuleAdd",value:function(){this.branchUtilsService.distRulesCheckUnique(this.distributionList,this.myForm1,"distributionRulesId")}},{key:"getAutoSuggestionList",value:function(t,e){var i=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(r){"SUCCESS"===r.status?(i.utilsService.ifNotPushToList(r.results,e),"getActivityStatusList"===t?(i.inputEditId||(r.results=r.results.filter((function(t){return"1"===t.id}))),i.statusList=r.results):"getBusinessPartnerList"===t?i.businessPartnerList=r.results.map((function(t){return t.searchText=t.partnerName+" - "+t.partnerCode,t})):"getMasterActivityList"===t?i.activityTypeList=r.results:"getActivityPriorityTypeList"===t?i.priorityList=r.results:"getActivityRecurrenceTypeList"===t?i.recurrenceList=r.results:"getDocumentTypeList"===t?i.documentTypeList=r.results:"getActivityReminderTypeList"===t?i.reminderTypeList=r.results:"getEmployeeList"===t&&(i.employeeList=r.results.map((function(t){return t.searchText=t.employeeName+" - "+t.empCode,t})))):i.utilsService.showFailureMsg(r)}))}},{key:"getBpContactList",value:function(t,e){var i=this;this.bpContactList=[],this.branchUtilsService.getBpContactListAndSet(this.myForm1,"bpContactsId","businessPartnerId",t,e).subscribe((function(t){i.bpContactList=t}))}},{key:"getDocumentList",value:function(t,e){var i=this,r=this.myForm1Data.documentTypeId,o=this.myForm1Data.businessPartnerId;if(this.documentList=[],t||this.myForm1.patchValue({documentId:null}),!o)return this.utilsService.showFailureMsg("Select business partner to get the appropriate documents!"),this.myForm1.patchValue({documentTypeId:""}),!1;this.utilsService.isEmpty(r)||this.commonDataService.getDocumentList(r,o).subscribe((function(r){"SUCCESS"===r.status?(i.documentList=r.results,t&&i.utilsService.ifNotPushToList(i.documentList,e)):i.utilsService.showFailureMsg(r)}))}},{key:"getDistributionList",value:function(t){var e=this;this.commonDataService.getDistributionList(!0).subscribe((function(i){"SUCCESS"===i.status?(e.utilsService.ifNotPushToList(i.results,t),e.distributionList=i.results):e.utilsService.showFailureMsg(i)}))}},{key:"onKeydownHandler",value:function(t){t.ctrlKey&&"s"===t.key.toLowerCase()&&(this.inputEditId&&"1"===this.editStatusId||!this.inputEditId)&&(this.saveUpdate(),t.preventDefault())}}]),t}()).\u0275fac=function(t){return new(t||vt)(n.Pb(a.g),n.Pb(a.f),n.Pb(a.a),n.Pb(P.a),n.Pb(s.l),n.Pb(s.b),n.Pb(r.a),n.Pb(u.e),n.Pb(M.a))},vt.\u0275cmp=n.Jb({type:vt,selectors:[["app-activity-add"]],viewQuery:function(t,e){var i;1&t&&(n.Pc(k.a,!0),n.Pc(R.a,!0)),2&t&&(n.zc(i=n.ec())&&(e.attachmentsComponent=i.first),n.zc(i=n.ec())&&(e.udfViewerComponent=i.first))},hostBindings:function(t,e){1&t&&n.dc("keydown",(function(t){return e.onKeydownHandler(t)}),!1,n.Bc)},decls:156,vars:54,consts:[[1,"page-title"],[4,"ngIf"],[1,"btn-group"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-arrow-left"],[1,"working-container",3,"formGroup"],[1,"box"],[1,"box-header"],[1,"fa","fa-angle-right"],[1,"box-body","box-form"],[1,"row"],[1,"form-group","col-sm-3"],[1,"form-label"],[1,"mandatory"],["type","text","formControlName","activityNo",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],["formControlName","activityTypeId",1,"form-control","form-control-sm"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"position-relative"],["formControlName","assignedToId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["ng-option-tmp",""],["class","info-icon","container","body","tooltip","View Details",3,"click",4,"ngIf"],[1,"action-control"],["formControlName","businessPartnerId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple","clear","change"],["target","_blank","routerLink","/branch/bp/biz-partner-add",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["formControlName","bpContactsId","bindLabel","contactName","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["class","mandatory",4,"ngIf"],["formControlName","distributionRulesId","bindLabel","distributionName","bindValue","id","placeholder","--SELECT--","groupBy","dimensionDescription",3,"items","multiple","add"],["formControlName","remarks","rows","2",1,"form-control","form-control-sm"],["formControlName","startDateTime",3,"monthNavigator","yearNavigator","yearRange","dateFormat","showTime","onSelect"],["formControlName","endDateTime",3,"monthNavigator","yearNavigator","yearRange","dateFormat","showTime","minDate"],["endDateTime",""],[1,"small-text"],[1,"col-sm-6"],["type","text","formControlName","reminderBeforeTime",1,"form-control","form-control-sm"],["formControlName","reminderTypeId",1,"form-control","form-control-sm"],["formControlName","priorityId",1,"form-control","form-control-sm"],["formControlName","status",1,"form-control","form-control-sm"],["formControlName","documentTypeId",1,"form-control","form-control-sm",3,"change"],["formControlName","documentId","bindLabel","documentNumber","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],[3,"type"],[3,"type","doSuccess"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class"," btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],[1,"validation-error"],[3,"value"],["container","body","tooltip","View Details",1,"info-icon",3,"click"],[1,"fa","fa-info-circle"],["target","_blank","routerLink","/branch/bp/biz-partner-add",3,"click"],[1,"fa","fa-plus"],[3,"click"],[1,"fa","fa-redo-alt"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"fa","fa-broom"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],["class","mt-2",4,"ngIf"],[1,"mt-2"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(n.Vb(0,"div",0),n.Vb(1,"span"),n.Lc(2,"A"),n.Ub(),n.Lc(3,"ctivity - "),n.Jc(4,w,2,0,"ng-container",1),n.Jc(5,J,2,0,"ng-container",1),n.Vb(6,"div",2),n.Vb(7,"button",3),n.dc("click",(function(){return e.utilsService.goBack()})),n.Qb(8,"i",4),n.Vb(9,"span"),n.Lc(10,"Back"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(11,"div",5),n.Vb(12,"div",6),n.Vb(13,"div",7),n.Qb(14,"i",8),n.Lc(15,"Activity Info "),n.Ub(),n.Vb(16,"div",9),n.Vb(17,"div",10),n.Vb(18,"div",11),n.Vb(19,"label",12),n.Lc(20,"Activity Number"),n.Vb(21,"span",13),n.Lc(22,"*"),n.Ub(),n.Ub(),n.Qb(23,"input",14),n.Jc(24,_,2,1,"div",15),n.Ub(),n.Vb(25,"div",11),n.Vb(26,"label",12),n.Lc(27,"Activity Type"),n.Vb(28,"span",13),n.Lc(29,"*"),n.Ub(),n.Ub(),n.Vb(30,"select",16),n.Vb(31,"option",17),n.Lc(32,"--SELECT--"),n.Ub(),n.Jc(33,x,2,2,"option",18),n.Ub(),n.Jc(34,B,2,1,"div",15),n.Ub(),n.Vb(35,"div",11),n.Vb(36,"label",12),n.Lc(37,"Assigned To"),n.Vb(38,"span",13),n.Lc(39,"*"),n.Ub(),n.Ub(),n.Vb(40,"div",19),n.Vb(41,"ng-select",20),n.Jc(42,Q,4,2,"ng-template",21),n.Ub(),n.Jc(43,q,2,0,"span",22),n.Ub(),n.Jc(44,j,2,1,"div",15),n.Ub(),n.Vb(45,"div",11),n.Vb(46,"label",12),n.Lc(47,"Business Partner Name"),n.Vb(48,"span",13),n.Lc(49,"*"),n.Ub(),n.Ub(),n.Vb(50,"div",23),n.Vb(51,"ng-select",24),n.dc("clear",(function(){return e.getBpContactList()}))("change",(function(){return e.getBpContactList(),e.resetDocument()})),n.Jc(52,z,4,2,"ng-template",21),n.Ub(),n.Vb(53,"span"),n.Jc(54,K,2,0,"a",25),n.Jc(55,G,2,0,"a",26),n.Ub(),n.Jc(56,W,2,0,"span",22),n.Ub(),n.Jc(57,$,2,1,"div",15),n.Ub(),n.Vb(58,"div",11),n.Vb(59,"label",12),n.Lc(60,"Business Partner Contact"),n.Vb(61,"span",13),n.Lc(62,"*"),n.Ub(),n.Ub(),n.Vb(63,"ng-select",27),n.Jc(64,Y,4,3,"ng-template",21),n.Ub(),n.Jc(65,H,2,1,"div",15),n.Ub(),n.Vb(66,"div",11),n.Vb(67,"label",12),n.Lc(68,"Distribution Rules"),n.Jc(69,Z,2,0,"span",28),n.Ub(),n.Vb(70,"ng-select",29),n.dc("add",(function(){return e.onDistRuleAdd()})),n.Ub(),n.Jc(71,X,2,1,"div",15),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(72,"div",6),n.Vb(73,"div",7),n.Qb(74,"i",8),n.Lc(75,"General "),n.Ub(),n.Vb(76,"div",9),n.Vb(77,"div",10),n.Vb(78,"div",11),n.Vb(79,"label",12),n.Lc(80,"Remarks"),n.Vb(81,"span",13),n.Lc(82,"*"),n.Ub(),n.Ub(),n.Qb(83,"textarea",30),n.Jc(84,tt,2,1,"div",15),n.Ub(),n.Vb(85,"div",11),n.Vb(86,"label",12),n.Lc(87,"Start Time"),n.Vb(88,"span",13),n.Lc(89,"*"),n.Ub(),n.Ub(),n.Vb(90,"p-calendar",31),n.dc("onSelect",(function(){return e.onStartTimeChange()})),n.Ub(),n.Jc(91,et,2,1,"div",15),n.Ub(),n.Vb(92,"div",11),n.Vb(93,"label",12),n.Lc(94,"End Time"),n.Vb(95,"span",13),n.Lc(96,"*"),n.Ub(),n.Ub(),n.Qb(97,"p-calendar",32,33),n.Jc(99,it,2,1,"div",15),n.Ub(),n.Vb(100,"div",11),n.Vb(101,"label",12),n.Lc(102,"Reminder "),n.Vb(103,"span",34),n.Lc(104,"(Before)"),n.Ub(),n.Ub(),n.Vb(105,"div",10),n.Vb(106,"div",35),n.Qb(107,"input",36),n.Jc(108,rt,2,1,"div",15),n.Ub(),n.Vb(109,"div",35),n.Vb(110,"select",37),n.Jc(111,ot,2,2,"option",18),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(112,"div",11),n.Vb(113,"label",12),n.Lc(114,"Priority"),n.Vb(115,"span",13),n.Lc(116,"*"),n.Ub(),n.Ub(),n.Vb(117,"select",38),n.Vb(118,"option",17),n.Lc(119,"--SELECT--"),n.Ub(),n.Jc(120,at,2,2,"option",18),n.Ub(),n.Jc(121,nt,2,1,"div",15),n.Ub(),n.Vb(122,"div",11),n.Vb(123,"label",12),n.Lc(124,"Status"),n.Vb(125,"span",13),n.Lc(126,"*"),n.Ub(),n.Ub(),n.Vb(127,"select",39),n.Jc(128,st,2,2,"option",18),n.Ub(),n.Jc(129,ct,2,1,"div",15),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(130,"div",6),n.Vb(131,"div",7),n.Qb(132,"i",8),n.Lc(133,"Linked Document "),n.Ub(),n.Vb(134,"div",9),n.Vb(135,"div",10),n.Vb(136,"div",11),n.Vb(137,"label",12),n.Lc(138,"Document Type"),n.Ub(),n.Vb(139,"select",40),n.dc("change",(function(){return e.getDocumentList()})),n.Vb(140,"option",17),n.Lc(141,"--SELECT--"),n.Ub(),n.Jc(142,bt,2,2,"option",18),n.Ub(),n.Ub(),n.Vb(143,"div",11),n.Vb(144,"label",12),n.Lc(145,"Document Number"),n.Ub(),n.Qb(146,"ng-select",41),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Qb(147,"app-udf-viewer",42),n.Vb(148,"app-attachments",43),n.dc("doSuccess",(function(){return e.redirectToList()})),n.Ub(),n.Vb(149,"div",44),n.Jc(150,ut,4,0,"button",45),n.Jc(151,lt,4,0,"button",46),n.Jc(152,dt,4,0,"button",47),n.Jc(153,mt,4,0,"button",46),n.Ub(),n.Jc(154,ht,7,3,"div",48),n.Jc(155,ft,7,0,"div",48),n.Ub()),2&t&&(n.Cb(4),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(6),n.oc("formGroup",e.myForm1),n.Cb(13),n.oc("ngIf",e.myFormErrors1.activityNo),n.Cb(9),n.oc("ngForOf",e.activityTypeList),n.Cb(1),n.oc("ngIf",e.myFormErrors1.activityTypeId),n.Cb(7),n.oc("items",e.employeeList)("multiple",!1),n.Cb(2),n.oc("ngIf",e.myForm1Data.assignedToId),n.Cb(1),n.oc("ngIf",e.myFormErrors1.assignedToId),n.Cb(7),n.oc("items",e.businessPartnerList)("multiple",!1),n.Cb(3),n.oc("ngIf",!e.bizRefreshFlag),n.Cb(1),n.oc("ngIf",e.bizRefreshFlag),n.Cb(1),n.oc("ngIf",e.myForm1Data.businessPartnerId),n.Cb(1),n.oc("ngIf",e.myFormErrors1.businessPartnerId),n.Cb(6),n.oc("items",e.bpContactList)("multiple",!1),n.Cb(2),n.oc("ngIf",e.myFormErrors1.bpContactsId),n.Cb(4),n.oc("ngIf",e.storageService.get("distRulesMode")),n.Cb(1),n.oc("items",e.distributionList)("multiple",!0),n.Cb(1),n.oc("ngIf",e.myFormErrors1.distributionRulesId),n.Cb(13),n.oc("ngIf",e.myFormErrors1.remarks),n.Cb(6),n.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",e.appConstants.PICKER_YEAR_RANGE)("dateFormat",e.appConstants.PICKER_DATE_FORMAT)("showTime",!0),n.Cb(1),n.oc("ngIf",e.myFormErrors1.startDateTime),n.Cb(6),n.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",e.appConstants.PICKER_YEAR_RANGE)("dateFormat",e.appConstants.PICKER_DATE_FORMAT)("showTime",!0)("minDate",e.myForm1Data.startDateTime),n.Cb(2),n.oc("ngIf",e.myFormErrors1.endDateTime),n.Cb(9),n.oc("ngIf",e.myFormErrors1.reminderBeforeTime),n.Cb(3),n.oc("ngForOf",e.reminderTypeList),n.Cb(9),n.oc("ngForOf",e.priorityList),n.Cb(1),n.oc("ngIf",e.myFormErrors1.priorityId),n.Cb(7),n.oc("ngForOf",e.statusList),n.Cb(1),n.oc("ngIf",e.myFormErrors1.status),n.Cb(13),n.oc("ngForOf",e.documentTypeList),n.Cb(4),n.oc("items",e.documentList)("multiple",!1),n.Cb(1),n.oc("type",e.branchUtilsService.screenAttributes.activity.backendKey),n.Cb(1),n.oc("type",e.branchUtilsService.screenAttributes.activity.backendKey),n.Cb(2),n.oc("ngIf",e.screenAcl.add&&!e.inputEditId),n.Cb(1),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.screenAcl.update&&e.inputEditId&&"1"===e.editStatusId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(1),n.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[c.m,u.n,u.i,u.b,u.m,u.g,u.t,u.p,u.v,c.l,O.a,O.c,b.a,R.a,k.a,m.a,r.g],styles:[""]}),vt),Ct=["dataTable"];function Lt(t,e){if(1&t){var i=n.Wb();n.Vb(0,"button",20),n.dc("click",(function(){return n.Dc(i),n.hc(2).downloadAsExcel()})),n.Qb(1,"i",21),n.Vb(2,"span"),n.Lc(3,"Download as Excel"),n.Ub(),n.Ub()}}function St(t,e){if(1&t&&(n.Vb(0,"div",22),n.Vb(1,"div",23),n.Vb(2,"div",24),n.Lc(3),n.Ub(),n.Vb(4,"div",25),n.Lc(5),n.Ub(),n.Ub(),n.Ub()),2&t){var i=e.$implicit,r=n.hc(2);n.Cb(3),n.Nc(" ",i.name," "),n.Cb(1),n.oc("ngClass",r.appConstants.OPPORTUNITY_STATUS_COLOR_CLS[i.id]),n.Cb(1),n.Mc(i.count)}}function It(t,e){1&t&&(n.Vb(0,"th",45),n.Lc(1," Branch Name"),n.Qb(2,"p-sortIcon",30),n.Ub()),2&t&&(n.oc("pSortableColumn","branchName"),n.Cb(2),n.oc("field","branchName"))}function Ut(t,e){1&t&&(n.Vb(0,"th",46),n.Lc(1,"Sap Doc No"),n.Qb(2,"p-sortIcon",30),n.Ub()),2&t&&(n.oc("pSortableColumn","sapId"),n.Cb(2),n.oc("field","sapId"))}function Vt(t,e){if(1&t){var i=n.Wb();n.Vb(0,"th"),n.Vb(1,"input",47),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(3).searchForm.branchName=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(3).resetListing()})),n.Ub(),n.Ub()}if(2&t){var r=n.hc(3);n.Cb(1),n.oc("ngModel",r.searchForm.branchName)}}function Dt(t,e){if(1&t){var i=n.Wb();n.Vb(0,"th"),n.Vb(1,"input",40),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(3).searchForm.sapId=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(3).resetListing()})),n.Ub(),n.Ub()}if(2&t){var r=n.hc(3);n.Cb(1),n.oc("ngModel",r.searchForm.sapId)}}function Ft(t,e){if(1&t&&(n.Vb(0,"option",48),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Nc(" ",i.name," ")}}function Nt(t,e){if(1&t){var i=n.Wb();n.Vb(0,"tr"),n.Vb(1,"th",26),n.Lc(2,"Actions"),n.Ub(),n.Jc(3,It,3,2,"th",27),n.Jc(4,Ut,3,2,"th",28),n.Vb(5,"th",29),n.Lc(6,"Opportunity No"),n.Qb(7,"p-sortIcon",30),n.Ub(),n.Vb(8,"th",31),n.Lc(9,"Opportunity Name"),n.Qb(10,"p-sortIcon",30),n.Ub(),n.Vb(11,"th",32),n.Lc(12,"Business Partner Name"),n.Qb(13,"p-sortIcon",30),n.Ub(),n.Vb(14,"th",32),n.Lc(15,"Sales Employee"),n.Qb(16,"p-sortIcon",30),n.Ub(),n.Vb(17,"th",33),n.Lc(18,"Current Stage"),n.Ub(),n.Vb(19,"th",34),n.Lc(20,"Status"),n.Qb(21,"p-sortIcon",30),n.Ub(),n.Vb(22,"th",35),n.Lc(23,"Start Date"),n.Qb(24,"p-sortIcon",30),n.Ub(),n.Vb(25,"th",34),n.Lc(26,"Closing Date"),n.Qb(27,"p-sortIcon",30),n.Ub(),n.Vb(28,"th",31),n.Lc(29,"Potential Amount"),n.Qb(30,"p-sortIcon",30),n.Ub(),n.Vb(31,"th",36),n.Lc(32,"Distribution Rules"),n.Ub(),n.Ub(),n.Vb(33,"tr",37),n.Vb(34,"th"),n.Vb(35,"a",38),n.dc("click",(function(){return n.Dc(i),n.hc(2).clearSearchForm()})),n.Qb(36,"i",39),n.Lc(37,"Clear"),n.Ub(),n.Ub(),n.Jc(38,Vt,2,1,"th",0),n.Jc(39,Dt,2,1,"th",0),n.Vb(40,"th"),n.Vb(41,"input",40),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.opportunityNo=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(42,"th"),n.Vb(43,"input",40),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.opportunityName=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(44,"th"),n.Vb(45,"input",40),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.partnerName=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(46,"th"),n.Vb(47,"input",40),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.empName=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Qb(48,"th"),n.Vb(49,"th"),n.Vb(50,"select",41),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.opportunityStatus=t}))("change",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Vb(51,"option",42),n.Lc(52,"--SELECT--"),n.Ub(),n.Jc(53,Ft,2,2,"option",43),n.Ub(),n.Ub(),n.Vb(54,"th"),n.Vb(55,"p-calendar",12),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.startDate=t}))("onSelect",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(56,"th"),n.Vb(57,"p-calendar",12),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.closingDate=t}))("onSelect",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Vb(58,"th"),n.Vb(59,"input",44),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc(2).searchForm.potentialAmount=t}))("keyup.enter",(function(){return n.Dc(i),n.hc(2).resetListing()})),n.Ub(),n.Ub(),n.Qb(60,"th"),n.Ub()}if(2&t){var r=n.hc(2);n.Cb(3),n.oc("ngIf",!r.storageService.get("isSingleBranchUser")),n.Cb(1),n.oc("ngIf",r.storageService.get("isSap")),n.Cb(1),n.oc("pSortableColumn","opportunityNo"),n.Cb(2),n.oc("field","opportunityNo"),n.Cb(1),n.oc("pSortableColumn","opportunityName"),n.Cb(2),n.oc("field","opportunityName"),n.Cb(1),n.oc("pSortableColumn","partnerName"),n.Cb(2),n.oc("field","partnerName"),n.Cb(1),n.oc("pSortableColumn","empName"),n.Cb(2),n.oc("field","empName"),n.Cb(3),n.oc("pSortableColumn","opportunityStatus"),n.Cb(2),n.oc("field","opportunityStatus"),n.Cb(1),n.oc("pSortableColumn","startDate"),n.Cb(2),n.oc("field","startDate"),n.Cb(1),n.oc("pSortableColumn","closingDate"),n.Cb(2),n.oc("field","closingDate"),n.Cb(1),n.oc("pSortableColumn","potentialAmount"),n.Cb(2),n.oc("field","potentialAmount"),n.Cb(8),n.oc("ngIf",!r.storageService.get("isSingleBranchUser")),n.Cb(1),n.oc("ngIf",r.storageService.get("isSap")),n.Cb(2),n.oc("ngModel",r.searchForm.opportunityNo),n.Cb(2),n.oc("ngModel",r.searchForm.opportunityName),n.Cb(2),n.oc("ngModel",r.searchForm.partnerName),n.Cb(2),n.oc("ngModel",r.searchForm.empName),n.Cb(3),n.oc("ngModel",r.searchForm.opportunityStatus),n.Cb(3),n.oc("ngForOf",r.statusList),n.Cb(2),n.oc("ngModel",r.searchForm.startDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),n.Cb(2),n.oc("ngModel",r.searchForm.closingDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),n.Cb(2),n.oc("ngModel",r.searchForm.potentialAmount)}}function Tt(t,e){if(1&t&&(n.Vb(0,"td"),n.Lc(1),n.Ub()),2&t){var i=n.hc().$implicit;n.Cb(1),n.Mc(i.branchName)}}function Et(t,e){if(1&t&&(n.Vb(0,"td"),n.Lc(1),n.Ub()),2&t){var i=n.hc().$implicit;n.Cb(1),n.Mc(i.sapId)}}function At(t,e){if(1&t&&(n.Vb(0,"tr"),n.Vb(1,"td"),n.Vb(2,"a",49),n.Qb(3,"i",50),n.Ub(),n.Ub(),n.Jc(4,Tt,2,1,"td",0),n.Jc(5,Et,2,1,"td",0),n.Vb(6,"td"),n.Lc(7),n.Ub(),n.Vb(8,"td"),n.Lc(9),n.Ub(),n.Vb(10,"td"),n.Lc(11),n.Ub(),n.Vb(12,"td"),n.Qb(13,"img",51),n.Lc(14),n.Ub(),n.Vb(15,"td"),n.Lc(16),n.Ub(),n.Vb(17,"td"),n.Vb(18,"span",52),n.Lc(19),n.Ub(),n.Ub(),n.Vb(20,"td"),n.Lc(21),n.Ub(),n.Vb(22,"td"),n.Lc(23),n.Ub(),n.Vb(24,"td"),n.Lc(25),n.Ub(),n.Vb(26,"td"),n.Vb(27,"div",53),n.Lc(28),n.Ub(),n.Ub(),n.Ub()),2&t){var i=e.$implicit,r=n.hc(2);n.Cb(2),n.qc("routerLink","/branch/crm/oppurtunity-edit/",r.utilsService.encrypt(i.id),""),n.Cb(2),n.oc("ngIf",!r.storageService.get("isSingleBranchUser")),n.Cb(1),n.oc("ngIf",r.storageService.get("isSap")),n.Cb(2),n.Mc(i.opportunityNo),n.Cb(2),n.Mc(i.opportunityName),n.Cb(2),n.Oc("",i.partnerCode," - ",i.partnerName,""),n.Cb(2),n.oc("src",i.empImgUrl?i.empImgUrl:r.appConstants.DEFAULT_USER_ICON,n.Fc),n.Cb(1),n.Oc("\xa0",i.empCode," - ",i.empName,""),n.Cb(2),n.Nc(" ",i.stageDetails.length>0&&i.stageDetails[i.stageDetails.length-1]&&i.stageDetails[i.stageDetails.length-1].stageInfo&&i.stageDetails[i.stageDetails.length-1].stageInfo.length>0?i.stageDetails[i.stageDetails.length-1].stageInfo[0].stageName:""," "),n.Cb(2),n.oc("ngClass",r.appConstants.OPPORTUNITY_STATUS_COLOR_CLS[i.opportunityStatus]),n.Cb(1),n.Mc(i.statusName),n.Cb(2),n.Mc(i.startDate),n.Cb(2),n.Mc("0000-00-00"!==i.closingDate?i.closingDate:""),n.Cb(2),n.Mc(i.potentialAmount),n.Cb(2),n.oc("tooltip",i.distributionRulesValues),n.Cb(1),n.Nc(" ",i.distributionRulesValues,"")}}function kt(t,e){if(1&t){var i=n.Wb();n.Tb(0),n.Vb(1,"div",1),n.Vb(2,"span"),n.Lc(3,"S"),n.Ub(),n.Lc(4,"ales Opportunities - List "),n.Vb(5,"div",2),n.Jc(6,Lt,4,0,"button",3),n.Vb(7,"button",4),n.Qb(8,"i",5),n.Vb(9,"span"),n.Lc(10,"Add Oppurtunity"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(11,"div",6),n.Vb(12,"div",7),n.Vb(13,"div",8),n.Jc(14,St,6,3,"div",9),n.Ub(),n.Ub(),n.Vb(15,"div",8),n.Vb(16,"div",10),n.Vb(17,"label",11),n.Vb(18,"strong"),n.Lc(19,"From Date"),n.Ub(),n.Ub(),n.Vb(20,"p-calendar",12),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc().searchForm.fromDate=t}))("onSelect",(function(){return n.Dc(i),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Vb(21,"div",10),n.Vb(22,"label",11),n.Vb(23,"strong"),n.Lc(24,"To Date"),n.Ub(),n.Ub(),n.Vb(25,"p-calendar",13),n.dc("ngModelChange",(function(t){return n.Dc(i),n.hc().searchForm.toDate=t}))("onSelect",(function(){return n.Dc(i),n.hc().resetListing()})),n.Ub(),n.Ub(),n.Ub(),n.Vb(26,"div",8),n.Vb(27,"div",14),n.Vb(28,"div",15),n.Vb(29,"p-table",16,17),n.dc("onLazyLoad",(function(t){return n.Dc(i),n.hc().getListing(t)})),n.Jc(31,Nt,61,37,"ng-template",18),n.Jc(32,At,29,18,"ng-template",19),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Sb()}if(2&t){var r=n.hc();n.Cb(6),n.oc("ngIf",r.screenAcl.download),n.Cb(8),n.oc("ngForOf",r.analyticsData),n.Cb(6),n.oc("ngModel",r.searchForm.fromDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),n.Cb(5),n.oc("ngModel",r.searchForm.toDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT)("minDate",r.searchForm.fromDate),n.Cb(4),n.oc("value",r.listing.data)("lazy",!0)("paginator",!0)("rows",r.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",r.listing.totalRecords)}}var Rt,Pt=((Rt=function(){function t(e,i,r,o,n){_classCallCheck(this,t),this.utilsService=e,this.storageService=i,this.authGuardService=r,this.commonDataService=o,this.oppurtunityDataService=n,this.appConstants=a.h,this.screenAcl={},this.analyticsData=[],this.statusList=[],this.listingProperties={},this.listing={data:[],totalRecords:0},this.searchForm={sapId:"",opportunityNo:"",opportunityName:"",partnerName:"",empName:"",opportunityStatus:"1",startDate:"",closingDate:"",potentialAmount:"",fromDate:"",toDate:"",branchName:""}}return _createClass(t,[{key:"ngOnInit",value:function(){if(this.screenAcl=this.authGuardService.getScreenAcl("1"),!this.screenAcl.view)return this.utilsService.showFailureMsg(a.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.getAutoSuggestionList("getOpportunityStatusList"),this.getAnalyticsData()}},{key:"getListing",value:function(t){var e=this,i=Object.assign({},this.searchForm);i.fromDate=this.utilsService.getBackendDateFormat(this.searchForm.fromDate),i.toDate=this.utilsService.getBackendDateFormat(this.searchForm.toDate),i.startDate=this.utilsService.getBackendDateFormat(this.searchForm.startDate),i.closingDate=this.utilsService.getBackendDateFormat(this.searchForm.closingDate);var r=this.utilsService.dataTableParameterFormation(t,i);this.listingProperties=r,this.oppurtunityDataService.getList(r).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"clearSearchForm",value:function(){this.searchForm={sapId:"",opportunityNo:"",opportunityName:"",partnerName:"",empName:"",opportunityStatus:"1",startDate:"",closingDate:"",potentialAmount:"",fromDate:"",toDate:"",branchName:""},this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"getAutoSuggestionList",value:function(t){var e=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(i){"SUCCESS"===i.status?"getOpportunityStatusList"===t&&(e.statusList=i.results):e.utilsService.showFailureMsg(i)}))}},{key:"getAnalyticsData",value:function(){var t=this;this.oppurtunityDataService.getAnalyticsData().subscribe((function(e){"SUCCESS"===e.status?(t.analyticsData=e.results,t.analyticsData=o.orderBy(t.analyticsData,["id"],["asc"])):t.utilsService.showFailureMsg(e)}))}},{key:"downloadAsExcel",value:function(){var t=this;this.oppurtunityDataService.downloadAsExcel(this.listingProperties).subscribe((function(e){"SUCCESS"===e.status?t.utilsService.externalRedirect(e.fileUrl):t.utilsService.showFailureMsg(e)}))}}]),t}()).\u0275fac=function(t){return new(t||Rt)(n.Pb(a.g),n.Pb(a.f),n.Pb(a.a),n.Pb(s.l),n.Pb(s.H))},Rt.\u0275cmp=n.Jb({type:Rt,selectors:[["app-oppurtunity-list"]],viewQuery:function(t,e){var i;1&t&&n.Pc(Ct,!0),2&t&&n.zc(i=n.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],["class","btn btn-success btn-sm",3,"click",4,"ngIf"],["routerLink","/branch/crm/oppurtunity-add",1,"btn","btn-primary","btn-sm"],[1,"fa","fa-plus"],[1,"working-container"],[1,"analytics"],[1,"row"],["class","col-lg-2 col-md-3 col-sm-4 col-xs-12",4,"ngFor","ngForOf"],[1,"form-group","col-sm-3"],[1,"form-label"],["appendTo","body",3,"ngModel","monthNavigator","yearNavigator","yearRange","dateFormat","ngModelChange","onSelect"],["appendTo","body",3,"ngModel","monthNavigator","yearNavigator","yearRange","dateFormat","minDate","ngModelChange","onSelect"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa","fa-file-excel"],[1,"col-lg-2","col-md-3","col-sm-4","col-xs-12"],[1,"item"],[1,"name"],[1,"count",3,"ngClass"],[2,"width","100px"],["style","width:150px",3,"pSortableColumn",4,"ngIf"],["style","width:110px",3,"pSortableColumn",4,"ngIf"],[2,"width","140px",3,"pSortableColumn"],[3,"field"],[2,"width","200px",3,"pSortableColumn"],[2,"width","250px",3,"pSortableColumn"],[2,"width","130px"],[2,"width","120px",3,"pSortableColumn"],[2,"width","100px",3,"pSortableColumn"],[2,"width","200px"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","number",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[2,"width","150px",3,"pSortableColumn"],[2,"width","110px",3,"pSortableColumn"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"routerLink"],[1,"fa","fa-edit"],["height","20px",3,"src"],[1,"badge",3,"ngClass"],["placement","top","container","body",1,"single-line",3,"tooltip"]],template:function(t,e){1&t&&n.Jc(0,kt,33,18,"ng-container",0),2&t&&n.oc("ngIf",e.screenAcl.view)},directives:[c.m,r.e,c.l,b.a,u.m,u.o,l.c,d.b,c.k,l.b,l.a,m.a,u.b,u.t,u.p,u.v,u.q,r.g],styles:[""]}),Rt);function Mt(t,e){1&t&&(n.Tb(0),n.Lc(1,"Add"),n.Sb())}function Ot(t,e){1&t&&(n.Tb(0),n.Lc(1,"Edit"),n.Sb())}function wt(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.opportunityNo," ")}}function Jt(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.opportunityName," ")}}function _t(t,e){if(1&t&&(n.Vb(0,"option",62),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.typeDescription)}}function xt(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.opportunityTypeId," ")}}function Bt(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){var i=e.item;n.Cb(1),n.Nc("",i.partnerName,"\xa0"),n.Cb(2),n.Nc("(",i.partnerCode,")")}}function Qt(t,e){if(1&t){var i=n.Wb();n.Vb(0,"a",63),n.dc("click",(function(){return n.Dc(i),n.hc().bizRefreshFlag=!0})),n.Qb(1,"i",22),n.Ub()}}function qt(t,e){if(1&t){var i=n.Wb();n.Vb(0,"a",21),n.dc("click",(function(){n.Dc(i);var t=n.hc();return t.getBpList(),t.bizRefreshFlag=!1})),n.Qb(1,"i",64),n.Ub()}}function jt(t,e){if(1&t){var i=n.Wb();n.Vb(0,"span",65),n.dc("click",(function(){n.Dc(i);var t=n.hc();return t.popupExternalService.showDetailPopup("biz-partner",t.myForm1Data.businessPartnerId)})),n.Qb(1,"i",66),n.Ub()}}function zt(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.businessPartnerId," ")}}function Kt(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Ub(),n.Vb(2,"small"),n.Lc(3),n.Ub()),2&t){var i=e.item;n.Cb(1),n.Mc(i.contactName),n.Cb(2),n.Oc("",i.contactTypeName," / ",i.contactNumber,"")}}function Gt(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.bpContactsId," ")}}function Wt(t,e){1&t&&(n.Vb(0,"span",13),n.Lc(1,"*"),n.Ub())}function $t(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.distributionRulesId," ")}}function Yt(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){var i=e.item;n.Cb(1),n.Nc("",i.employeeName,"\xa0"),n.Cb(2),n.Nc("(",i.empCode,")")}}function Ht(t,e){if(1&t){var i=n.Wb();n.Vb(0,"span",65),n.dc("click",(function(){n.Dc(i);var t=n.hc();return t.popupExternalService.showDetailPopup("employee",t.myForm1Data.empId)})),n.Qb(1,"i",66),n.Ub()}}function Zt(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.startDate," ")}}function Xt(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.potentialAmount," ")}}function te(t,e){if(1&t&&(n.Vb(0,"option",62),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.interestName)}}function ee(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.levelOfInterestId," ")}}function ie(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.industryId," ")}}function re(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.informationSourceId," ")}}function oe(t,e){if(1&t){var i=n.Wb();n.Vb(0,"a",76),n.dc("click",(function(){n.Dc(i);var t=n.hc().index;return n.hc().removeStageFields(t)})),n.Qb(1,"i",77),n.Ub()}}function ae(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc().index,r=n.hc();n.Cb(1),n.Nc(" ",r.myFormErrors1.stageListArray[i].startDate," ")}}function ne(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc().index,r=n.hc();n.Cb(1),n.Nc(" ",r.myFormErrors1.stageListArray[i].closingDate," ")}}function se(t,e){if(1&t&&(n.Vb(0,"div"),n.Lc(1),n.Vb(2,"small"),n.Lc(3),n.Ub(),n.Ub()),2&t){var i=e.item;n.Cb(1),n.Nc("",i.employeeName,"\xa0"),n.Cb(2),n.Nc("(",i.empCode,")")}}function ce(t,e){if(1&t){var i=n.Wb();n.Vb(0,"span",65),n.dc("click",(function(){n.Dc(i);var t=n.hc().index,e=n.hc();return e.popupExternalService.showDetailPopup("employee",e.myForm1Data.stageListArray[t].empId)})),n.Qb(1,"i",66),n.Ub()}}function be(t,e){if(1&t&&(n.Vb(0,"option",62),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Oc("",i.stageNumber," - ",i.stageName," ")}}function ue(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc().index,r=n.hc();n.Cb(1),n.Nc(" ",r.myFormErrors1.stageListArray[i].stageId," ")}}function le(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc().index,r=n.hc();n.Cb(1),n.Nc(" ",r.myFormErrors1.stageListArray[i].stagePercentage," ")}}function de(t,e){if(1&t&&(n.Vb(0,"option",62),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.screenName)}}function me(t,e){if(1&t){var i=n.Wb();n.Vb(0,"a",21),n.dc("click",(function(){n.Dc(i);var t=n.hc().index;return n.hc().navigateToDocument(t)})),n.Qb(1,"i",22),n.Ub()}}function pe(t,e){if(1&t){var i=n.Wb();n.Vb(0,"tr",67),n.Vb(1,"td"),n.Jc(2,oe,2,0,"a",68),n.Ub(),n.Vb(3,"td"),n.Vb(4,"p-calendar",69),n.dc("onSelect",(function(){n.Dc(i);var t=e.index;return n.hc().onStageStartDateChange(t)})),n.Ub(),n.Jc(5,ae,2,1,"div",15),n.Ub(),n.Vb(6,"td"),n.Qb(7,"p-calendar",70),n.Jc(8,ne,2,1,"div",15),n.Ub(),n.Vb(9,"td"),n.Vb(10,"div",31),n.Vb(11,"ng-select",71),n.Jc(12,se,4,2,"ng-template",24),n.Ub(),n.Jc(13,ce,2,0,"span",27),n.Ub(),n.Ub(),n.Vb(14,"td"),n.Vb(15,"select",72),n.dc("change",(function(t){n.Dc(i);var r=e.index;return n.hc().setStagePercentage(r,t.target.value)})),n.Vb(16,"option",19),n.Lc(17,"--SELECT--"),n.Ub(),n.Jc(18,be,2,3,"option",20),n.Ub(),n.Jc(19,ue,2,1,"div",15),n.Ub(),n.Vb(20,"td"),n.Lc(21),n.Jc(22,le,2,1,"div",15),n.Ub(),n.Vb(23,"td"),n.Vb(24,"div",17),n.Qb(25,"ng-select",73),n.Ub(),n.Ub(),n.Vb(26,"td"),n.Vb(27,"select",74),n.dc("change",(function(){n.Dc(i);var t=e.index;return n.hc().getDocumentList(t)})),n.Vb(28,"option",19),n.Lc(29,"--SELECT--"),n.Ub(),n.Jc(30,de,2,2,"option",20),n.Ub(),n.Ub(),n.Vb(31,"td"),n.Vb(32,"div",17),n.Qb(33,"ng-select",75),n.Jc(34,me,2,0,"a",26),n.Ub(),n.Ub(),n.Ub()}if(2&t){var r=e.index,o=n.hc();n.oc("formGroupName",r),n.Cb(2),n.oc("ngIf",r==o.myForm1.controls.stageListArray.controls.length-1),n.Cb(2),n.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",o.appConstants.PICKER_YEAR_RANGE)("dateFormat",o.appConstants.PICKER_DATE_FORMAT),n.Cb(1),n.oc("ngIf",o.myFormErrors1.stageListArray[r].startDate),n.Cb(2),n.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",o.appConstants.PICKER_YEAR_RANGE)("dateFormat",o.appConstants.PICKER_DATE_FORMAT)("minDate",o.myForm1Data.stageListArray[r].startDate),n.Cb(1),n.oc("ngIf",o.myFormErrors1.stageListArray[r].closingDate),n.Cb(3),n.oc("items",o.salesEmployeeList)("multiple",!1),n.Cb(2),n.oc("ngIf",o.myForm1Data.stageListArray[r].empId),n.Cb(5),n.oc("ngForOf",o.stageList),n.Cb(1),n.oc("ngIf",o.myFormErrors1.stageListArray[r].stageId),n.Cb(2),n.Nc(" ",o.myForm1Data.stageListArray[r].stagePercentage," "),n.Cb(1),n.oc("ngIf",o.myFormErrors1.stageListArray[r].stagePercentage),n.Cb(3),n.oc("items",o.activityNoList)("multiple",!1),n.Cb(5),n.oc("ngForOf",o.documentTypeList),n.Cb(3),n.oc("items",o.myForm1Data.stageListArray[r].documentList)("multiple",!1),n.Cb(1),n.oc("ngIf",!o.myForm1Data.stageListArray[r].documentNoFlag)}}function ge(t,e){if(1&t&&(n.Vb(0,"option",62),n.Lc(1),n.Ub()),2&t){var i=e.$implicit;n.oc("value",i.id),n.Cb(1),n.Mc(i.name)}}function he(t,e){if(1&t&&(n.Vb(0,"div",61),n.Lc(1),n.Ub()),2&t){var i=n.hc();n.Cb(1),n.Nc(" ",i.myFormErrors1.opportunityStatus," ")}}function fe(t,e){if(1&t){var i=n.Wb();n.Vb(0,"button",78),n.dc("click",(function(){return n.Dc(i),n.hc().saveUpdate()})),n.Qb(1,"i",79),n.Vb(2,"span"),n.Lc(3,"Save"),n.Ub(),n.Ub()}}function ve(t,e){if(1&t){var i=n.Wb();n.Vb(0,"button",3),n.dc("click",(function(){return n.Dc(i),n.hc().clearForm()})),n.Qb(1,"i",80),n.Vb(2,"span"),n.Lc(3,"Clear"),n.Ub(),n.Ub()}}function ye(t,e){if(1&t){var i=n.Wb();n.Vb(0,"button",78),n.dc("click",(function(){return n.Dc(i),n.hc().saveUpdate()})),n.Qb(1,"i",64),n.Vb(2,"span"),n.Lc(3,"Update"),n.Ub(),n.Ub()}}function Ce(t,e){1&t&&(n.Vb(0,"button",81),n.Qb(1,"i",82),n.Vb(2,"span"),n.Lc(3,"Cancel"),n.Ub(),n.Ub())}function Le(t,e){1&t&&(n.Vb(0,"div",85),n.Vb(1,"span",86),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"update"),n.Ub(),n.Lc(6," this transaction! "),n.Ub())}function Se(t,e){1&t&&(n.Vb(0,"div",85),n.Vb(1,"span",86),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," Cannot update "),n.Vb(4,"strong"),n.Lc(5,"In-Active"),n.Ub(),n.Lc(6," / "),n.Vb(7,"strong"),n.Lc(8,"Closed"),n.Ub(),n.Lc(9," transactions! "),n.Ub())}function Ie(t,e){if(1&t&&(n.Vb(0,"div",83),n.Vb(1,"div"),n.Vb(2,"strong"),n.Lc(3,"Created By:"),n.Ub(),n.Lc(4),n.Ub(),n.Jc(5,Le,7,0,"div",84),n.Jc(6,Se,10,0,"div",84),n.Ub()),2&t){var i=n.hc();n.Cb(4),n.Nc(" ",i.editCreatedName,""),n.Cb(1),n.oc("ngIf",!i.screenAcl.update),n.Cb(1),n.oc("ngIf","1"!==i.editStatusId)}}function Ue(t,e){1&t&&(n.Vb(0,"div",83),n.Vb(1,"span",86),n.Lc(2,"Note:"),n.Ub(),n.Lc(3," You are unauthorized to "),n.Vb(4,"strong"),n.Lc(5,"add"),n.Ub(),n.Lc(6," this transaction!. "),n.Ub())}var Ve,De,Fe=((Ve=function(){function t(e,i,r,o,n,s,c,b,u){_classCallCheck(this,t),this.utilsService=e,this.storageService=i,this.authGuardService=r,this.commonDataService=o,this.oppurtunityDataService=n,this.branchUtilsService=s,this.popupExternalService=c,this.formBuilder=b,this.activatedRoute=u,this.appConstants=a.h,this.screenAcl={},this.threatLevelName="",this.bizRefreshFlag=!1,this.opportunityTypeList=[],this.businessPartnerList=[],this.bpContactList=[],this.distributionList=[],this.salesEmployeeList=[],this.levelOfInterestList=[],this.industryList=[],this.infoSourceList=[],this.competitorList=[],this.reasonList=[],this.statusList=[],this.stageList=[],this.documentTypeList=[],this.activityNoList=[],this.myForm1Data={},this.myFormErrors1={opportunityNo:"",opportunityName:"",opportunityTypeId:"",businessPartnerId:"",bpContactsId:"",distributionRulesId:"",startDate:"",closingDate:"",potentialAmount:"",levelOfInterestId:"",industryId:"",informationSourceId:"",competitorId:"",opportunityStatus:"",reasonId:"",remarks:"",stageListArray:[]},this.myFormValidationMsgs1={opportunityNo:{required:"Opportunity No is required"},opportunityName:{required:"Opportunity Name is required"},opportunityTypeId:{required:"Opportunity Type is required"},businessPartnerId:{required:"Business Partner is required"},bpContactsId:{required:"Business Partner Contact is required"},distributionRulesId:{required:"Dist.Rules is required"},startDate:{required:"Start Date is required"},potentialAmount:{required:"Potential Amount is required",min:"Minimum should be greater than 0"},industryId:{required:"Industry is required"},informationSourceId:{required:"Information Source is required"},opportunityStatus:{required:"Status is required"},stageListArray:{startDate:{required:"Start Date is required"},closingDate:{required:"Closing Date is required"},stageId:{required:"Stage is required"},stagePercentage:{required:"Percentage is required"}}}}return _createClass(t,[{key:"ngOnInit",value:function(){if(this.screenAcl=this.authGuardService.getScreenAcl("1"),!this.screenAcl.view)return this.utilsService.showFailureMsg(a.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.initializeForm1(),this.initializeSubscriptions(),this.getAutoSuggestionList("getOpportunityTypeList"),this.getAutoSuggestionList("getLevelofInterestList"),this.getAutoSuggestionList("getOpportunityStatusList"),this.getDocumentTypeList()}},{key:"ngAfterViewInit",value:function(){this.attachmentsComponent.loadAttachments(this.inputEditId),this.udfViewerComponent.getFields(this.inputEditId)}},{key:"initializeSubscriptions",value:function(){var t=this;this.activatedRoute.params.subscribe((function(e){e.id?(t.inputEditId=t.utilsService.decrypt(e.id),t.get()):(t.getBpList(),t.getAutoSuggestionList("getIndustryList"),t.getAutoSuggestionList("getInformationSourceList"),t.getAutoSuggestionList("getCompetitorList"),t.getAutoSuggestionList("getReasonList"),t.getAutoSuggestionList("getStageList"),t.getSalesEmployeeList(),t.getDistributionList())})),this.branchUtilsService.actionSaveUpdate.subscribe((function(e){switch(e.triggerType){case"industry":t.getAutoSuggestionList("getIndustryList");break;case"info-source":t.getAutoSuggestionList("getInformationSourceList");break;case"competitor":t.getAutoSuggestionList("getCompetitorList");break;case"reason":t.getAutoSuggestionList("getReasonList");break;case"opportunity-type":t.getAutoSuggestionList("getOpportunityTypeList")}}))}},{key:"initializeForm1",value:function(){var t=this;this.myForm1=this.formBuilder.group({opportunityNo:[{value:"AUTO",disabled:!0},[u.u.required]],opportunityName:["",[u.u.required]],opportunityTypeId:["",[u.u.required]],businessPartnerId:[null,[u.u.required]],bpContactsId:[null,[u.u.required]],distributionRulesId:[null],empId:[null],startDate:["",[u.u.required]],closingDate:[{value:"",disabled:!0}],potentialAmount:["",[u.u.required,u.u.min(1)]],levelOfInterestId:[""],industryId:[null,[u.u.required]],informationSourceId:[null,[u.u.required]],competitorId:[null],opportunityStatus:["1",[u.u.required]],reasonId:[{value:null,disabled:!0}],remarks:[""],deletedStageChildIds:[[]],stageListArray:this.formBuilder.array([this.initStageFields()])}),this.myForm1.valueChanges.subscribe((function(e){t.utilsService.validation(t.myForm1,t.myFormErrors1,t.myFormValidationMsgs1),t.myForm1Data=t.myForm1.getRawValue()})),this.myForm1Data=this.myForm1.getRawValue(),this.storageService.get("distRulesMode")&&this.myForm1.controls.distributionRulesId.setValidators(u.u.required)}},{key:"addStageFields",value:function(t){var e=this.myForm1.controls.stageListArray;if(e.length>0&&!t&&!e.at(e.length-1).valid)return this.utilsService.showFailureMsg("Complete the validation for the previous stage to proceed!"),!1;e.push(this.initStageFields(t)),this.disableStagePrevFields()}},{key:"initStageFields",value:function(t){this.myFormErrors1.stageListArray.push({startDate:"",closingDate:"",stageId:"",stagePercentage:""});var e={startDate:["",[u.u.required]],closingDate:["",[u.u.required]],empId:[null],stageId:["",[u.u.required]],stagePercentage:["",[u.u.required]],activityId:[null],documentTypeId:[""],documentId:[null],documentList:[[]],documentNoFlag:[!1],id:[""]};return t&&(this.utilsService.updateObject(e,"startDate",t.startDate,"date"),this.utilsService.updateObject(e,"closingDate",t.closingDate,"date"),this.utilsService.updateObject(e,"empId",t.empId),this.utilsService.updateObject(e,"stageId",t.stageId),this.utilsService.updateObject(e,"stagePercentage",t.stagePercentage),this.utilsService.updateObject(e,"activityId",t.activityId),this.utilsService.updateObject(e,"documentTypeId",t.documentTypeId),this.utilsService.updateObject(e,"documentId",t.documentId),this.utilsService.updateObject(e,"id",t.id)),this.formBuilder.group(e)}},{key:"removeStageFields",value:function(t){var e=this.myForm1Data.stageListArray[t].id;if(e){var i=this.myForm1Data.deletedStageChildIds;i.push(e),this.myForm1.patchValue({deletedStageChildIds:i})}this.myForm1.controls.stageListArray.removeAt(t),this.disableStagePrevFields()}},{key:"disableStagePrevFields",value:function(){var t=this.myForm1.controls.stageListArray;t.length>0&&(t.disable(),t.at(t.length-1).enable())}},{key:"saveUpdate",value:function(){var t=this;if(!this.myForm1.valid||!this.udfViewerComponent.valid())return this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1,!0),this.udfViewerComponent.checkValidations(),!1;var e=new Set,i=[];if(this.myForm1Data.stageListArray.forEach((function(t){e.add(t.stageId),i.push(t.stageId)})),i.length!==e.size)return this.utilsService.showFailureMsg("Cannot duplicate stage"),!1;var r,o={opportunityNo:this.myForm1Data.opportunityNo,opportunityName:this.myForm1Data.opportunityName,opportunityTypeId:this.myForm1Data.opportunityTypeId,businessPartnerId:this.myForm1Data.businessPartnerId,bpContactsId:this.myForm1Data.bpContactsId,distributionRulesId:Array.isArray(this.myForm1Data.distributionRulesId)?this.myForm1Data.distributionRulesId.join(","):"",empId:this.myForm1Data.empId,startDate:this.utilsService.getBackendDateFormat(this.myForm1Data.startDate),closingDate:this.utilsService.getBackendDateFormat(this.myForm1Data.closingDate),potentialAmount:this.myForm1Data.potentialAmount,levelOfInterestId:this.myForm1Data.levelOfInterestId,industryId:this.myForm1Data.industryId,informationSourceId:this.myForm1Data.informationSourceId,competitorId:this.myForm1Data.competitorId,opportunityStatus:this.myForm1Data.opportunityStatus,reasonId:this.myForm1Data.reasonId,remarks:this.myForm1Data.remarks,opportunityStagesId:this.myForm1Data.opportunityStagesId,stageListArray:[],udfFields:JSON.stringify(this.udfViewerComponent.getFormValues())};this.myForm1Data.stageListArray.forEach((function(e){var i={startDate:t.utilsService.getBackendDateFormat(e.startDate),closingDate:t.utilsService.getBackendDateFormat(e.closingDate),empId:e.empId,stageId:e.stageId,stagePercentage:e.stagePercentage,activityId:e.activityId,documentTypeId:e.documentTypeId,documentId:e.documentId,id:e.id};o.stageListArray.push(i)})),this.inputEditId?(r="update",o.id=this.inputEditId,o.deletedStageChildIds=this.myForm1Data.deletedStageChildIds):r="save",this.oppurtunityDataService[r](o).subscribe((function(e){"SUCCESS"===e.status?(t.utilsService.showSuccessMsg(e),t.attachmentsComponent.save("save"===r?e.sId:t.inputEditId)):t.utilsService.showFailureMsg(e)}))}},{key:"redirectToList",value:function(){this.utilsService.redirect("/branch/crm/oppurtunity-list")}},{key:"get",value:function(){var t=this;this.oppurtunityDataService.get(this.inputEditId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results,r={};t.utilsService.updateObject(r,"opportunityNo",i.opportunityNo),t.utilsService.updateObject(r,"opportunityName",i.opportunityName),t.utilsService.updateObject(r,"opportunityTypeId",i.opportunityTypeId),t.utilsService.updateObject(r,"businessPartnerId",i.businessPartnerId),t.utilsService.updateObject(r,"bpContactsId",i.bpContactsId),t.utilsService.isEmpty(i.distributionRulesId)||(r.distributionRulesId=t.branchUtilsService.distRulesRemoveZeroPatternOnEdit(i.distributionRulesId)),t.utilsService.updateObject(r,"empId",i.empId),t.utilsService.updateObject(r,"startDate",i.startDate,"date"),t.utilsService.updateObject(r,"closingDate",i.closingDate,"date"),t.utilsService.updateObject(r,"potentialAmount",i.potentialAmount),t.utilsService.updateObject(r,"levelOfInterestId",i.levelOfInterestId),t.utilsService.updateObject(r,"industryId",i.industryId),t.utilsService.updateObject(r,"informationSourceId",i.informationSourceId),t.utilsService.updateObject(r,"competitorId",i.competitorId),t.utilsService.updateObject(r,"opportunityStatus",i.opportunityStatus),t.utilsService.updateObject(r,"reasonId",i.reasonId),t.utilsService.updateObject(r,"remarks",i.remarks),t.utilsService.updateObject(r,"opportunityStagesId",i.opportunityStagesId),t.myForm1.patchValue(r),t.getBpList(!0,i.businessPartnerInfo),t.getAutoSuggestionList("getIndustryList",i.industryInfo),t.getAutoSuggestionList("getInformationSourceList",i.infoSourceInfo),t.getAutoSuggestionList("getCompetitorList",i.competitorInfo),t.getAutoSuggestionList("getReasonList",i.reasonInfo),t.getDistributionList(i.distributionRulesInfo),t.getBpContactList(!0,i.bpContactsInfo),t.removeStageFields(0);var o=[],a=[i.empInfo[0]],n=[];i.stageListArray.forEach((function(e,i){t.addStageFields(e),e.stageInfo[0]&&o.push(e.stageInfo[0]),e.empInfo[0]&&a.push(e.empInfo[0]),e.activityNumberInfo[0]&&n.push(e.activityNumberInfo[0]),t.getDocumentList(i,!0,e.documentInfo)})),t.getAutoSuggestionList("getStageList",o),t.getSalesEmployeeList(a),t.getActivityNoList(n),t.onStatusChange(!0),t.disableStagePrevFields(),t.editStatusId=i.opportunityStatus,t.editCreatedName=i.createdByInfo[0].employeeName,"1"===t.editStatusId?t.myForm1.controls.businessPartnerId.disable():t.myForm1.enable()}else t.utilsService.showFailureMsg(e)}))}},{key:"clearForm",value:function(){this.initializeForm1()}},{key:"setThreatLevel",value:function(t){var e=o.findIndex(this.competitorList,{id:t});this.threatLevelName=e>=0?this.competitorList[e].threatLevelName:""}},{key:"setStagePercentage",value:function(t,e){var i=o.findIndex(this.stageList,{id:e}),r="";i>=0&&(r=this.stageList[i].closePercentage),this.myForm1.controls.stageListArray.at(t).patchValue({stagePercentage:r})}},{key:"onStatusChange",value:function(t){"1"===this.myForm1Data.opportunityStatus?(t||this.myForm1.patchValue({closingDate:""}),this.myForm1.patchValue({reasonId:null}),this.myForm1.controls.reasonId.disable(),this.myForm1.controls.closingDate.disable()):(t||this.myForm1.patchValue({closingDate:this.utilsService.getPickerDateFormat(new Date)}),this.myForm1.controls.reasonId.enable(),this.myForm1.controls.closingDate.enable())}},{key:"onStartDateChange",value:function(){this.myForm1.patchValue({closingDate:""})}},{key:"onStageStartDateChange",value:function(t){this.myForm1.controls.stageListArray.at(t).patchValue({closingDate:""})}},{key:"resetDocument",value:function(){var t,e=_createForOfIteratorHelper(this.myForm1.controls.stageListArray.controls);try{for(e.s();!(t=e.n()).done;)t.value.patchValue({documentTypeId:"",documentId:null,documentList:[]})}catch(i){e.e(i)}finally{e.f()}}},{key:"onDistRuleAdd",value:function(){this.branchUtilsService.distRulesCheckUnique(this.distributionList,this.myForm1,"distributionRulesId")}},{key:"getAutoSuggestionList",value:function(t,e){var i=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(r){"SUCCESS"===r.status?(i.utilsService.ifNotPushToList(r.results,e),"getOpportunityTypeList"===t?i.opportunityTypeList=r.results:"getLevelofInterestList"===t?i.levelOfInterestList=r.results:"getIndustryList"===t?i.industryList=r.results:"getInformationSourceList"===t?i.infoSourceList=r.results:"getCompetitorList"===t?(i.competitorList=r.results,Array.isArray(e)&&i.setThreatLevel(e[0].id)):"getReasonList"===t?i.reasonList=r.results:"getOpportunityStatusList"===t?(i.inputEditId||(r.results=r.results.filter((function(t){return"1"===t.id}))),i.statusList=r.results):"getStageList"===t&&(i.stageList=r.results)):i.utilsService.showFailureMsg(r)}))}},{key:"getBpList",value:function(t,e){var i=this;this.commonDataService.getBusinessPartnerList([1,3]).subscribe((function(t){"SUCCESS"===t.status?(i.utilsService.ifNotPushToList(t.results,e),i.businessPartnerList=t.results.map((function(t){return t.searchText=t.partnerName+" - "+t.partnerCode,t}))):i.utilsService.showFailureMsg(t)}))}},{key:"getSalesEmployeeList",value:function(t){var e=this;this.commonDataService.getEmployeeList(1).subscribe((function(i){"SUCCESS"===i.status?(e.utilsService.ifNotPushToList(i.results,t),e.salesEmployeeList=i.results.map((function(t){return t.searchText=t.employeeName+" - "+t.empCode,t}))):e.utilsService.showFailureMsg(i)}))}},{key:"getBpContactList",value:function(t,e){var i=this;this.bpContactList=[],this.branchUtilsService.getBpContactListAndSet(this.myForm1,"bpContactsId","businessPartnerId",t,e).subscribe((function(t){i.bpContactList=t}))}},{key:"getDocumentList",value:function(t,e,i){var r=this,o=this.myForm1.controls.stageListArray.at(t),a=this.myForm1Data.stageListArray[t].documentTypeId,n=this.myForm1Data.businessPartnerId;if(o.patchValue({documentList:[]}),e||o.patchValue({documentId:null}),!n)return this.utilsService.showFailureMsg("Select business partner to get the appropriate documents!"),o.patchValue({documentTypeId:""}),!1;this.utilsService.isEmpty(a)||this.commonDataService.getDocumentList(a,n).subscribe((function(t){"SUCCESS"===t.status?(o.patchValue({documentList:t.results}),e&&r.utilsService.ifNotPushToList(o.controls.documentList.value,i)):r.utilsService.showFailureMsg(t)}))}},{key:"getActivityNoList",value:function(t){var e=this;if(!this.myForm1Data.businessPartnerId)return this.activityNoList=[],!1;this.commonDataService.getDocumentList(4,this.myForm1Data.businessPartnerId).subscribe((function(i){"SUCCESS"===i.status?(e.utilsService.ifNotPushToList(i.results,t),e.activityNoList=i.results):e.utilsService.showFailureMsg(i)}))}},{key:"getDocumentTypeList",value:function(){var t=this;this.branchUtilsService.getDocumentTypeListBasedOnScreen("opportunity").subscribe((function(e){t.documentTypeList=e}))}},{key:"getDistributionList",value:function(t){var e=this;this.commonDataService.getDistributionList(!0).subscribe((function(i){"SUCCESS"===i.status?(e.utilsService.ifNotPushToList(i.results,t),e.distributionList=i.results):e.utilsService.showFailureMsg(i)}))}},{key:"navigateToDocument",value:function(t){var e=this.myForm1.controls.stageListArray.at(t);if(e.value.documentTypeId)switch(e.value.documentTypeId){case"2":this.utilsService.externalRedirect("#/branch/sales/sales-txn-add/salesQuote",!0);break;case"3":this.utilsService.externalRedirect("#/branch/sales/sales-txn-add/salesOrder",!0)}else this.utilsService.showFailureMsg("Select document type to continue!")}},{key:"onKeydownHandler",value:function(t){t.ctrlKey&&"s"===t.key.toLowerCase()&&(this.inputEditId&&"1"===this.editStatusId||!this.inputEditId)&&(this.saveUpdate(),t.preventDefault())}}]),t}()).\u0275fac=function(t){return new(t||Ve)(n.Pb(a.g),n.Pb(a.f),n.Pb(a.a),n.Pb(s.l),n.Pb(s.H),n.Pb(P.a),n.Pb(M.a),n.Pb(u.e),n.Pb(r.a))},Ve.\u0275cmp=n.Jb({type:Ve,selectors:[["app-oppurtunity-add"]],viewQuery:function(t,e){var i;1&t&&(n.Pc(k.a,!0),n.Pc(R.a,!0)),2&t&&(n.zc(i=n.ec())&&(e.attachmentsComponent=i.first),n.zc(i=n.ec())&&(e.udfViewerComponent=i.first))},hostBindings:function(t,e){1&t&&n.dc("keydown",(function(t){return e.onKeydownHandler(t)}),!1,n.Bc)},decls:231,vars:58,consts:[[1,"page-title"],[4,"ngIf"],[1,"btn-group"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-arrow-left"],[1,"working-container",3,"formGroup"],[1,"box"],[1,"box-header"],[1,"fa","fa-angle-right"],[1,"box-body","box-form"],[1,"row"],[1,"form-group","col-sm-3"],[1,"form-label"],[1,"mandatory"],["type","text","formControlName","opportunityNo",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],["type","text","formControlName","opportunityName",1,"form-control","form-control-sm"],[1,"action-control"],["formControlName","opportunityTypeId",1,"form-control","form-control-sm"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"click"],[1,"fa","fa-plus"],["formControlName","businessPartnerId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple","clear","change"],["ng-option-tmp",""],["target","_blank","routerLink","/branch/bp/biz-partner-add",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["class","info-icon","container","body","tooltip","View Details",3,"click",4,"ngIf"],["formControlName","bpContactsId","bindLabel","contactName","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["class","mandatory",4,"ngIf"],["formControlName","distributionRulesId","bindLabel","distributionName","bindValue","id","placeholder","--SELECT--","groupBy","dimensionDescription",3,"items","multiple","add"],[1,"position-relative"],["formControlName","empId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["formControlName","startDate",3,"monthNavigator","yearNavigator","yearRange","dateFormat","onSelect"],["formControlName","closingDate",3,"monthNavigator","yearNavigator","yearRange","dateFormat","minDate"],["type","number","formControlName","potentialAmount",1,"form-control","form-control-sm"],["formControlName","levelOfInterestId",1,"form-control","form-control-sm"],["formControlName","industryId","bindLabel","industryName","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["formControlName","informationSourceId","bindLabel","sourceDescription","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],[1,"box-body","box-table"],[1,"table-responsive"],[1,"table","table-striped","table-bordered"],[2,"min-width","120px"],[2,"min-width","150px"],[2,"min-width","100px"],["formArrayName","stageListArray"],[3,"formGroupName",4,"ngFor","ngForOf"],["colspan","9"],[1,"btn","btn-success","btn-sm",3,"click"],["formControlName","competitorId","bindLabel","competitorName","bindValue","id","placeholder","--SELECT--",3,"items","multiple","change"],["readonly","",1,"form-control","form-control-sm",3,"value"],["formControlName","opportunityStatus",1,"form-control","form-control-sm",3,"change"],["formControlName","reasonId","bindLabel","reasonDescription","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["rows","2","formControlName","remarks",1,"form-control","form-control-sm"],[3,"type"],[3,"type","doSuccess"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm","routerLink","/branch/crm/oppurtunity-list",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],[1,"validation-error"],[3,"value"],["target","_blank","routerLink","/branch/bp/biz-partner-add",3,"click"],[1,"fa","fa-redo-alt"],["container","body","tooltip","View Details",1,"info-icon",3,"click"],[1,"fa","fa-info-circle"],[3,"formGroupName"],["class","action red",3,"click",4,"ngIf"],["formControlName","startDate","appendTo","body",3,"monthNavigator","yearNavigator","yearRange","dateFormat","onSelect"],["formControlName","closingDate","appendTo","body",3,"monthNavigator","yearNavigator","yearRange","dateFormat","minDate"],["formControlName","empId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["formControlName","stageId",1,"form-control","form-control-sm",3,"change"],["formControlName","activityId","bindLabel","documentNumber","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["formControlName","documentTypeId",1,"form-control","form-control-sm",3,"change"],["formControlName","documentId","bindLabel","documentNumber","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],[1,"action","red",3,"click"],[1,"fa","fa-minus-circle"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"fa","fa-broom"],["routerLink","/branch/crm/oppurtunity-list",1,"btn","btn-secondary","btn-sm"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],["class","mt-2",4,"ngIf"],[1,"mt-2"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(n.Vb(0,"div",0),n.Vb(1,"span"),n.Lc(2,"S"),n.Ub(),n.Lc(3,"ales Opportunities - "),n.Jc(4,Mt,2,0,"ng-container",1),n.Jc(5,Ot,2,0,"ng-container",1),n.Vb(6,"div",2),n.Vb(7,"button",3),n.dc("click",(function(){return e.utilsService.goBack()})),n.Qb(8,"i",4),n.Vb(9,"span"),n.Lc(10,"Back"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(11,"div",5),n.Vb(12,"div",6),n.Vb(13,"div",7),n.Qb(14,"i",8),n.Lc(15,"Opportunity Info "),n.Ub(),n.Vb(16,"div",9),n.Vb(17,"div",10),n.Vb(18,"div",11),n.Vb(19,"label",12),n.Lc(20,"Opportunity Number"),n.Vb(21,"span",13),n.Lc(22,"*"),n.Ub(),n.Ub(),n.Qb(23,"input",14),n.Jc(24,wt,2,1,"div",15),n.Ub(),n.Vb(25,"div",11),n.Vb(26,"label",12),n.Lc(27,"Opportunity Name"),n.Vb(28,"span",13),n.Lc(29,"*"),n.Ub(),n.Ub(),n.Qb(30,"input",16),n.Jc(31,Jt,2,1,"div",15),n.Ub(),n.Vb(32,"div",11),n.Vb(33,"label",12),n.Lc(34,"Opportunity Type"),n.Vb(35,"span",13),n.Lc(36,"*"),n.Ub(),n.Ub(),n.Vb(37,"div",17),n.Vb(38,"select",18),n.Vb(39,"option",19),n.Lc(40,"--SELECT--"),n.Ub(),n.Jc(41,_t,2,2,"option",20),n.Ub(),n.Vb(42,"span"),n.Vb(43,"a",21),n.dc("click",(function(){return e.popupExternalService.showAddPopup("opportunity-type")})),n.Qb(44,"i",22),n.Ub(),n.Ub(),n.Ub(),n.Jc(45,xt,2,1,"div",15),n.Ub(),n.Vb(46,"div",11),n.Vb(47,"label",12),n.Lc(48,"Business Partner Name"),n.Vb(49,"span",13),n.Lc(50,"*"),n.Ub(),n.Ub(),n.Vb(51,"div",17),n.Vb(52,"ng-select",23),n.dc("clear",(function(){return e.getBpContactList()}))("change",(function(){return e.getBpContactList(),e.resetDocument(),e.getActivityNoList()})),n.Jc(53,Bt,4,2,"ng-template",24),n.Ub(),n.Vb(54,"span"),n.Jc(55,Qt,2,0,"a",25),n.Jc(56,qt,2,0,"a",26),n.Ub(),n.Jc(57,jt,2,0,"span",27),n.Ub(),n.Jc(58,zt,2,1,"div",15),n.Ub(),n.Vb(59,"div",11),n.Vb(60,"label",12),n.Lc(61,"Business Partner Contact"),n.Vb(62,"span",13),n.Lc(63,"*"),n.Ub(),n.Ub(),n.Vb(64,"ng-select",28),n.Jc(65,Kt,4,3,"ng-template",24),n.Ub(),n.Jc(66,Gt,2,1,"div",15),n.Ub(),n.Vb(67,"div",11),n.Vb(68,"label",12),n.Lc(69,"Distribution Rules"),n.Jc(70,Wt,2,0,"span",29),n.Ub(),n.Vb(71,"ng-select",30),n.dc("add",(function(){return e.onDistRuleAdd()})),n.Ub(),n.Jc(72,$t,2,1,"div",15),n.Ub(),n.Vb(73,"div",11),n.Vb(74,"label",12),n.Lc(75,"Sales Employee"),n.Ub(),n.Vb(76,"div",31),n.Vb(77,"ng-select",32),n.Jc(78,Yt,4,2,"ng-template",24),n.Ub(),n.Jc(79,Ht,2,0,"span",27),n.Ub(),n.Ub(),n.Vb(80,"div",11),n.Vb(81,"label",12),n.Lc(82,"Start Date"),n.Vb(83,"span",13),n.Lc(84,"*"),n.Ub(),n.Ub(),n.Vb(85,"p-calendar",33),n.dc("onSelect",(function(){return e.onStartDateChange()})),n.Ub(),n.Jc(86,Zt,2,1,"div",15),n.Ub(),n.Vb(87,"div",11),n.Vb(88,"label",12),n.Lc(89,"Closing Date"),n.Ub(),n.Qb(90,"p-calendar",34),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(91,"div",6),n.Vb(92,"div",7),n.Qb(93,"i",8),n.Lc(94,"Potential Info "),n.Ub(),n.Vb(95,"div",9),n.Vb(96,"div",10),n.Vb(97,"div",11),n.Vb(98,"label",12),n.Lc(99,"Potential Amount"),n.Vb(100,"span",13),n.Lc(101,"*"),n.Ub(),n.Ub(),n.Qb(102,"input",35),n.Jc(103,Xt,2,1,"div",15),n.Ub(),n.Vb(104,"div",11),n.Vb(105,"label",12),n.Lc(106,"Level of Interest"),n.Ub(),n.Vb(107,"select",36),n.Vb(108,"option",19),n.Lc(109,"--SELECT--"),n.Ub(),n.Jc(110,te,2,2,"option",20),n.Ub(),n.Jc(111,ee,2,1,"div",15),n.Ub(),n.Vb(112,"div",11),n.Vb(113,"label",12),n.Lc(114,"Industry"),n.Vb(115,"span",13),n.Lc(116,"*"),n.Ub(),n.Ub(),n.Vb(117,"div",17),n.Qb(118,"ng-select",37),n.Vb(119,"span"),n.Vb(120,"a",21),n.dc("click",(function(){return e.popupExternalService.showAddPopup("industry")})),n.Qb(121,"i",22),n.Ub(),n.Ub(),n.Ub(),n.Jc(122,ie,2,1,"div",15),n.Ub(),n.Vb(123,"div",11),n.Vb(124,"label",12),n.Lc(125,"Information Source"),n.Vb(126,"span",13),n.Lc(127,"*"),n.Ub(),n.Ub(),n.Vb(128,"div",17),n.Qb(129,"ng-select",38),n.Vb(130,"span"),n.Vb(131,"a",21),n.dc("click",(function(){return e.popupExternalService.showAddPopup("info-source")})),n.Qb(132,"i",22),n.Ub(),n.Ub(),n.Ub(),n.Jc(133,re,2,1,"div",15),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(134,"div",6),n.Vb(135,"div",7),n.Qb(136,"i",8),n.Lc(137,"Stages Info "),n.Ub(),n.Vb(138,"div",39),n.Vb(139,"div",40),n.Vb(140,"table",41),n.Vb(141,"thead"),n.Vb(142,"tr"),n.Vb(143,"th",42),n.Lc(144,"Action"),n.Ub(),n.Vb(145,"th",43),n.Lc(146,"Start Date"),n.Vb(147,"span",13),n.Lc(148,"*"),n.Ub(),n.Ub(),n.Vb(149,"th",43),n.Lc(150,"Closing Date"),n.Vb(151,"span",13),n.Lc(152,"*"),n.Ub(),n.Ub(),n.Vb(153,"th",43),n.Lc(154,"Sales Employee"),n.Ub(),n.Vb(155,"th",42),n.Lc(156,"Stage"),n.Vb(157,"span",13),n.Lc(158,"*"),n.Ub(),n.Ub(),n.Vb(159,"th",43),n.Lc(160,"Stage Percentage"),n.Vb(161,"span",13),n.Lc(162,"*"),n.Ub(),n.Ub(),n.Vb(163,"th",42),n.Lc(164,"Activity No"),n.Ub(),n.Vb(165,"th",43),n.Lc(166,"Document Type"),n.Ub(),n.Vb(167,"th",44),n.Lc(168,"Document No"),n.Ub(),n.Ub(),n.Ub(),n.Vb(169,"tbody",45),n.Jc(170,pe,35,26,"tr",46),n.Ub(),n.Vb(171,"tfoot"),n.Vb(172,"tr"),n.Vb(173,"td",47),n.Vb(174,"button",48),n.dc("click",(function(){return e.addStageFields()})),n.Qb(175,"i",22),n.Vb(176,"span"),n.Lc(177,"Add Stage"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(178,"div",6),n.Vb(179,"div",7),n.Qb(180,"i",8),n.Lc(181,"Competitor "),n.Ub(),n.Vb(182,"div",9),n.Vb(183,"div",10),n.Vb(184,"div",11),n.Vb(185,"label",12),n.Lc(186,"Competitor"),n.Ub(),n.Vb(187,"div",17),n.Vb(188,"ng-select",49),n.dc("change",(function(t){return e.setThreatLevel(t.id)})),n.Ub(),n.Vb(189,"span"),n.Vb(190,"a",21),n.dc("click",(function(){return e.popupExternalService.showAddPopup("competitor")})),n.Qb(191,"i",22),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(192,"div",11),n.Vb(193,"label",12),n.Lc(194,"Threat Level"),n.Ub(),n.Qb(195,"input",50),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(196,"div",6),n.Vb(197,"div",7),n.Qb(198,"i",8),n.Lc(199,"Summary "),n.Ub(),n.Vb(200,"div",9),n.Vb(201,"div",10),n.Vb(202,"div",11),n.Vb(203,"label",12),n.Lc(204,"Status"),n.Vb(205,"span",13),n.Lc(206,"*"),n.Ub(),n.Ub(),n.Vb(207,"select",51),n.dc("change",(function(){return e.onStatusChange()})),n.Jc(208,ge,2,2,"option",20),n.Ub(),n.Jc(209,he,2,1,"div",15),n.Ub(),n.Vb(210,"div",11),n.Vb(211,"label",12),n.Lc(212,"Reason"),n.Ub(),n.Vb(213,"div",17),n.Qb(214,"ng-select",52),n.Vb(215,"span"),n.Vb(216,"a",21),n.dc("click",(function(){return e.popupExternalService.showAddPopup("reason")})),n.Qb(217,"i",22),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(218,"div",11),n.Vb(219,"label",12),n.Lc(220,"Remarks"),n.Ub(),n.Qb(221,"textarea",53),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Qb(222,"app-udf-viewer",54),n.Vb(223,"app-attachments",55),n.dc("doSuccess",(function(){return e.redirectToList()})),n.Ub(),n.Vb(224,"div",56),n.Jc(225,fe,4,0,"button",57),n.Jc(226,ve,4,0,"button",58),n.Jc(227,ye,4,0,"button",57),n.Jc(228,Ce,4,0,"button",59),n.Ub(),n.Jc(229,Ie,7,3,"div",60),n.Jc(230,Ue,7,0,"div",60),n.Ub()),2&t&&(n.Cb(4),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(6),n.oc("formGroup",e.myForm1),n.Cb(13),n.oc("ngIf",e.myFormErrors1.opportunityNo),n.Cb(7),n.oc("ngIf",e.myFormErrors1.opportunityName),n.Cb(10),n.oc("ngForOf",e.opportunityTypeList),n.Cb(4),n.oc("ngIf",e.myFormErrors1.opportunityTypeId),n.Cb(7),n.oc("items",e.businessPartnerList)("multiple",!1),n.Cb(3),n.oc("ngIf",!e.bizRefreshFlag),n.Cb(1),n.oc("ngIf",e.bizRefreshFlag),n.Cb(1),n.oc("ngIf",e.myForm1Data.businessPartnerId),n.Cb(1),n.oc("ngIf",e.myFormErrors1.businessPartnerId),n.Cb(6),n.oc("items",e.bpContactList)("multiple",!1),n.Cb(2),n.oc("ngIf",e.myFormErrors1.bpContactsId),n.Cb(4),n.oc("ngIf",e.storageService.get("distRulesMode")),n.Cb(1),n.oc("items",e.distributionList)("multiple",!0),n.Cb(1),n.oc("ngIf",e.myFormErrors1.distributionRulesId),n.Cb(5),n.oc("items",e.salesEmployeeList)("multiple",!1),n.Cb(2),n.oc("ngIf",e.myForm1Data.empId),n.Cb(6),n.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",e.appConstants.PICKER_YEAR_RANGE)("dateFormat",e.appConstants.PICKER_DATE_FORMAT),n.Cb(1),n.oc("ngIf",e.myFormErrors1.startDate),n.Cb(4),n.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",e.appConstants.PICKER_YEAR_RANGE)("dateFormat",e.appConstants.PICKER_DATE_FORMAT)("minDate",e.myForm1Data.startDate),n.Cb(13),n.oc("ngIf",e.myFormErrors1.potentialAmount),n.Cb(7),n.oc("ngForOf",e.levelOfInterestList),n.Cb(1),n.oc("ngIf",e.myFormErrors1.levelOfInterestId),n.Cb(7),n.oc("items",e.industryList)("multiple",!1),n.Cb(4),n.oc("ngIf",e.myFormErrors1.industryId),n.Cb(7),n.oc("items",e.infoSourceList)("multiple",!1),n.Cb(4),n.oc("ngIf",e.myFormErrors1.informationSourceId),n.Cb(37),n.oc("ngForOf",e.myForm1.controls.stageListArray.controls),n.Cb(18),n.oc("items",e.competitorList)("multiple",!1),n.Cb(7),n.oc("value",e.threatLevelName),n.Cb(13),n.oc("ngForOf",e.statusList),n.Cb(1),n.oc("ngIf",e.myFormErrors1.opportunityStatus),n.Cb(5),n.oc("items",e.reasonList)("multiple",!1),n.Cb(8),n.oc("type",e.branchUtilsService.screenAttributes.opportunity.backendKey),n.Cb(1),n.oc("type",e.branchUtilsService.screenAttributes.opportunity.backendKey),n.Cb(2),n.oc("ngIf",e.screenAcl.add&&!e.inputEditId),n.Cb(1),n.oc("ngIf",!e.inputEditId),n.Cb(1),n.oc("ngIf",e.screenAcl.update&&e.inputEditId&&"1"===e.editStatusId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(1),n.oc("ngIf",e.inputEditId),n.Cb(1),n.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[c.m,u.n,u.i,u.b,u.m,u.g,u.t,u.p,u.v,c.l,O.a,O.c,b.a,u.q,u.d,R.a,k.a,r.g,m.a,u.j,r.e],styles:[""]}),Ve),Ne=r.h.forChild([{path:"activity-list",component:A},{path:"activity-add",component:yt},{path:"activity-edit/:id",component:yt},{path:"oppurtunity-list",component:Pt},{path:"oppurtunity-add",component:Fe},{path:"oppurtunity-edit/:id",component:Fe}]),Te=i("o+NB"),Ee=i("7zUj"),Ae=i("N5hj"),ke=i("dJ0z"),Re=((De=function t(){_classCallCheck(this,t)}).\u0275mod=n.Nb({type:De}),De.\u0275inj=n.Mb({factory:function(t){return new(t||De)},imports:[[Ne,Te.BranchModule,Ee.a,Ae.a,ke.a]]}),De)}}]);