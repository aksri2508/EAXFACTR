function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{FP8e:function(t,e,i){"use strict";i.r(e),i.d(e,"InventoryModule",(function(){return Zr}));var r=i("tyNb"),n=i("ey9i"),a=i("fXoL"),o=i("oARB"),s=i("IzNV"),c=i("fIZe"),u=i("ofXK"),b=i("rEr+"),l=i("7zfz"),m=i("Mfq2"),d=i("3Pt+"),h=["dataTable"];function p(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",15),a.dc("click",(function(){return a.Dc(i),a.hc(2).downloadAsExcel()})),a.Qb(1,"i",16),a.Vb(2,"span"),a.Lc(3,"Download as Excel"),a.Ub(),a.Ub()}}function f(t,e){1&t&&a.Qb(0,"col",22)}function g(t,e){if(1&t&&(a.Vb(0,"colgroup"),a.Qb(1,"col",17),a.Jc(2,f,1,0,"col",18),a.Qb(3,"col",19),a.Qb(4,"col",20),a.Qb(5,"col",21),a.Qb(6,"col",21),a.Qb(7,"col",21),a.Ub()),2&t){var i=a.hc(2);a.Cb(2),a.oc("ngIf",i.storageService.get("isSap"))}}function v(t,e){1&t&&(a.Vb(0,"th",24),a.Lc(1,"Sap No"),a.Qb(2,"p-sortIcon",25),a.Ub()),2&t&&(a.oc("pSortableColumn","sapId"),a.Cb(2),a.oc("field","sapId"))}function y(t,e){if(1&t){var i=a.Wb();a.Vb(0,"th"),a.Vb(1,"input",29),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(3).searchForm.sapId=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(3).resetListing()})),a.Ub(),a.Ub()}if(2&t){var r=a.hc(3);a.Cb(1),a.oc("ngModel",r.searchForm.sapId)}}function L(t,e){if(1&t&&(a.Vb(0,"option",33),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Nc(" ",i.groupName," ")}}function S(t,e){if(1&t&&(a.Vb(0,"option",33),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Nc(" ",i.name," ")}}function C(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"th"),a.Lc(2,"Actions"),a.Ub(),a.Jc(3,v,3,2,"th",23),a.Vb(4,"th"),a.Lc(5,"Item Image"),a.Ub(),a.Vb(6,"th",24),a.Lc(7,"Item Name"),a.Qb(8,"p-sortIcon",25),a.Ub(),a.Vb(9,"th",24),a.Lc(10,"Stock"),a.Qb(11,"p-sortIcon",25),a.Ub(),a.Vb(12,"th",24),a.Lc(13,"Item Group"),a.Qb(14,"p-sortIcon",25),a.Ub(),a.Vb(15,"th",24),a.Lc(16,"Status"),a.Qb(17,"p-sortIcon",25),a.Ub(),a.Ub(),a.Vb(18,"tr",26),a.Vb(19,"th"),a.Vb(20,"a",27),a.dc("click",(function(){return a.Dc(i),a.hc(2).clearSearchForm()})),a.Qb(21,"i",28),a.Lc(22,"Clear"),a.Ub(),a.Ub(),a.Jc(23,y,2,1,"th",0),a.Qb(24,"th"),a.Vb(25,"th"),a.Vb(26,"input",29),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.itemName=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(27,"th"),a.Vb(28,"input",29),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.stock=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(29,"th"),a.Vb(30,"select",30),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.itemGroupId=t}))("change",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Vb(31,"option",31),a.Lc(32,"--SELECT--"),a.Ub(),a.Jc(33,L,2,2,"option",32),a.Ub(),a.Ub(),a.Vb(34,"th"),a.Vb(35,"select",30),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.status=t}))("change",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Vb(36,"option",31),a.Lc(37,"--SELECT--"),a.Ub(),a.Jc(38,S,2,2,"option",32),a.Ub(),a.Ub(),a.Ub()}if(2&t){var r=a.hc(2);a.Cb(3),a.oc("ngIf",r.storageService.get("isSap")),a.Cb(3),a.oc("pSortableColumn","itemName"),a.Cb(2),a.oc("field","itemName"),a.Cb(1),a.oc("pSortableColumn","stock"),a.Cb(2),a.oc("field","stock"),a.Cb(1),a.oc("pSortableColumn","itemGroupId"),a.Cb(2),a.oc("field","itemGroupId"),a.Cb(1),a.oc("pSortableColumn","status"),a.Cb(2),a.oc("field","status"),a.Cb(6),a.oc("ngIf",r.storageService.get("isSap")),a.Cb(3),a.oc("ngModel",r.searchForm.itemName),a.Cb(2),a.oc("ngModel",r.searchForm.stock),a.Cb(2),a.oc("ngModel",r.searchForm.itemGroupId),a.Cb(3),a.oc("ngForOf",r.itemGroupList),a.Cb(2),a.oc("ngModel",r.searchForm.status),a.Cb(3),a.oc("ngForOf",r.statusList)}}function I(t,e){if(1&t&&(a.Vb(0,"td"),a.Lc(1),a.Ub()),2&t){var i=a.hc().$implicit;a.Cb(1),a.Mc(i.sapId)}}function U(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"td"),a.Vb(2,"a",34),a.Qb(3,"i",35),a.Ub(),a.Ub(),a.Jc(4,I,2,1,"td",0),a.Vb(5,"td"),a.Qb(6,"img",36),a.Ub(),a.Vb(7,"td"),a.Lc(8),a.Ub(),a.Vb(9,"td"),a.Lc(10),a.Vb(11,"a",37),a.dc("click",(function(){a.Dc(i);var t=e.$implicit;return a.hc(2).popupExternalService.showDetailPopup("item",t.id)})),a.Lc(12,"Check Stock"),a.Ub(),a.Ub(),a.Vb(13,"td"),a.Lc(14),a.Ub(),a.Vb(15,"td"),a.Vb(16,"span",38),a.Lc(17),a.Ub(),a.Ub(),a.Ub()}if(2&t){var r=e.$implicit,n=a.hc(2);a.Cb(2),a.qc("routerLink","/branch/inventory/item-edit/",n.utilsService.encrypt(r.id),""),a.Cb(2),a.oc("ngIf",n.storageService.get("isSap")),a.Cb(2),a.oc("src",r.itemImgUrl?r.itemImgUrl:n.appConstants.DEFAULT_IMAGE_ICON,a.Fc),a.Cb(2),a.Oc("",r.itemCode," - ",r.itemName,""),a.Cb(2),a.Nc("",r.stock," "),a.Cb(4),a.Mc(r.groupName),a.Cb(2),a.oc("ngClass",n.appConstants.STATUS_COLOR_CLS[r.status]),a.Cb(1),a.Nc(" ",r.statusName," ")}}function V(t,e){if(1&t){var i=a.Wb();a.Tb(0),a.Vb(1,"div",1),a.Vb(2,"span"),a.Lc(3,"I"),a.Ub(),a.Lc(4,"tem Master Data - List "),a.Vb(5,"div",2),a.Jc(6,p,4,0,"button",3),a.Vb(7,"button",4),a.Qb(8,"i",5),a.Vb(9,"span"),a.Lc(10,"Add Item"),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(11,"div",6),a.Vb(12,"div",7),a.Vb(13,"div",8),a.Vb(14,"div",9),a.Vb(15,"p-table",10,11),a.dc("onLazyLoad",(function(t){return a.Dc(i),a.hc().getListing(t)})),a.Jc(17,g,8,1,"ng-template",12),a.Jc(18,C,39,16,"ng-template",13),a.Jc(19,U,18,9,"ng-template",14),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Sb()}if(2&t){var r=a.hc();a.Cb(6),a.oc("ngIf",r.screenAcl.download),a.Cb(9),a.oc("value",r.listing.data)("lazy",!0)("paginator",!0)("rows",r.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",r.listing.totalRecords)}}var F,D=((F=function(){function t(e,i,r,a,o,s,c){_classCallCheck(this,t),this.utilsService=e,this.storageService=i,this.authGuardService=r,this.commonDataService=a,this.itemDataService=o,this.branchUtilsService=s,this.popupExternalService=c,this.appConstants=n.h,this.screenAcl={},this.itemGroupList=[],this.statusList=[],this.listingProperties={},this.listing={data:[],totalRecords:0},this.searchForm={sapId:"",itemName:"",itemGroupId:"",status:"1",stock:""}}return _createClass(t,[{key:"ngOnInit",value:function(){if(this.screenAcl=this.authGuardService.getScreenAcl("15"),!this.screenAcl.view)return this.utilsService.showFailureMsg(n.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.getAutoSuggestionList("getCommonStatusList"),this.getAutoSuggestionList("getItemGroupList")}},{key:"getListing",value:function(t){var e=this,i=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.listingProperties=i,this.itemDataService.getList(i).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"clearSearchForm",value:function(){this.searchForm={sapId:"",itemName:"",itemGroupId:"",status:"1",stock:""},this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"getAutoSuggestionList",value:function(t){var e=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(i){if("SUCCESS"===i.status){var r="";"getItemGroupList"===t?r="itemGroupList":"getCommonStatusList"===t&&(r="statusList"),e[r]=i.results}else e.utilsService.showFailureMsg(i)}))}},{key:"downloadAsExcel",value:function(){var t=this;this.itemDataService.downloadAsExcel(this.listingProperties).subscribe((function(e){"SUCCESS"===e.status?t.utilsService.externalRedirect(e.fileUrl):t.utilsService.showFailureMsg(e)}))}}]),t}()).\u0275fac=function(t){return new(t||F)(a.Pb(n.g),a.Pb(n.f),a.Pb(n.a),a.Pb(o.l),a.Pb(o.B),a.Pb(s.a),a.Pb(c.a))},F.\u0275cmp=a.Jb({type:F,selectors:[["app-item-list"]],viewQuery:function(t,e){var i;1&t&&a.Pc(h,!0),2&t&&a.zc(i=a.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],["class","btn btn-success btn-sm",3,"click",4,"ngIf"],["routerLink","/branch/inventory/item-add",1,"btn","btn-primary","btn-sm"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa","fa-file-excel"],[2,"width","80px"],["style","width:90px",4,"ngIf"],[2,"width","100px"],[2,"width","200px"],[2,"width","120px"],[2,"width","90px"],[3,"pSortableColumn",4,"ngIf"],[3,"pSortableColumn"],[3,"field"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"routerLink"],[1,"fa","fa-edit"],["height","20px",3,"src"],[1,"link",3,"click"],[1,"badge",3,"ngClass"]],template:function(t,e){1&t&&a.Jc(0,V,20,6,"ng-container",0),2&t&&a.oc("ngIf",e.screenAcl.view)},directives:[u.m,r.e,b.c,l.b,b.b,b.a,m.a,d.b,d.m,d.o,d.t,d.p,d.v,u.l,r.g,u.k],styles:[""]}),F),N=i("LvDl"),E=i("w9rb"),k=i("K3ix"),T=i("ZOsW");function A(t,e){1&t&&(a.Tb(0),a.Lc(1,"Add"),a.Sb())}function P(t,e){1&t&&(a.Tb(0),a.Lc(1,"Edit"),a.Sb())}function w(t,e){if(1&t&&(a.Vb(0,"div",61),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.documentNumberingId?i.myFormErrors1.documentNumberingId:i.myFormErrors1.documentNumber," ")}}function x(t,e){if(1&t&&(a.Vb(0,"div",61),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.itemCode," ")}}function M(t,e){if(1&t&&(a.Vb(0,"div",61),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.itemName," ")}}function W(t,e){if(1&t&&(a.Vb(0,"option",62),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Mc(i.groupName)}}function B(t,e){if(1&t&&(a.Vb(0,"div",61),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.itemGroupId," ")}}function O(t,e){if(1&t&&(a.Vb(0,"option",62),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Mc(i.uomName)}}function Q(t,e){if(1&t&&(a.Vb(0,"div",61),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.uomId," ")}}function J(t,e){if(1&t&&(a.Vb(0,"div",61),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.priceListId," ")}}function R(t,e){if(1&t&&(a.Vb(0,"div",61),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.unitPrice," ")}}var K=function(){return{standalone:!0}};function q(t,e){if(1&t){var i=a.Wb();a.Tb(0),a.Vb(1,"label",63),a.Vb(2,"input",64),a.dc("ngModelChange",(function(t){return a.Dc(i),e.$implicit.flag=t})),a.Ub(),a.Qb(3,"span",65),a.Lc(4),a.Ub(),a.Lc(5,"\xa0\xa0 "),a.Sb()}if(2&t){var r=e.$implicit;a.Cb(2),a.oc("ngModel",r.flag)("ngModelOptions",a.rc(3,K)),a.Cb(2),a.Nc("",r.name," ")}}function _(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.manufacturerName,"\xa0"),a.Cb(2),a.Nc("(",i.manufacturerCode,")")}}function G(t,e){if(1&t&&(a.Vb(0,"option",62),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Nc(" ",i.name," ")}}function z(t,e){if(1&t&&(a.Vb(0,"div",61),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.status," ")}}function j(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.warehouseName,"\xa0"),a.Cb(2),a.Nc("(",i.warehouseCode,")")}}function $(t,e){if(1&t&&(a.Vb(0,"div",61),a.Lc(1),a.Ub()),2&t){var i=a.hc().index,r=a.hc();a.Cb(1),a.Nc(" ",r.myFormErrors1.warehouseListArray[i].warehouseId," ")}}function H(t,e){if(1&t&&(a.Vb(0,"div",61),a.Lc(1),a.Ub()),2&t){var i=a.hc().index,r=a.hc();a.Cb(1),a.Nc(" ",r.myFormErrors1.warehouseListArray[i].binId," ")}}function Y(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr",66),a.Vb(1,"td"),a.Vb(2,"a",67),a.dc("click",(function(){a.Dc(i);var t=e.index;return a.hc().removeWarehouseFields(t)})),a.Qb(3,"i",68),a.Ub(),a.Ub(),a.Vb(4,"td"),a.Vb(5,"ng-select",69),a.dc("change",(function(){a.Dc(i);var t=e.index;return a.hc().setBinList(t)})),a.Jc(6,j,4,2,"ng-template",44),a.Ub(),a.Jc(7,$,2,1,"div",25),a.Ub(),a.Vb(8,"td"),a.Qb(9,"ng-select",70),a.Jc(10,H,2,1,"div",25),a.Ub(),a.Ub()}if(2&t){var r=e.index,n=a.hc();a.oc("formGroupName",r),a.Cb(5),a.oc("items",n.warehouseList)("multiple",!1),a.Cb(2),a.oc("ngIf",n.myFormErrors1.warehouseListArray[r].warehouseId),a.Cb(2),a.oc("items",n.myForm1Data.warehouseListArray[r].binList)("multiple",!1),a.Cb(1),a.oc("ngIf",n.myFormErrors1.warehouseListArray[r].binId)}}function Z(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",71),a.dc("click",(function(){return a.Dc(i),a.hc().saveUpdate()})),a.Qb(1,"i",72),a.Vb(2,"span"),a.Lc(3,"Save"),a.Ub(),a.Ub()}}function X(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",3),a.dc("click",(function(){return a.Dc(i),a.hc().clearForm()})),a.Qb(1,"i",73),a.Vb(2,"span"),a.Lc(3,"Clear"),a.Ub(),a.Ub()}}function tt(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",71),a.dc("click",(function(){return a.Dc(i),a.hc().saveUpdate()})),a.Qb(1,"i",74),a.Vb(2,"span"),a.Lc(3,"Update"),a.Ub(),a.Ub()}}function et(t,e){1&t&&(a.Vb(0,"button",75),a.Qb(1,"i",76),a.Vb(2,"span"),a.Lc(3,"Cancel"),a.Ub(),a.Ub())}function it(t,e){1&t&&(a.Vb(0,"div",79),a.Vb(1,"span",80),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," You are unauthorized to "),a.Vb(4,"strong"),a.Lc(5,"update"),a.Ub(),a.Lc(6," this transaction! "),a.Ub())}function rt(t,e){if(1&t&&(a.Vb(0,"div",77),a.Vb(1,"div"),a.Vb(2,"strong"),a.Lc(3,"Created By:"),a.Ub(),a.Lc(4),a.Ub(),a.Jc(5,it,7,0,"div",78),a.Ub()),2&t){var i=a.hc();a.Cb(4),a.Nc(" ",i.editCreatedName,""),a.Cb(1),a.oc("ngIf",!i.screenAcl.update)}}function nt(t,e){1&t&&(a.Vb(0,"div",77),a.Vb(1,"span",80),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," You are unauthorized to "),a.Vb(4,"strong"),a.Lc(5,"add"),a.Ub(),a.Lc(6," this transaction!. "),a.Ub())}var at,ot=((at=function(){function t(e,i,r,a,o,s,c,u,b,l){_classCallCheck(this,t),this.utilsService=e,this.storageService=i,this.authGuardService=r,this.activatedRoute=a,this.commonDataService=o,this.itemDataService=s,this.branchUtilsService=c,this.formBuilder=u,this.popupExternalService=b,this.modalService=l,this.appConstants=n.h,this.screenAcl={},this.documentNumberingList=[],this.itemGroupList=[],this.uomList=[],this.itemTypeList=[],this.manufacturerList=[],this.hsnList=[],this.statusList=[],this.warehouseList=[],this.photoUrl="",this.priceList=[],this.myForm1Data={},this.myFormErrors1={documentNumberingId:"",documentNumber:"",itemCode:"",itemName:"",itemGroupId:"",uomId:"",unitPrice:"",itemWeight:"",priceListId:"",status:"",warehouseListArray:[]},this.myFormValidationMsgs1={documentNumberingId:{required:"Document No is required"},documentNumber:{required:"Document No is required"},itemCode:{required:"Item code is required"},itemName:{required:"Item name is required"},itemGroupId:{required:"Item group is required"},uomId:{required:"UOM is required"},priceListId:{required:"Price List is required"},unitPrice:{required:"Unit price is required",pattern:"Only positive numbers are allowed"},status:{required:"Status is required"},warehouseListArray:{warehouseId:{required:"WareHouse is required"},binId:{required:"Bin is required"}}}}return _createClass(t,[{key:"ngOnInit",value:function(){if(this.screenAcl=this.authGuardService.getScreenAcl("15"),!this.screenAcl.view)return this.utilsService.showFailureMsg(n.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.initializeForm1(),this.initializeSubscriptions(),this.getAutoSuggestionList("getCommonStatusList")}},{key:"ngAfterViewInit",value:function(){this.attachmentsComponent.loadAttachments(this.inputEditId)}},{key:"initializeSubscriptions",value:function(){var t=this;this.activatedRoute.params.subscribe((function(e){e.id?(t.inputEditId=t.utilsService.decrypt(e.id),t.get()):(t.branchUtilsService.getMasterDocumentNumbering(t.myForm1,t.branchUtilsService.screenAttributes.masterItem.documentTypeId).subscribe((function(e){t.documentNumberingList=e})),t.getAutoSuggestionList("getItemGroupList"),t.getAutoSuggestionList("getUomList"),t.getAutoSuggestionList("getManufacturerList"),t.getAutoSuggestionList("getHsnList"),t.getAutoSuggestionList("getPriceList"),t.getItemTxnTypeList(),t.getWarehouseList())})),this.branchUtilsService.actionSaveUpdate.subscribe((function(e){"item-group"===e.triggerType?t.getAutoSuggestionList("getItemGroupList"):"uom"===e.triggerType?t.getAutoSuggestionList("getUomList"):"hsn"===e.triggerType&&t.getAutoSuggestionList("getHsnList")}))}},{key:"initializeForm1",value:function(){var t=this;this.myForm1=this.formBuilder.group({itemImage:[""],documentNumberingId:[null,[d.u.required]],documentNumber:["",[d.u.required]],documentNumberingType:[""],itemCode:["",[d.u.required]],itemName:["",[d.u.required]],foreignName:[""],stock:[{value:0,disabled:!0}],itemGroupId:["",[d.u.required]],uomId:["",[d.u.required]],unitPrice:["",[d.u.required,d.u.pattern(n.h.VALIDATION_PATTERNS.positiveFloatNumber)]],priceListId:[null,[d.u.required]],itemWeight:[""],manufacturerId:[null],hsnId:[null],remarks:[""],status:["1",[d.u.required]],deletedWarehouseChildIds:[[]],warehouseListArray:this.formBuilder.array([this.initWarehouseFields()])}),this.myForm1.valueChanges.subscribe((function(e){t.utilsService.validation(t.myForm1,t.myFormErrors1,t.myFormValidationMsgs1),t.myForm1Data=t.myForm1.getRawValue()})),this.myForm1Data=this.myForm1.getRawValue(),this.removeWarehouseFields(0)}},{key:"addWarehouseFields",value:function(t){this.myForm1.controls.warehouseListArray.push(this.initWarehouseFields(t))}},{key:"initWarehouseFields",value:function(t){this.myFormErrors1.warehouseListArray.push({warehouseId:"",binId:""});var e={warehouseId:[null,[d.u.required]],binId:[null,[d.u.required]],binList:[[]],id:[""]};return t&&(this.utilsService.updateObject(e,"warehouseId",t.warehouseId),this.utilsService.updateObject(e,"binId",t.binId),this.utilsService.updateObject(e,"id",t.id)),this.formBuilder.group(e)}},{key:"removeWarehouseFields",value:function(t){var e=this.myForm1Data.warehouseListArray[t].id;if(e){var i=this.myForm1Data.deletedWarehouseChildIds;i.push(e),this.myForm1.patchValue({deletedWarehouseChildIds:i})}this.myForm1.controls.warehouseListArray.removeAt(t)}},{key:"saveUpdate",value:function(){var t=this;if(this.checkMultipleSameWarehouse())return!1;if(!this.myForm1.valid)return this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1,!0),!1;var e,i=this.itemTypeList.filter((function(t){return t.flag})).map((function(t){return t.id})),r={itemImage:this.myForm1Data.itemImage,documentNumberingId:this.myForm1Data.documentNumberingId,documentNumber:this.myForm1Data.documentNumber,documentNumberingType:this.myForm1Data.documentNumberingType,itemCode:this.myForm1Data.itemCode,itemName:this.myForm1Data.itemName,foreignName:this.myForm1Data.foreignName,stock:this.myForm1Data.stock,itemGroupId:this.myForm1Data.itemGroupId,uomId:this.myForm1Data.uomId,unitPrice:this.myForm1Data.unitPrice,itemWeight:this.myForm1Data.itemWeight,priceListId:this.myForm1Data.priceListId,itemTransactionType:i.join(","),manufacturerId:this.myForm1Data.manufacturerId,hsnId:this.myForm1Data.hsnId,remarks:this.myForm1Data.remarks,status:this.myForm1Data.status,warehouseListArray:[]};this.myForm1Data.warehouseListArray.forEach((function(t){r.warehouseListArray.push({warehouseId:t.warehouseId,binId:t.binId,id:t.id})})),this.inputEditId?(e="update",r.id=this.inputEditId,r.deletedWarehouseChildIds=this.myForm1Data.deletedWarehouseChildIds):e="save",this.itemDataService[e](r).subscribe((function(i){"SUCCESS"===i.status?(t.utilsService.showSuccessMsg(i),t.attachmentsComponent.save("save"===e?i.sId:t.inputEditId)):t.utilsService.showFailureMsg(i)}))}},{key:"get",value:function(){var t=this;this.itemDataService.get(this.inputEditId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results[0];t.photoUrl=i.itemImgUrl;var r={};t.utilsService.updateObject(r,"documentNumberingId",i.documentNumberingId),t.utilsService.updateObject(r,"documentNumber",i.documentNumber),t.utilsService.updateObject(r,"documentNumberingType",i.documentNumberingInfo.length>0?i.documentNumberingInfo[0].documentNumberingType:""),t.utilsService.updateObject(r,"itemImage",i.itemImage),t.utilsService.updateObject(r,"itemCode",i.itemCode),t.utilsService.updateObject(r,"itemName",i.itemName),t.utilsService.updateObject(r,"foreignName",i.foreignName),t.utilsService.updateObject(r,"stock",i.stock),t.utilsService.updateObject(r,"itemGroupId",i.itemGroupId),t.utilsService.updateObject(r,"uomId",i.uomId),t.utilsService.updateObject(r,"unitPrice",i.unitPrice),t.utilsService.updateObject(r,"itemWeight",i.itemWeight),t.utilsService.updateObject(r,"manufacturerId",i.manufacturerId),t.utilsService.updateObject(r,"hsnId",i.hsnId),t.utilsService.updateObject(r,"remarks",i.remarks),t.utilsService.updateObject(r,"status",i.status),t.utilsService.updateObject(r,"priceListId",i.lastPriceListId),t.myForm1.patchValue(r),t.branchUtilsService.getMasterDocumentNumbering(t.myForm1,t.branchUtilsService.screenAttributes.masterItem.documentTypeId,"edit",i.documentNumberingInfo).subscribe((function(e){t.documentNumberingList=e})),t.getAutoSuggestionList("getItemGroupList",i.itemGroupInfo),t.getAutoSuggestionList("getUomList",i.uomInfo),t.getAutoSuggestionList("getManufacturerList",i.manufacturerInfo),t.getAutoSuggestionList("getHsnList",i.hsnInfo),t.getAutoSuggestionList("getPriceList",i.priceListInfo),t.getItemTxnTypeList(!0,i);var n=[];i.warehouseListArray.forEach((function(e,i){t.addWarehouseFields(e),e.warehouseInfo[0]&&n.push(e.warehouseInfo[0])})),t.getWarehouseList(!0,n,i),t.myForm1.controls.itemCode.disable(),t.myForm1.controls.documentNumberingId.disable(),t.myForm1.controls.documentNumber.disable(),t.editCreatedName=i.createdByInfo[0].employeeName}else t.utilsService.showFailureMsg(e)}))}},{key:"clearForm",value:function(){this.initializeForm1()}},{key:"uploadImage",value:function(t){var e=this;this.itemDataService.imageUpload(t.target.files||t.srcElement.files).subscribe((function(t){"SUCCESS"===t.status?(e.myForm1.patchValue({itemImage:t.results.fileName}),e.photoUrl=t.results.fullUrl):e.utilsService.showFailureMsg(t)}))}},{key:"checkMultipleSameWarehouse",value:function(){var t=new Set;return this.myForm1Data.warehouseListArray.forEach((function(e){t.add(e.warehouseId)})),this.myForm1Data.warehouseListArray.length!==t.size&&(this.utilsService.showFailureMsg("Not allowed to select duplicate warehouse!"),!0)}},{key:"onItemPriceChange",value:function(){var t=this;this.myForm1Data.priceListId&&this.inputEditId&&this.commonDataService.getItemPriceValue({itemId:this.inputEditId,priceListId:this.myForm1Data.priceListId,type:"MASTERITEM"}).subscribe((function(e){"SUCCESS"===e.status?t.myForm1.patchValue({unitPrice:e.results.unitPrice}):t.utilsService.showFailureMsg(e)}))}},{key:"redirectToList",value:function(){this.utilsService.redirect("/branch/inventory/item-list")}},{key:"getAutoSuggestionList",value:function(t,e){var i=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(r){"SUCCESS"===r.status?(i.utilsService.ifNotPushToList(r.results,e),"getItemGroupList"===t?i.itemGroupList=r.results:"getUomList"===t?i.uomList=r.results:"getManufacturerList"===t?i.manufacturerList=r.results.map((function(t){return t.searchText=t.manufacturerName+" - "+t.manufacturerCode,t})):"getHsnList"===t?i.hsnList=r.results:"getCommonStatusList"===t?i.statusList=r.results:"getPriceList"===t&&(i.priceList=r.results)):i.utilsService.showFailureMsg(r)}))}},{key:"getItemTxnTypeList",value:function(t,e){var i=this;this.commonDataService.getAutoSuggestionList("getItemTransactionTypeList").subscribe((function(r){"SUCCESS"===r.status?i.itemTypeList=r.results.map((function(r){if(t){if(!i.utilsService.isEmpty(e.itemTransactionType)){var n=e.itemTransactionType.split(",");r.flag=n.indexOf(r.id)>=0}}else r.flag=!0;return r})):i.utilsService.showFailureMsg(r)}))}},{key:"getWarehouseList",value:function(t,e,i){var r=this;this.commonDataService.getAutoSuggestionList("getWarehouseList").subscribe((function(n){"SUCCESS"===n.status?(r.warehouseList=n.results.map((function(t){return t.searchText=t.warehouseName+" - "+t.warehouseCode,t})),t&&(r.utilsService.ifNotPushToList(n.results,e),i.warehouseListArray.forEach((function(t,e){r.setBinList(e,!0,t.binInfo)})))):r.utilsService.showFailureMsg(n)}))}},{key:"setBinList",value:function(t,e,i){var r=this.myForm1.controls.warehouseListArray.at(t),n=this.myForm1Data.warehouseListArray[t].warehouseId;if(r.patchValue({binList:[]}),e||r.patchValue({binId:null}),!this.utilsService.isEmpty(n)){var a=N.findIndex(this.warehouseList,{id:n});r.patchValue({binList:this.warehouseList[a].binList}),e&&this.utilsService.ifNotPushToList(r.controls.binList.value,i)}}},{key:"onKeydownHandler",value:function(t){t.ctrlKey&&"s"===t.key.toLowerCase()&&(this.saveUpdate(),t.preventDefault())}}]),t}()).\u0275fac=function(t){return new(t||at)(a.Pb(n.g),a.Pb(n.f),a.Pb(n.a),a.Pb(r.a),a.Pb(o.l),a.Pb(o.B),a.Pb(s.a),a.Pb(d.e),a.Pb(c.a),a.Pb(k.b))},at.\u0275cmp=a.Jb({type:at,selectors:[["app-item-add"]],viewQuery:function(t,e){var i;1&t&&a.Pc(E.a,!0),2&t&&a.zc(i=a.ec())&&(e.attachmentsComponent=i.first)},hostBindings:function(t,e){1&t&&a.dc("keydown",(function(t){return e.onKeydownHandler(t)}),!1,a.Bc)},decls:180,vars:30,consts:[[1,"page-title"],[4,"ngIf"],[1,"btn-group"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-arrow-left"],[1,"working-container",3,"formGroup"],[1,"box"],[1,"box-header"],[1,"fa","fa-angle-right"],[1,"box-body","box-form"],[1,"row"],[1,"col-sm-3"],[1,"form-group"],[1,"form-label"],[1,"image-container"],[3,"src"],["type","file",3,"change"],["type","hidden","formControlName","itemImage"],[1,"small-text"],[1,"col-sm-9"],[1,"form-group","col-sm-4"],[1,"mandatory"],[1,"col-sm-6"],["formControlName","documentNumberingId","bindLabel","documentNumberingName","bindValue","id","placeholder","--SELECT--",3,"items","change"],["type","text","formControlName","documentNumber",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],["type","text","formControlName","itemCode",1,"form-control","form-control-sm"],["type","text","formControlName","itemName",1,"form-control","form-control-sm"],["type","text","formControlName","foreignName",1,"form-control","form-control-sm"],["type","text","formControlName","stock",1,"form-control","form-control-sm"],[1,"action-control"],["formControlName","itemGroupId",1,"form-control","form-control-sm"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"click"],[1,"fa","fa-plus"],["formControlName","uomId",1,"form-control","form-control-sm"],["formControlName","priceListId","bindLabel","priceListName","bindValue","id","placeholder","--SELECT--",3,"items","change"],["type","text","formControlName","unitPrice",1,"form-control","form-control-sm"],["type","number","formControlName","itemWeight",1,"form-control","form-control-sm"],[1,"form-group","col-sm-auto"],[4,"ngFor","ngForOf"],[1,"form-group","col-sm-3"],["formControlName","manufacturerId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["ng-option-tmp",""],["formControlName","hsnId","bindLabel","hsnCode","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["formControlName","remarks",1,"form-control","form-control-sm"],["formControlName","status",1,"form-control","form-control-sm"],[1,"box-body","box-table"],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],["formArrayName","warehouseListArray"],[3,"formGroupName",4,"ngFor","ngForOf"],["colspan","3"],[1,"btn","btn-success","btn-sm",3,"click"],[3,"type","doSuccess"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm","routerLink","/branch/inventory/item-list",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],[1,"validation-error"],[3,"value"],[1,"checkbox"],["type","checkbox",3,"ngModel","ngModelOptions","ngModelChange"],[1,"checkmark"],[3,"formGroupName"],["placement","top","container","body","tooltip","Delete",1,"action","red",3,"click"],[1,"fa","fa-minus-circle"],["formControlName","warehouseId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple","change"],["formControlName","binId","bindLabel","binName","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"fa","fa-broom"],[1,"fa","fa-redo-alt"],["routerLink","/branch/inventory/item-list",1,"btn","btn-secondary","btn-sm"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],["class","mt-2",4,"ngIf"],[1,"mt-2"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(a.Vb(0,"div",0),a.Vb(1,"span"),a.Lc(2,"I"),a.Ub(),a.Lc(3,"tem Master Data - "),a.Jc(4,A,2,0,"ng-container",1),a.Jc(5,P,2,0,"ng-container",1),a.Vb(6,"div",2),a.Vb(7,"button",3),a.dc("click",(function(){return e.utilsService.goBack()})),a.Qb(8,"i",4),a.Vb(9,"span"),a.Lc(10,"Back"),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(11,"div",5),a.Vb(12,"div",6),a.Vb(13,"div",7),a.Qb(14,"i",8),a.Lc(15,"Item Info "),a.Ub(),a.Vb(16,"div",9),a.Vb(17,"div",10),a.Vb(18,"div",11),a.Vb(19,"div",12),a.Vb(20,"label",13),a.Lc(21,"Item Image"),a.Ub(),a.Vb(22,"div",14),a.Qb(23,"img",15),a.Ub(),a.Vb(24,"input",16),a.dc("change",(function(t){return e.uploadImage(t)})),a.Ub(),a.Qb(25,"input",17),a.Vb(26,"div",18),a.Lc(27,"Only jpg, png are allowed. Maximum 2 Mb"),a.Ub(),a.Ub(),a.Ub(),a.Vb(28,"div",19),a.Vb(29,"div",10),a.Vb(30,"div",20),a.Vb(31,"label",13),a.Lc(32,"Doc No"),a.Vb(33,"span",21),a.Lc(34,"*"),a.Ub(),a.Ub(),a.Vb(35,"div",10),a.Vb(36,"div",22),a.Vb(37,"ng-select",23),a.dc("change",(function(){return e.branchUtilsService.onDocumentNumberingChange(e.documentNumberingList,e.myForm1)})),a.Ub(),a.Ub(),a.Vb(38,"div",22),a.Qb(39,"input",24),a.Ub(),a.Ub(),a.Jc(40,w,2,1,"div",25),a.Ub(),a.Vb(41,"div",20),a.Vb(42,"label",13),a.Lc(43,"Item Code"),a.Vb(44,"span",21),a.Lc(45,"*"),a.Ub(),a.Ub(),a.Qb(46,"input",26),a.Jc(47,x,2,1,"div",25),a.Ub(),a.Vb(48,"div",20),a.Vb(49,"label",13),a.Lc(50,"Item Name"),a.Vb(51,"span",21),a.Lc(52,"*"),a.Ub(),a.Ub(),a.Qb(53,"input",27),a.Jc(54,M,2,1,"div",25),a.Ub(),a.Vb(55,"div",20),a.Vb(56,"label",13),a.Lc(57,"Foreign Name"),a.Ub(),a.Qb(58,"input",28),a.Ub(),a.Vb(59,"div",20),a.Vb(60,"label",13),a.Lc(61,"Stock"),a.Ub(),a.Qb(62,"input",29),a.Ub(),a.Vb(63,"div",20),a.Vb(64,"label",13),a.Lc(65,"Item Group"),a.Vb(66,"span",21),a.Lc(67,"*"),a.Ub(),a.Ub(),a.Vb(68,"div",30),a.Vb(69,"select",31),a.Vb(70,"option",32),a.Lc(71,"--SELECT--"),a.Ub(),a.Jc(72,W,2,2,"option",33),a.Ub(),a.Vb(73,"span"),a.Vb(74,"a",34),a.dc("click",(function(){return e.popupExternalService.showAddPopup("item-group")})),a.Qb(75,"i",35),a.Ub(),a.Ub(),a.Ub(),a.Jc(76,B,2,1,"div",25),a.Ub(),a.Vb(77,"div",20),a.Vb(78,"label",13),a.Lc(79,"UOM"),a.Vb(80,"span",18),a.Lc(81,"(Unit of Measure)"),a.Ub(),a.Vb(82,"span",21),a.Lc(83,"*"),a.Ub(),a.Ub(),a.Vb(84,"div",30),a.Vb(85,"select",36),a.Vb(86,"option",32),a.Lc(87,"--SELECT--"),a.Ub(),a.Jc(88,O,2,2,"option",33),a.Ub(),a.Vb(89,"a",34),a.dc("click",(function(){return e.popupExternalService.showAddPopup("uom")})),a.Qb(90,"i",35),a.Ub(),a.Ub(),a.Jc(91,Q,2,1,"div",25),a.Ub(),a.Vb(92,"div",20),a.Vb(93,"label",13),a.Lc(94,"Price List"),a.Vb(95,"span",21),a.Lc(96,"*"),a.Ub(),a.Ub(),a.Vb(97,"ng-select",37),a.dc("change",(function(){return e.onItemPriceChange()})),a.Ub(),a.Jc(98,J,2,1,"div",25),a.Ub(),a.Vb(99,"div",20),a.Vb(100,"label",13),a.Lc(101,"Unit Price"),a.Vb(102,"span",21),a.Lc(103,"*"),a.Ub(),a.Ub(),a.Qb(104,"input",38),a.Jc(105,R,2,1,"div",25),a.Ub(),a.Vb(106,"div",20),a.Vb(107,"label",13),a.Lc(108,"Item Weight (Kg)"),a.Ub(),a.Qb(109,"input",39),a.Ub(),a.Vb(110,"div",40),a.Qb(111,"label",13),a.Jc(112,q,6,4,"ng-container",41),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(113,"div",6),a.Vb(114,"div",7),a.Qb(115,"i",8),a.Lc(116,"General Info "),a.Ub(),a.Vb(117,"div",9),a.Vb(118,"div",10),a.Vb(119,"div",42),a.Vb(120,"label",13),a.Lc(121,"Manufacturer"),a.Ub(),a.Vb(122,"ng-select",43),a.Jc(123,_,4,2,"ng-template",44),a.Ub(),a.Ub(),a.Vb(124,"div",42),a.Vb(125,"label",13),a.Lc(126,"HSN"),a.Ub(),a.Vb(127,"div",30),a.Qb(128,"ng-select",45),a.Vb(129,"span"),a.Vb(130,"a",34),a.dc("click",(function(){return e.popupExternalService.showAddPopup("hsn")})),a.Qb(131,"i",35),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(132,"div",42),a.Vb(133,"label",13),a.Lc(134,"Remarks"),a.Ub(),a.Qb(135,"textarea",46),a.Ub(),a.Vb(136,"div",42),a.Vb(137,"label",13),a.Lc(138,"Status"),a.Vb(139,"span",21),a.Lc(140,"*"),a.Ub(),a.Ub(),a.Vb(141,"select",47),a.Jc(142,G,2,2,"option",33),a.Ub(),a.Jc(143,z,2,1,"div",25),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(144,"div",6),a.Vb(145,"div",7),a.Qb(146,"i",8),a.Lc(147,"Warehouse Info "),a.Ub(),a.Vb(148,"div",48),a.Vb(149,"div",49),a.Vb(150,"table",50),a.Vb(151,"thead"),a.Vb(152,"tr"),a.Vb(153,"th"),a.Lc(154,"Action"),a.Ub(),a.Vb(155,"th"),a.Lc(156,"Warehouse"),a.Vb(157,"span",21),a.Lc(158,"*"),a.Ub(),a.Ub(),a.Vb(159,"th"),a.Lc(160,"Bin Location"),a.Vb(161,"span",21),a.Lc(162,"*"),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(163,"tbody",51),a.Jc(164,Y,11,7,"tr",52),a.Ub(),a.Vb(165,"tfoot"),a.Vb(166,"tr"),a.Vb(167,"td",53),a.Vb(168,"button",54),a.dc("click",(function(){return e.addWarehouseFields()})),a.Qb(169,"i",35),a.Vb(170,"span"),a.Lc(171,"Add"),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(172,"app-attachments",55),a.dc("doSuccess",(function(){return e.redirectToList()})),a.Ub(),a.Vb(173,"div",56),a.Jc(174,Z,4,0,"button",57),a.Jc(175,X,4,0,"button",58),a.Jc(176,tt,4,0,"button",57),a.Jc(177,et,4,0,"button",59),a.Ub(),a.Jc(178,rt,6,2,"div",60),a.Jc(179,nt,7,0,"div",60),a.Ub()),2&t&&(a.Cb(4),a.oc("ngIf",!e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId),a.Cb(6),a.oc("formGroup",e.myForm1),a.Cb(12),a.oc("src",e.photoUrl?e.photoUrl:e.appConstants.DEFAULT_IMAGE_ICON,a.Fc),a.Cb(14),a.oc("items",e.documentNumberingList),a.Cb(3),a.oc("ngIf",e.myFormErrors1.documentNumberingId||e.myFormErrors1.documentNumber),a.Cb(7),a.oc("ngIf",e.myFormErrors1.itemCode),a.Cb(7),a.oc("ngIf",e.myFormErrors1.itemName),a.Cb(18),a.oc("ngForOf",e.itemGroupList),a.Cb(4),a.oc("ngIf",e.myFormErrors1.itemGroupId),a.Cb(12),a.oc("ngForOf",e.uomList),a.Cb(3),a.oc("ngIf",e.myFormErrors1.uomId),a.Cb(6),a.oc("items",e.priceList),a.Cb(1),a.oc("ngIf",e.myFormErrors1.priceListId),a.Cb(7),a.oc("ngIf",e.myFormErrors1.unitPrice),a.Cb(7),a.oc("ngForOf",e.itemTypeList),a.Cb(10),a.oc("items",e.manufacturerList)("multiple",!1),a.Cb(6),a.oc("items",e.hsnList)("multiple",!1),a.Cb(14),a.oc("ngForOf",e.statusList),a.Cb(1),a.oc("ngIf",e.myFormErrors1.status),a.Cb(21),a.oc("ngForOf",e.myForm1.controls.warehouseListArray.controls),a.Cb(8),a.oc("type",e.branchUtilsService.screenAttributes.masterItem.backendKey),a.Cb(2),a.oc("ngIf",e.screenAcl.add&&!e.inputEditId),a.Cb(1),a.oc("ngIf",!e.inputEditId),a.Cb(1),a.oc("ngIf",e.screenAcl.update&&e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId),a.Cb(1),a.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[u.m,d.n,d.i,d.b,d.m,d.g,T.a,d.t,d.p,d.v,u.l,d.q,T.c,d.d,E.a,d.a,d.o,d.j,m.a,r.e],styles:[""]}),at);function st(t,e){1&t&&(a.Tb(0),a.Lc(1,"Add"),a.Sb())}function ct(t,e){1&t&&(a.Tb(0),a.Lc(1,"Edit"),a.Sb())}function ut(t,e){if(1&t&&(a.Vb(0,"div",19),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.binCode," ")}}function bt(t,e){if(1&t&&(a.Vb(0,"div",19),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.binName," ")}}function lt(t,e){if(1&t&&(a.Vb(0,"option",20),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Mc(i.name)}}function mt(t,e){if(1&t&&(a.Vb(0,"div",19),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors1.status," ")}}function dt(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",21),a.dc("click",(function(){return a.Dc(i),a.hc().saveUpdate()})),a.Qb(1,"i",22),a.Vb(2,"span"),a.Lc(3,"Save"),a.Ub(),a.Ub()}}function ht(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",23),a.dc("click",(function(){return a.Dc(i),a.hc().clearForm()})),a.Qb(1,"i",24),a.Vb(2,"span"),a.Lc(3,"Clear"),a.Ub(),a.Ub()}}function pt(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",21),a.dc("click",(function(){return a.Dc(i),a.hc().saveUpdate()})),a.Qb(1,"i",25),a.Vb(2,"span"),a.Lc(3,"Update"),a.Ub(),a.Ub()}}function ft(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",23),a.dc("click",(function(){return a.Dc(i),a.hc().activeModal.hide()})),a.Qb(1,"i",26),a.Vb(2,"span"),a.Lc(3,"Cancel"),a.Ub(),a.Ub()}}function gt(t,e){1&t&&(a.Vb(0,"div",27),a.Vb(1,"span",28),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," You are unauthorized to "),a.Vb(4,"strong"),a.Lc(5,"update"),a.Ub(),a.Lc(6," this transaction! "),a.Ub())}function vt(t,e){1&t&&(a.Vb(0,"div",27),a.Vb(1,"span",28),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," You are unauthorized to "),a.Vb(4,"strong"),a.Lc(5,"add"),a.Ub(),a.Lc(6," this transaction!. "),a.Ub())}var yt,Lt=((yt=function(){function t(e,i,r,n,a,o,s){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.commonDataService=r,this.binDataService=n,this.branchUtilsService=a,this.activeModal=o,this.formBuilder=s,this.screenAcl={},this.statusList=[],this.myForm1Data={},this.myFormErrors1={binCode:"",binName:"",status:""},this.myFormValidationMsgs1={binCode:{required:"Code is required"},binName:{required:"Name is required"},status:{required:"Status is required"}}}return _createClass(t,[{key:"ngOnInit",value:function(){this.screenAcl=this.authGuardService.getScreenAcl("27"),this.initializeForm1(),this.getAutoSuggestionList("getCommonStatusList"),this.inputEditId&&this.get()}},{key:"initializeForm1",value:function(){var t=this;this.myForm1=this.formBuilder.group({binCode:["",[d.u.required]],binName:["",[d.u.required]],status:["1",[d.u.required]]}),this.myForm1.valueChanges.subscribe((function(e){t.utilsService.validation(t.myForm1,t.myFormErrors1,t.myFormValidationMsgs1),t.myForm1Data=t.myForm1.getRawValue()})),this.myForm1Data=this.myForm1.getRawValue()}},{key:"saveUpdate",value:function(){var t=this;if(!this.myForm1.valid)return this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1,!0),!1;var e,i={binCode:this.myForm1Data.binCode,binName:this.myForm1Data.binName,status:this.myForm1Data.status};this.inputEditId?(e="update",i.id=this.inputEditId):e="save",this.binDataService[e](i).subscribe((function(e){"SUCCESS"===e.status?(t.utilsService.showSuccessMsg(e),t.branchUtilsService.actionSaveUpdate.next({triggerType:"bin-location"}),t.activeModal.hide()):t.utilsService.showFailureMsg(e)}))}},{key:"get",value:function(){var t=this;this.binDataService.get(this.inputEditId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results[0];t.myForm1.patchValue({binCode:i.binCode,binName:i.binName,status:i.status})}else t.utilsService.showFailureMsg(e)}))}},{key:"clearForm",value:function(){this.initializeForm1()}},{key:"getAutoSuggestionList",value:function(t){var e=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(i){"SUCCESS"===i.status?"getCommonStatusList"===t&&(e.statusList=i.results):e.utilsService.showFailureMsg(i)}))}}]),t}()).\u0275fac=function(t){return new(t||yt)(a.Pb(n.g),a.Pb(n.a),a.Pb(o.l),a.Pb(o.i),a.Pb(s.a),a.Pb(k.a),a.Pb(d.e))},yt.\u0275cmp=a.Jb({type:yt,selectors:[["app-bin-add-popup"]],decls:40,vars:13,consts:[[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],[1,"close",3,"click"],[1,"modal-body"],[1,"row",3,"formGroup"],[1,"form-group","col-sm-6"],[1,"form-label"],[1,"mandatory"],["type","text","formControlName","binCode",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],["type","text","formControlName","binName",1,"form-control","form-control-sm"],["formControlName","status",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],[1,"validation-error"],[3,"value"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-broom"],[1,"fa","fa-sync"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(a.Vb(0,"div",0),a.Vb(1,"h5",1),a.Lc(2," Bin Location Master Data - "),a.Jc(3,st,2,0,"ng-container",2),a.Jc(4,ct,2,0,"ng-container",2),a.Ub(),a.Vb(5,"button",3),a.dc("click",(function(){return e.activeModal.hide()})),a.Vb(6,"span"),a.Lc(7,"\xd7"),a.Ub(),a.Ub(),a.Ub(),a.Vb(8,"div",4),a.Vb(9,"div",5),a.Vb(10,"div",6),a.Vb(11,"label",7),a.Lc(12,"Code"),a.Vb(13,"span",8),a.Lc(14,"*"),a.Ub(),a.Ub(),a.Qb(15,"input",9),a.Jc(16,ut,2,1,"div",10),a.Ub(),a.Vb(17,"div",6),a.Vb(18,"label",7),a.Lc(19,"Name"),a.Vb(20,"span",8),a.Lc(21,"*"),a.Ub(),a.Ub(),a.Qb(22,"input",11),a.Jc(23,bt,2,1,"div",10),a.Ub(),a.Vb(24,"div",6),a.Vb(25,"label",7),a.Lc(26,"Status"),a.Vb(27,"span",8),a.Lc(28,"*"),a.Ub(),a.Ub(),a.Vb(29,"select",12),a.Jc(30,lt,2,2,"option",13),a.Ub(),a.Jc(31,mt,2,1,"div",10),a.Ub(),a.Ub(),a.Ub(),a.Vb(32,"div",14),a.Vb(33,"div",15),a.Jc(34,dt,4,0,"button",16),a.Jc(35,ht,4,0,"button",17),a.Jc(36,pt,4,0,"button",16),a.Jc(37,ft,4,0,"button",17),a.Ub(),a.Jc(38,gt,7,0,"div",18),a.Jc(39,vt,7,0,"div",18),a.Ub()),2&t&&(a.Cb(3),a.oc("ngIf",!e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId),a.Cb(5),a.oc("formGroup",e.myForm1),a.Cb(7),a.oc("ngIf",e.myFormErrors1.binCode),a.Cb(7),a.oc("ngIf",e.myFormErrors1.binName),a.Cb(7),a.oc("ngForOf",e.statusList),a.Cb(1),a.oc("ngIf",e.myFormErrors1.status),a.Cb(3),a.oc("ngIf",e.screenAcl.add&&!e.inputEditId),a.Cb(1),a.oc("ngIf",!e.inputEditId),a.Cb(1),a.oc("ngIf",e.screenAcl.update&&e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId&&!e.screenAcl.update),a.Cb(1),a.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[u.m,d.n,d.i,d.b,d.m,d.g,d.t,u.l,d.p,d.v],styles:[""]}),yt),St=["dataTable"];function Ct(t,e){1&t&&(a.Vb(0,"colgroup"),a.Qb(1,"col",14),a.Qb(2,"col",15),a.Qb(3,"col",16),a.Qb(4,"col",17),a.Ub())}function It(t,e){if(1&t&&(a.Vb(0,"option",27),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Mc(i.name)}}function Ut(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"th"),a.Lc(2,"Actions"),a.Ub(),a.Vb(3,"th",18),a.Lc(4,"Bin Code"),a.Qb(5,"p-sortIcon",19),a.Ub(),a.Vb(6,"th",18),a.Lc(7,"Bin Name"),a.Qb(8,"p-sortIcon",19),a.Ub(),a.Vb(9,"th",18),a.Lc(10,"Status"),a.Qb(11,"p-sortIcon",19),a.Ub(),a.Ub(),a.Vb(12,"tr",20),a.Vb(13,"th"),a.Vb(14,"a",21),a.dc("click",(function(){return a.Dc(i),a.hc(2).clearSearchForm()})),a.Qb(15,"i",22),a.Lc(16,"Clear"),a.Ub(),a.Ub(),a.Vb(17,"th"),a.Vb(18,"input",23),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.binCode=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(19,"th"),a.Vb(20,"input",23),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.binName=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(21,"th"),a.Vb(22,"select",24),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.status=t}))("change",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Vb(23,"option",25),a.Lc(24,"--SELECT--"),a.Ub(),a.Jc(25,It,2,2,"option",26),a.Ub(),a.Ub(),a.Ub()}if(2&t){var r=a.hc(2);a.Cb(3),a.oc("pSortableColumn","binCode"),a.Cb(2),a.oc("field","binCode"),a.Cb(1),a.oc("pSortableColumn","binName"),a.Cb(2),a.oc("field","binName"),a.Cb(1),a.oc("pSortableColumn","status"),a.Cb(2),a.oc("field","status"),a.Cb(7),a.oc("ngModel",r.searchForm.binCode),a.Cb(2),a.oc("ngModel",r.searchForm.binName),a.Cb(2),a.oc("ngModel",r.searchForm.status),a.Cb(3),a.oc("ngForOf",r.statusList)}}function Vt(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"td"),a.Vb(2,"a",28),a.dc("click",(function(){a.Dc(i);var t=e.$implicit;return a.hc(2).showAddPopup(t.id)})),a.Qb(3,"i",29),a.Ub(),a.Ub(),a.Vb(4,"td"),a.Lc(5),a.Ub(),a.Vb(6,"td"),a.Lc(7),a.Ub(),a.Vb(8,"td"),a.Vb(9,"span",30),a.Lc(10),a.Ub(),a.Ub(),a.Ub()}if(2&t){var r=e.$implicit,n=a.hc(2);a.Cb(5),a.Mc(r.binCode),a.Cb(2),a.Mc(r.binName),a.Cb(2),a.oc("ngClass",n.appConstants.STATUS_COLOR_CLS[r.status]),a.Cb(1),a.Mc(r.statusName)}}function Ft(t,e){if(1&t){var i=a.Wb();a.Tb(0),a.Vb(1,"div",1),a.Vb(2,"span"),a.Lc(3,"B"),a.Ub(),a.Lc(4,"in Location Master Data - List "),a.Vb(5,"div",2),a.Vb(6,"button",3),a.dc("click",(function(){return a.Dc(i),a.hc().showAddPopup()})),a.Qb(7,"i",4),a.Vb(8,"span"),a.Lc(9,"Add Bin Location Master Data"),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(10,"div",5),a.Vb(11,"div",6),a.Vb(12,"div",7),a.Vb(13,"div",8),a.Vb(14,"p-table",9,10),a.dc("onLazyLoad",(function(t){return a.Dc(i),a.hc().getListing(t)})),a.Jc(16,Ct,5,0,"ng-template",11),a.Jc(17,Ut,26,10,"ng-template",12),a.Jc(18,Vt,11,4,"ng-template",13),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Sb()}if(2&t){var r=a.hc();a.Cb(14),a.oc("value",r.listing.data)("lazy",!0)("paginator",!0)("rows",r.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",r.listing.totalRecords)}}var Dt,Nt,Et=((Dt=function(){function t(e,i,r,a,o,s){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.commonDataService=r,this.binDataService=a,this.branchUtilsService=o,this.modalService=s,this.appConstants=n.h,this.screenAcl={},this.statusList=[],this.listing={data:[],totalRecords:0},this.searchForm={binCode:"",binName:"",status:"1"}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;if(this.screenAcl=this.authGuardService.getScreenAcl("27"),!this.screenAcl.view)return this.utilsService.showFailureMsg(n.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.getAutoSuggestionList("getCommonStatusList"),this.branchUtilsService.actionSaveUpdate.subscribe((function(e){"bin-location"===e.triggerType&&t.resetListing()}))}},{key:"getListing",value:function(t){var e=this,i=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.binDataService.getList(i).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"clearSearchForm",value:function(){this.searchForm={binCode:"",binName:"",status:"1"},this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"getAutoSuggestionList",value:function(t){var e=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(i){"SUCCESS"===i.status?"getCommonStatusList"===t&&(e.statusList=i.results):e.utilsService.showFailureMsg(i)}))}},{key:"showAddPopup",value:function(t){var e={backdrop:"static"};t&&(e.initialState={inputEditId:t}),this.modalService.show(Lt,e)}}]),t}()).\u0275fac=function(t){return new(t||Dt)(a.Pb(n.g),a.Pb(n.a),a.Pb(o.l),a.Pb(o.i),a.Pb(s.a),a.Pb(k.b))},Dt.\u0275cmp=a.Jb({type:Dt,selectors:[["app-bin-list"]],viewQuery:function(t,e){var i;1&t&&a.Pc(St,!0),2&t&&a.zc(i=a.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],[2,"width","80px"],[2,"width","100px"],[2,"width","200px"],[2,"width","120px"],[3,"pSortableColumn"],[3,"field"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"],[1,"badge",3,"ngClass"]],template:function(t,e){1&t&&a.Jc(0,Ft,19,5,"ng-container",0),2&t&&a.oc("ngIf",e.screenAcl.view)},directives:[u.m,b.c,l.b,b.b,b.a,m.a,d.b,d.m,d.o,d.t,d.p,d.v,u.l,u.k],styles:[""]}),Dt),kt=i("HDdC"),Tt=((Nt=function(){function t(e,i,r,a,o,s){_classCallCheck(this,t),this.utilsService=e,this.storageService=i,this.branchUtilsService=r,this.inventoryRequestDataService=a,this.formBuilder=o,this.inventoryTransferDataService=s,this.appConstants=n.h,this.initializeSubscriptions()}return _createClass(t,[{key:"initializeSubscriptions",value:function(){var t=this;this.branchUtilsService.spiTxnOptionsDownloadPdf.subscribe((function(e){t.downloadPDF(e)}))}},{key:"checkScreenNameValid",value:function(t){return!(!this.branchUtilsService.screenAttributes.hasOwnProperty(t)||"inventoryRequest"!==t&&"inventoryTransfer"!==t)}},{key:"getScreenDataService",value:function(t){return"inventoryRequest"===t?this.inventoryRequestDataService:"inventoryTransfer"===t?this.inventoryTransferDataService:void 0}},{key:"getFormErrors",value:function(t,e){return"mainFields"===e?{documentNumberingId:"",documentNumber:"",fromWarehouseId:"",toWarehouseId:"",postingDate:"",dueDate:"",documentDate:"",status:"",itemListArray:[]}:"itemFields"===e?{itemId:"",quantity:"",fromWarehouseId:"",fromBinId:"",toWarehouseId:"",toBinId:""}:void 0}},{key:"getFormValMsgs",value:function(t){return{documentNumberingId:{required:"Document No is required"},documentNumber:{required:"Document No is required"},fromWarehouseId:{required:"From Warehouse is required"},toWarehouseId:{required:"To Warehouse is required"},postingDate:{required:"Posting Date is required"},dueDate:{required:"Due Date is required"},documentDate:{required:"Document Date is required"},status:{required:"Status is required"},itemListArray:{itemId:{required:"Item Name is required"},quantity:{required:"Quantity is required",min:"Minimum 1",pattern:"Only positive numbers are allowed"},fromWarehouseId:{required:"Warehouse is required"},fromBinId:{required:"Bin is required"},toWarehouseId:{required:"Warehouse is required"},toBinId:{required:"Bin is required"}}}}},{key:"getFormMainFields",value:function(t){var e={documentNumberingId:[null,[d.u.required]],documentNumber:["",[d.u.required]],documentNumberingType:[""],businessPartnerId:[null],bpContactsId:[null],referenceNumber:[""],intraBranchFlag:[!1],fromWarehouseId:[null,[d.u.required]],toWarehouseId:[null,[d.u.required]],postingDate:[new Date,[d.u.required]],dueDate:["",[d.u.required]],documentDate:[new Date,[d.u.required]],salesEmpId:[null],status:["1",[d.u.required]],dutyStatusId:[""],remarks:[""],deletedItemChildIds:[[]],approvalStatus:["4"],showAddButton:[""]};"inventoryRequest"===t&&(e.toWarehouseId[0]=this.storageService.get("defaultWarehouseId")?this.storageService.get("defaultWarehouseId"):null),"inventoryTransfer"===t&&(e.fromWarehouseId[0]=this.storageService.get("defaultWarehouseId")?this.storageService.get("defaultWarehouseId"):null),e.itemListArray=this.formBuilder.array([]);var i=this.formBuilder.group(e);return this.setMainFieldsCustomValidation(i,t),i}},{key:"setMainFieldsCustomValidation",value:function(t,e){var i=[];i.push(this.utilsService.startEndDateValidator("documentDate","dueDate","invalidDueDate","Should => Document Date")),i.push(this.utilsService.startEndDateValidator("postingDate","documentDate","invalidPostingDate","Should <= Document Date")),t.setValidators(d.u.compose(i)),t.updateValueAndValidity()}},{key:"getMainFieldsWithData",value:function(t,e){var i={};return this.utilsService.updateObject(i,"documentNumberingId",e.documentNumberingId),this.utilsService.updateObject(i,"documentNumber",e.documentNumber),e.documentNumberingInfo&&this.utilsService.updateObject(i,"documentNumberingType",e.documentNumberingInfo.length>0?e.documentNumberingInfo[0].documentNumberingType:""),this.utilsService.updateObject(i,"businessPartnerId",e.businessPartnerId),this.utilsService.updateObject(i,"bpContactsId",e.bpContactsId),this.utilsService.updateObject(i,"referenceNumber",e.referenceNumber),this.utilsService.isEmpty(e.intraBranchFlag)||(i.intraBranchFlag="1"===e.intraBranchFlag),this.utilsService.updateObject(i,"intraBranchFlag",e.intraBranchFlag),this.utilsService.updateObject(i,"fromWarehouseId",e.fromWarehouseId),this.utilsService.updateObject(i,"toWarehouseId",e.toWarehouseId),this.utilsService.updateObject(i,"postingDate",e.postingDate,"date"),this.utilsService.updateObject(i,"dueDate",e.dueDate,"date"),this.utilsService.updateObject(i,"documentDate",e.documentDate,"date"),this.utilsService.updateObject(i,"salesEmpId",e.salesEmpId),this.utilsService.updateObject(i,"status",e.status),this.utilsService.updateObject(i,"dutyStatusId",e.dutyStatusId),this.utilsService.updateObject(i,"remarks",e.remarks),this.utilsService.updateObject(i,"showAddButton",e.showAddButton),this.utilsService.updateObject(i,"approvalStatus",e.approvalStatus),i}},{key:"getFormItemFields",value:function(t,e,i){var r={itemId:[null,[d.u.required]],quantity:[1,[d.u.required,d.u.min(1),d.u.pattern(this.appConstants.VALIDATION_PATTERNS.positiveIntNumber)]],openQuantity:[0],uomId:[null],fromWarehouseId:[null,[d.u.required]],fromBinId:[null,[d.u.required]],fromBinList:[[]],toWarehouseId:[null,[d.u.required]],toBinId:[null,[d.u.required]],toBinList:[[]],id:[""],copyFromType:[""],copyFromId:[""],showDeleteIcon:[!0],orderedQuantity:[0],fromStockDetails:[""],toStockDetails:[""]};e&&this.setDataToItemFields(t,r,e);var n=this.formBuilder.group(r);return i&&this.setItemFieldsCustomValidation(n),n}},{key:"setDataToItemFields",value:function(t,e,i){this.utilsService.updateObject(e,"itemId",i.itemId),this.utilsService.updateObject(e,"quantity",i.quantity),this.utilsService.updateObject(e,"openQuantity",parseInt(i.openQuantity,0)<0?0:i.openQuantity),this.utilsService.updateObject(e,"uomId",i.uomId),this.utilsService.updateObject(e,"fromWarehouseId",i.fromWarehouseId),this.utilsService.updateObject(e,"fromBinId",i.fromBinId),this.utilsService.updateObject(e,"toWarehouseId",i.toWarehouseId),this.utilsService.updateObject(e,"toBinId",i.toBinId),this.utilsService.updateObject(e,"id",i.id),this.utilsService.updateObject(e,"copyFromType",i.copyFromType),this.utilsService.updateObject(e,"copyFromId",i.copyFromId),this.utilsService.updateObject(e,"orderedQuantity",i.orderedQuantity)}},{key:"setItemFieldsCustomValidation",value:function(t){var e=t.getRawValue(),i=[];i.push(this.utilsService.minValidator("quantity",e.orderedQuantity,"invalidMinQuantity","Minimum : "+e.orderedQuantity)),t.setValidators(d.u.compose(i)),t.updateValueAndValidity()}},{key:"getSaveUpdateDataFormation",value:function(t,e){var i=this,r=e.getRawValue(),n={documentNumberingId:r.documentNumberingId,documentNumberingType:r.documentNumberingType,documentNumber:r.documentNumber,businessPartnerId:r.businessPartnerId,bpContactsId:r.bpContactsId,referenceNumber:r.referenceNumber,intraBranchFlag:r.intraBranchFlag?"1":"0",fromWarehouseId:r.fromWarehouseId,toWarehouseId:r.toWarehouseId,postingDate:this.utilsService.getBackendDateFormat(r.postingDate),dueDate:this.utilsService.getBackendDateFormat(r.dueDate),documentDate:this.utilsService.getBackendDateFormat(r.documentDate),salesEmpId:r.salesEmpId,status:r.status,dutyStatusId:r.dutyStatusId,remarks:r.remarks,itemListArray:[]};return r.itemListArray.forEach((function(t){"3"===r.status&&i.utilsService.isEmpty(t.id)||n.itemListArray.push({itemId:t.itemId,quantity:t.quantity,uomId:t.uomId,fromWarehouseId:t.fromWarehouseId,fromBinId:t.fromBinId,toWarehouseId:t.toWarehouseId,toBinId:t.toBinId,id:t.id,copyFromType:t.copyFromType,copyFromId:t.copyFromId})})),n}},{key:"manipulationsOnEdit",value:function(t,e){"1"===e.value.status?(e.controls.intraBranchFlag.disable(),e.controls.documentNumberingId.disable(),e.controls.documentNumber.disable(),"inventoryTransfer"===t&&(e.controls.fromWarehouseId.disable(),e.controls.toWarehouseId.disable()),e.controls.itemListArray.controls.forEach((function(e){var i=e.getRawValue();e.controls.itemId.disable(),parseInt(i.orderedQuantity,0)>0&&e.patchValue({showDeleteIcon:!1}),parseInt(i.openQuantity,0)<=0&&(e.disable(),e.patchValue({showDeleteIcon:!1})),"inventoryTransfer"===t&&e.patchValue({showDeleteIcon:!1})})),"inventoryTransfer"===t&&(e.disable(),e.controls.bpContactsId.enable(),e.controls.documentDate.enable(),e.controls.dueDate.enable(),e.controls.salesEmpId.enable(),e.controls.remarks.enable(),e.controls.status.enable())):e.enable()}},{key:"manipulationsOnCopy",value:function(t,e){e.controls.intraBranchFlag.disable(),e.controls.toWarehouseId.disable(),e.controls.itemListArray.controls.forEach((function(t){t.controls.itemId.disable(),t.controls.toWarehouseId.disable(),t.controls.toBinId.disable()}))}},{key:"redirectToList",value:function(t){this.utilsService.redirect("/branch/inventory/inventory-txn-list/"+t)}},{key:"getFormSearchFields",value:function(t){return{fromDate:"",toDate:"",isDraft:!1,branchName:"",documentNumber:"",sapId:"",partnerName:"",postingDate:"",dueDate:"",documentDate:"",status:1,salesEmpName:""}}},{key:"getSearchDataFormation",value:function(t,e){return{fromDate:this.utilsService.getBackendDateFormat(e.fromDate),toDate:this.utilsService.getBackendDateFormat(e.toDate),isDraft:e.isDraft?1:0,branchName:e.branchName,partnerName:e.partnerName,documentNumber:e.documentNumber,sapId:e.sapId,postingDate:this.utilsService.getBackendDateFormat(e.postingDate),dueDate:this.utilsService.getBackendDateFormat(e.dueDate),documentDate:this.utilsService.getBackendDateFormat(e.documentDate),status:e.status,salesEmpName:e.salesEmpName}}},{key:"redirectToAdd",value:function(t){this.utilsService.redirect("/branch/inventory/inventory-txn-add/"+t)}},{key:"redirectToEdit",value:function(t,e,i){this.utilsService.redirect("1"===i?"/branch/inventory/inventory-txn-edit-draft/"+t+"/"+this.utilsService.encrypt(e):"/branch/inventory/inventory-txn-edit/"+t+"/"+this.utilsService.encrypt(e))}},{key:"getAnalyticsData",value:function(t){var e=this,i=this.getScreenDataService(t);return new kt.a((function(t){i.getAnalyticsData().subscribe((function(i){if("SUCCESS"===i.status){var r=N.orderBy(i.results,["id"],["asc"]);t.next(r),t.complete()}else e.utilsService.showFailureMsg(i),t.error(),t.complete()}))}))}},{key:"downloadAsExcel",value:function(t,e){var i=this;this.utilsService.showSuccessMsg("Processing to download the Excel..."),this.getScreenDataService(t).downloadAsExcel(e).subscribe((function(t){"SUCCESS"===t.status?i.utilsService.externalRedirect(t.fileUrl):i.utilsService.showFailureMsg(t)}))}},{key:"downloadPDF",value:function(t){var e=this;t.spiName===this.branchUtilsService.spiTxnId.inventory&&(this.utilsService.showSuccessMsg("Processing to download the PDF..."),this.getScreenDataService(t.screenName).downloadPDF(t.id).subscribe((function(t){e.utilsService.externalRedirect(t.url,!0)})))}}]),t}()).\u0275fac=function(t){return new(t||Nt)(a.Zb(n.g),a.Zb(n.f),a.Zb(s.a),a.Zb(o.z),a.Zb(d.e),a.Zb(o.A))},Nt.\u0275prov=a.Lb({token:Nt,factory:Nt.\u0275fac}),Nt),At=i("eO1q"),Pt=["dataTable"];function wt(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",24),a.dc("click",(function(){a.Dc(i);var t=a.hc(2);return t.iTxnUtilsService.downloadAsExcel(t.inputScreenName,t.listingProperties)})),a.Qb(1,"i",25),a.Vb(2,"span"),a.Lc(3,"Download as Excel"),a.Ub(),a.Ub()}}function xt(t,e){if(1&t&&(a.Vb(0,"div",26),a.Vb(1,"div",27),a.Vb(2,"div",28),a.Lc(3),a.Ub(),a.Vb(4,"div",29),a.Lc(5),a.Ub(),a.Ub(),a.Ub()),2&t){var i=e.$implicit,r=a.hc(2);a.Cb(3),a.Nc(" ",i.name," "),a.Cb(1),a.oc("ngClass",r.appConstants.TXN_STATUS_COLOR_CLS[i.id]),a.Cb(1),a.Mc(i.count)}}function Mt(t,e){1&t&&(a.Vb(0,"th",47),a.Lc(1,"Branch Name"),a.Qb(2,"p-sortIcon",33),a.Ub()),2&t&&(a.oc("pSortableColumn","branchName"),a.Cb(2),a.oc("field","branchName"))}function Wt(t,e){1&t&&(a.Vb(0,"th",48),a.Lc(1,"Sap Doc No "),a.Qb(2,"p-sortIcon",33),a.Ub()),2&t&&(a.oc("pSortableColumn","sapId"),a.Cb(2),a.oc("field","sapId"))}function Bt(t,e){if(1&t){var i=a.Wb();a.Vb(0,"th"),a.Vb(1,"input",43),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(3).searchForm.branchName=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(3).resetListing()})),a.Ub(),a.Ub()}if(2&t){var r=a.hc(3);a.Cb(1),a.oc("ngModel",r.searchForm.branchName)}}function Ot(t,e){if(1&t){var i=a.Wb();a.Vb(0,"th"),a.Vb(1,"input",43),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(3).searchForm.sapId=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(3).resetListing()})),a.Ub(),a.Ub()}if(2&t){var r=a.hc(3);a.Cb(1),a.oc("ngModel",r.searchForm.sapId)}}function Qt(t,e){if(1&t&&(a.Vb(0,"option",49),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Nc(" ",i.name," ")}}function Jt(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"th",30),a.Lc(2,"Actions"),a.Ub(),a.Jc(3,Mt,3,2,"th",31),a.Vb(4,"th",32),a.Lc(5,"Overdue"),a.Qb(6,"p-sortIcon",33),a.Ub(),a.Vb(7,"th",34),a.Lc(8,"Doc No"),a.Qb(9,"p-sortIcon",33),a.Ub(),a.Jc(10,Wt,3,2,"th",35),a.Vb(11,"th",36),a.Lc(12,"Business Partner Name"),a.Qb(13,"p-sortIcon",33),a.Ub(),a.Vb(14,"th",37),a.Lc(15,"Line Items Count"),a.Ub(),a.Vb(16,"th",38),a.Lc(17,"Posting Date"),a.Qb(18,"p-sortIcon",33),a.Ub(),a.Vb(19,"th",38),a.Lc(20,"Due Date"),a.Qb(21,"p-sortIcon",33),a.Ub(),a.Vb(22,"th",39),a.Lc(23,"Document Date"),a.Qb(24,"p-sortIcon",33),a.Ub(),a.Vb(25,"th",38),a.Lc(26,"Status"),a.Qb(27,"p-sortIcon",33),a.Ub(),a.Vb(28,"th",36),a.Lc(29,"Sales Employee"),a.Qb(30,"p-sortIcon",33),a.Ub(),a.Ub(),a.Vb(31,"tr",40),a.Vb(32,"th"),a.Vb(33,"a",41),a.dc("click",(function(){return a.Dc(i),a.hc(2).clearSearchForm()})),a.Qb(34,"i",42),a.Lc(35,"Clear"),a.Ub(),a.Ub(),a.Jc(36,Bt,2,1,"th",0),a.Qb(37,"th"),a.Vb(38,"th"),a.Vb(39,"input",43),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.documentNumber=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Jc(40,Ot,2,1,"th",0),a.Vb(41,"th"),a.Vb(42,"input",43),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.partnerName=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Qb(43,"th"),a.Vb(44,"th"),a.Vb(45,"p-calendar",12),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.postingDate=t}))("onSelect",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(46,"th"),a.Vb(47,"p-calendar",12),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.dueDate=t}))("onSelect",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(48,"th"),a.Vb(49,"p-calendar",12),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.documentDate=t}))("onSelect",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(50,"th"),a.Vb(51,"select",44),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.status=t}))("change",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Vb(52,"option",45),a.Lc(53,"--SELECT--"),a.Ub(),a.Jc(54,Qt,2,2,"option",46),a.Ub(),a.Ub(),a.Vb(55,"th"),a.Vb(56,"input",43),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.salesEmpName=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Ub()}if(2&t){var r=a.hc(2);a.Cb(3),a.oc("ngIf",!r.storageService.get("isSingleBranchUser")),a.Cb(1),a.oc("pSortableColumn","overDueValue"),a.Cb(2),a.oc("field","overDueValue"),a.Cb(1),a.oc("pSortableColumn","documentNumber"),a.Cb(2),a.oc("field","documentNumber"),a.Cb(1),a.oc("ngIf",r.storageService.get("isSap")),a.Cb(1),a.oc("pSortableColumn","partnerName"),a.Cb(2),a.oc("field","partnerName"),a.Cb(3),a.oc("pSortableColumn","postingDate"),a.Cb(2),a.oc("field","postingDate"),a.Cb(1),a.oc("pSortableColumn","dueDate"),a.Cb(2),a.oc("field","dueDate"),a.Cb(1),a.oc("pSortableColumn","documentDate"),a.Cb(2),a.oc("field","documentDate"),a.Cb(1),a.oc("pSortableColumn","status"),a.Cb(2),a.oc("field","status"),a.Cb(1),a.oc("pSortableColumn","salesEmpName"),a.Cb(2),a.oc("field","salesEmpName"),a.Cb(6),a.oc("ngIf",!r.storageService.get("isSingleBranchUser")),a.Cb(3),a.oc("ngModel",r.searchForm.documentNumber),a.Cb(1),a.oc("ngIf",r.storageService.get("isSap")),a.Cb(2),a.oc("ngModel",r.searchForm.partnerName),a.Cb(3),a.oc("ngModel",r.searchForm.postingDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),a.Cb(2),a.oc("ngModel",r.searchForm.dueDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),a.Cb(2),a.oc("ngModel",r.searchForm.documentDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),a.Cb(2),a.oc("ngModel",r.searchForm.status),a.Cb(3),a.oc("ngForOf",r.statusList),a.Cb(2),a.oc("ngModel",r.searchForm.salesEmpName)}}function Rt(t,e){if(1&t&&(a.Vb(0,"td"),a.Lc(1),a.Ub()),2&t){var i=a.hc().$implicit;a.Cb(1),a.Mc(i.branchName)}}function Kt(t,e){if(1&t&&(a.Vb(0,"span",55),a.Lc(1),a.Ub()),2&t){var i=a.hc().$implicit;a.Cb(1),a.Nc("",i.overDueValue," Days")}}function qt(t,e){if(1&t&&(a.Vb(0,"td"),a.Lc(1),a.Ub()),2&t){var i=a.hc().$implicit;a.Cb(1),a.Mc(i.sapId)}}function _t(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"td"),a.Vb(2,"a",50),a.dc("click",(function(){a.Dc(i);var t=e.$implicit,r=a.hc(2);return r.iTxnUtilsService.redirectToEdit(r.inputScreenName,t.id,t.isDraft)})),a.Qb(3,"i",51),a.Ub(),a.Ub(),a.Jc(4,Rt,2,1,"td",0),a.Vb(5,"td"),a.Jc(6,Kt,2,1,"span",52),a.Ub(),a.Vb(7,"td"),a.Lc(8),a.Ub(),a.Jc(9,qt,2,1,"td",0),a.Vb(10,"td"),a.Lc(11),a.Ub(),a.Vb(12,"td"),a.Lc(13),a.Ub(),a.Vb(14,"td"),a.Lc(15),a.Ub(),a.Vb(16,"td"),a.Lc(17),a.Ub(),a.Vb(18,"td"),a.Lc(19),a.Ub(),a.Vb(20,"td"),a.Vb(21,"span",53),a.Lc(22),a.Ub(),a.Ub(),a.Vb(23,"td"),a.Qb(24,"img",54),a.Lc(25),a.Ub(),a.Ub()}if(2&t){var r=e.$implicit,n=a.hc(2);a.Cb(4),a.oc("ngIf",!n.storageService.get("isSingleBranchUser")),a.Cb(2),a.oc("ngIf",1==r.status&&r.overDueValue<0),a.Cb(2),a.Mc(r.documentNumber),a.Cb(1),a.oc("ngIf",n.storageService.get("isSap")),a.Cb(2),a.Oc("",r.partnerCode," - ",r.partnerName,""),a.Cb(2),a.Mc(r.lineItemInfo.length),a.Cb(2),a.Mc(r.postingDate),a.Cb(2),a.Mc(r.dueDate),a.Cb(2),a.Mc(r.documentDate),a.Cb(2),a.oc("ngClass",n.appConstants.TXN_STATUS_COLOR_CLS[r.status]),a.Cb(1),a.Mc(r.statusName),a.Cb(2),a.oc("src",r.salesEmpImgUrl?r.salesEmpImgUrl:n.appConstants.DEFAULT_USER_ICON,a.Fc),a.Cb(1),a.Oc("\xa0",r.salesEmpCode," - ",r.salesEmpName,"")}}function Gt(t,e){if(1&t){var i=a.Wb();a.Tb(0),a.Vb(1,"div",1),a.Vb(2,"span"),a.Lc(3),a.Ub(),a.Lc(4),a.Vb(5,"div",2),a.Jc(6,wt,4,0,"button",3),a.Vb(7,"button",4),a.dc("click",(function(){a.Dc(i);var t=a.hc();return t.iTxnUtilsService.redirectToAdd(t.inputScreenName)})),a.Qb(8,"i",5),a.Vb(9,"span"),a.Lc(10),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(11,"div",6),a.Vb(12,"div",7),a.Vb(13,"div",8),a.Jc(14,xt,6,3,"div",9),a.Ub(),a.Ub(),a.Vb(15,"div",8),a.Vb(16,"div",10),a.Vb(17,"label",11),a.Vb(18,"strong"),a.Lc(19,"From Date"),a.Ub(),a.Ub(),a.Vb(20,"p-calendar",12),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc().searchForm.fromDate=t}))("onSelect",(function(){return a.Dc(i),a.hc().resetListing()})),a.Ub(),a.Ub(),a.Vb(21,"div",10),a.Vb(22,"label",11),a.Vb(23,"strong"),a.Lc(24,"To Date"),a.Ub(),a.Ub(),a.Vb(25,"p-calendar",13),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc().searchForm.toDate=t}))("onSelect",(function(){return a.Dc(i),a.hc().resetListing()})),a.Ub(),a.Ub(),a.Vb(26,"div",14),a.Vb(27,"label",15),a.Vb(28,"input",16),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc().searchForm.isDraft=t}))("change",(function(){return a.Dc(i),a.hc().resetListing()})),a.Ub(),a.Qb(29,"span",17),a.Lc(30," Show Only Drafts "),a.Ub(),a.Ub(),a.Ub(),a.Vb(31,"div",8),a.Vb(32,"div",18),a.Vb(33,"div",19),a.Vb(34,"p-table",20,21),a.dc("onLazyLoad",(function(t){return a.Dc(i),a.hc().getListing(t)})),a.Jc(36,Jt,57,40,"ng-template",22),a.Jc(37,_t,26,15,"ng-template",23),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Sb()}if(2&t){var r=a.hc();a.Cb(3),a.Mc(r.branchUtilsService.txnGetTitle(r.screenAttributes.title,!0)),a.Cb(1),a.Nc("",r.branchUtilsService.txnGetTitle(r.screenAttributes.title)," - List "),a.Cb(2),a.oc("ngIf",r.screenAcl.download),a.Cb(4),a.Nc("Add ",r.screenAttributes.title,""),a.Cb(4),a.oc("ngForOf",r.analyticsData),a.Cb(6),a.oc("ngModel",r.searchForm.fromDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),a.Cb(5),a.oc("ngModel",r.searchForm.toDate)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT)("minDate",r.searchForm.fromDate),a.Cb(3),a.oc("ngModel",r.searchForm.isDraft),a.Cb(6),a.oc("value",r.listing.data)("lazy",!0)("paginator",!0)("rows",r.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",r.listing.totalRecords)}}var zt,jt=((zt=function(){function t(e,i,r,a,o,s,c){_classCallCheck(this,t),this.activatedRoute=e,this.utilsService=i,this.storageService=r,this.authGuardService=a,this.branchUtilsService=o,this.iTxnUtilsService=s,this.commonDataService=c,this.appConstants=n.h,this.screenAcl={},this.analyticsData=[],this.statusList=[],this.screenAttributes={},this.screenDataService={},this.listingProperties={},this.listing={data:[],totalRecords:0},this.searchForm={}}return _createClass(t,[{key:"ngOnInit",value:function(){this.initializeSubscriptions()}},{key:"initializeSubscriptions",value:function(){var t=this;this.activatedRoute.params.subscribe((function(e){return t.iTxnUtilsService.checkScreenNameValid(e.screenName)?(t.screenAcl=t.authGuardService.getScreenAcl(t.branchUtilsService.screenAttributes[e.screenName].documentTypeId),t.screenAcl.view?(t.reInitializeGlobalVariables(),t.inputScreenName=e.screenName,void t.transactionInitialization()):(t.utilsService.showFailureMsg(n.h.ACL_UNAUTHORIZED_MSG),t.utilsService.goBack(),!1)):(t.utilsService.showFailureMsg("Screen that you are trying to is not valid!"),t.utilsService.goBack(),!1)}))}},{key:"reInitializeGlobalVariables",value:function(){this.inputScreenName="",this.screenAttributes={},this.screenDataService={},this.analyticsData=[],this.statusList=[],this.listingProperties={},this.listing={data:[],totalRecords:0},this.searchForm={}}},{key:"transactionInitialization",value:function(){this.screenAttributes=this.branchUtilsService.screenAttributes[this.inputScreenName],this.screenDataService=this.iTxnUtilsService.getScreenDataService(this.inputScreenName),this.searchForm=this.iTxnUtilsService.getFormSearchFields(this.inputScreenName),this.getAutoSuggestionList("getInventoryTransStatusList"),this.getAnalyticsData(),this.dataTable&&this.resetListing()}},{key:"getListing",value:function(t){var e=this,i=this.iTxnUtilsService.getSearchDataFormation(this.inputScreenName,this.searchForm),r=this.utilsService.dataTableParameterFormation(t,i);this.listingProperties=r,this.screenDataService.getList(r).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"clearSearchForm",value:function(){this.searchForm=this.iTxnUtilsService.getFormSearchFields(this.inputScreenName),this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"getAutoSuggestionList",value:function(t){var e=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(i){"SUCCESS"===i.status?"getInventoryTransStatusList"===t&&(e.statusList=i.results):e.utilsService.showFailureMsg(i)}))}},{key:"getAnalyticsData",value:function(){var t=this;this.iTxnUtilsService.getAnalyticsData(this.inputScreenName).subscribe((function(e){t.analyticsData=e}))}}]),t}()).\u0275fac=function(t){return new(t||zt)(a.Pb(r.a),a.Pb(n.g),a.Pb(n.f),a.Pb(n.a),a.Pb(s.a),a.Pb(Tt),a.Pb(o.l))},zt.\u0275cmp=a.Jb({type:zt,selectors:[["app-inventory-txn-list"]],viewQuery:function(t,e){var i;1&t&&a.Pc(Pt,!0),2&t&&a.zc(i=a.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],["class","btn btn-success btn-sm",3,"click",4,"ngIf"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"analytics"],[1,"row"],["class","col-lg-2 col-md-3 col-sm-4 col-xs-12",4,"ngFor","ngForOf"],[1,"form-group","col-sm-3"],[1,"form-label"],["appendTo","body",3,"ngModel","monthNavigator","yearNavigator","yearRange","dateFormat","ngModelChange","onSelect"],["appendTo","body",3,"ngModel","monthNavigator","yearNavigator","yearRange","dateFormat","minDate","ngModelChange","onSelect"],[1,"form-group","col-sm-6","text-right"],[1,"checkbox","mt-3"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"checkmark"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa","fa-file-excel"],[1,"col-lg-2","col-md-3","col-sm-4","col-xs-12"],[1,"item"],[1,"name"],[1,"count",3,"ngClass"],[2,"width","80px"],["style","width:150px",3,"pSortableColumn",4,"ngIf"],[2,"width","100px",3,"pSortableColumn"],[3,"field"],[2,"width","90px",3,"pSortableColumn"],["style","width:110px",3,"pSortableColumn",4,"ngIf"],[2,"width","250px",3,"pSortableColumn"],[2,"width","130px"],[2,"width","120px",3,"pSortableColumn"],[2,"width","140px",3,"pSortableColumn"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[2,"width","150px",3,"pSortableColumn"],[2,"width","110px",3,"pSortableColumn"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"],["class","badge badge-danger",4,"ngIf"],[1,"badge",3,"ngClass"],["height","20px",3,"src"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&a.Jc(0,Gt,38,22,"ng-container",0),2&t&&a.oc("ngIf",e.screenAcl.view)},directives:[u.m,u.l,At.a,d.m,d.o,d.a,b.c,l.b,u.k,b.b,b.a,m.a,d.b,d.t,d.p,d.v],styles:[""]}),zt),$t=i("Kj3r"),Ht=i("/uUt"),Yt=i("vkgz"),Zt=i("TlXv"),Xt=i("umDy"),te=i("EDFS"),ee=["hActions"],ie=["hSno"],re=["hItemName"],ne=["hQuantity"],ae=["hOpenQty"],oe=["hUOM"],se=["hFromWarehouse"],ce=["hFromBin"],ue=["hToWarehouse"],be=["hToBin"],le=["bActions"],me=["bSno"],de=["bItemName"],he=["bQuantity"],pe=["bOpenQty"],fe=["bUOM"],ge=["bFromWarehouse"],ve=["bFromBin"],ye=["bToWarehouse"],Le=["bToBin"];function Se(t,e){1&t&&(a.Tb(0),a.Lc(1,"Add"),a.Sb())}function Ce(t,e){1&t&&(a.Tb(0),a.Lc(1,"Edit"),a.Sb())}function Ie(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",5),a.dc("click",(function(){return a.Dc(i),a.hc(2).downloadPdf()})),a.Qb(1,"i",74),a.Vb(2,"span"),a.Lc(3,"Print"),a.Ub(),a.Ub()}}function Ue(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc(2);a.Cb(1),a.Nc(" ",i.myFormErrors1.documentNumberingId?i.myFormErrors1.documentNumberingId:i.myFormErrors1.documentNumber," ")}}function Ve(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.partnerName,"\xa0"),a.Cb(2),a.Nc("(",i.partnerCode,")")}}function Fe(t,e){if(1&t){var i=a.Wb();a.Vb(0,"a",76),a.dc("click",(function(){return a.Dc(i),a.hc(2).bizRefreshFlag=!0})),a.Qb(1,"i",77),a.Ub()}}function De(t,e){if(1&t){var i=a.Wb();a.Vb(0,"a",78),a.dc("click",(function(){a.Dc(i);var t=a.hc(2);return t.getBusinessPartnerList(),t.bizRefreshFlag=!1})),a.Qb(1,"i",79),a.Ub()}}function Ne(t,e){if(1&t){var i=a.Wb();a.Vb(0,"span",80),a.dc("click",(function(){a.Dc(i);var t=a.hc(2);return t.popupExternalService.showDetailPopup("biz-partner",t.myForm1Data.businessPartnerId)})),a.Qb(1,"i",81),a.Ub()}}function Ee(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Ub(),a.Vb(2,"small"),a.Lc(3),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Mc(i.contactName),a.Cb(2),a.Oc("",i.contactTypeName," / ",i.contactNumber,"")}}function ke(t,e){if(1&t){var i=a.Wb();a.Vb(0,"div",82),a.Vb(1,"input",83),a.dc("change",(function(){return a.Dc(i),a.hc(2).setIntraBranch()})),a.Ub(),a.Lc(2," Intra Branch "),a.Ub()}}function Te(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub(),a.Vb(4,"small"),a.Lc(5),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.warehouseName,"\xa0"),a.Cb(2),a.Nc("(",i.warehouseCode,")"),a.Cb(2),a.Mc(i.branchName)}}function Ae(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc(2);a.Cb(1),a.Nc(" ",i.myFormErrors1.fromWarehouseId," ")}}function Pe(t,e){if(1&t){var i=a.Wb();a.Vb(0,"div",82),a.Vb(1,"input",83),a.dc("change",(function(){return a.Dc(i),a.hc(2).setIntraBranch()})),a.Ub(),a.Lc(2," Intra Branch "),a.Ub()}}function we(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub(),a.Vb(4,"small"),a.Lc(5),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.warehouseName,"\xa0"),a.Cb(2),a.Nc("(",i.warehouseCode,")"),a.Cb(2),a.Mc(i.branchName)}}function xe(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc(2);a.Cb(1),a.Nc(" ",i.myFormErrors1.toWarehouseId," ")}}function Me(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc(2);a.Cb(1),a.Nc(" ",i.myFormErrors1.postingDate," ")}}function We(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc(2);a.Cb(1),a.Nc(" ",null==i.myForm1.errors?null:i.myForm1.errors.invalidPostingDate," ")}}function Be(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc(2);a.Cb(1),a.Nc(" ",i.myFormErrors1.dueDate," ")}}function Oe(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc(2);a.Cb(1),a.Nc(" ",null==i.myForm1.errors?null:i.myForm1.errors.invalidDueDate," ")}}function Qe(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc(2);a.Cb(1),a.Nc(" ",i.myFormErrors1.documentDate," ")}}function Je(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.employeeName,"\xa0"),a.Cb(2),a.Nc("(",i.empCode,")")}}function Re(t,e){if(1&t){var i=a.Wb();a.Vb(0,"span",80),a.dc("click",(function(){a.Dc(i);var t=a.hc(2);return t.popupExternalService.showDetailPopup("employee",t.myForm1Data.salesEmpId)})),a.Qb(1,"i",81),a.Ub()}}function Ke(t,e){if(1&t&&(a.Vb(0,"option",84),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Nc(" ",i.name," ")}}function qe(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc(2);a.Cb(1),a.Nc(" ",i.myFormErrors1.status," ")}}function _e(t,e){if(1&t&&(a.Vb(0,"option",84),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Nc(" ",i.name," ")}}function Ge(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc(2);a.Cb(1),a.Nc(" ",i.myFormErrors1.remarks," ")}}var ze=function(t){return{data:t}};function je(t,e){if(1&t&&(a.Tb(0),a.Qb(1,"template",85),a.Sb()),2&t){var i=e.$implicit,r=a.hc(2);a.Cb(1),a.oc("ngTemplateOutlet",r[i.headerRef])("ngTemplateOutletContext",a.sc(2,ze,i))}}var $e=function(t,e){return{formItemListRow:t,i:e}};function He(t,e){if(1&t&&(a.Tb(0),a.Qb(1,"template",85),a.Sb()),2&t){var i=e.$implicit,r=a.hc(),n=r.$implicit,o=r.index,s=a.hc(2);a.Cb(1),a.oc("ngTemplateOutlet",s[i.bodyRef])("ngTemplateOutletContext",a.tc(2,$e,n,o))}}function Ye(t,e){if(1&t&&(a.Vb(0,"tr",86),a.Jc(1,He,2,5,"ng-container",46),a.Ub()),2&t){var i=e.index,r=a.hc(2);a.oc("formGroupName",i),a.Cb(1),a.oc("ngForOf",r.itemListColumnOrder)}}function Ze(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tfoot"),a.Vb(1,"tr"),a.Vb(2,"td",87),a.Vb(3,"button",88),a.dc("click",(function(){return a.Dc(i),a.hc(2).addItemFields()})),a.Qb(4,"i",77),a.Vb(5,"span"),a.Lc(6,"Add Item"),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub()}}function Xe(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",5),a.dc("click",(function(){return a.Dc(i),a.hc(2).saveUpdate()})),a.Qb(1,"i",89),a.Vb(2,"span"),a.Lc(3,"Save"),a.Ub(),a.Ub()}}function ti(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",5),a.dc("click",(function(){return a.Dc(i),a.hc(2).addUpdateDraft()})),a.Qb(1,"i",89),a.Vb(2,"span"),a.Lc(3,"Save as Draft"),a.Ub(),a.Ub()}}function ei(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",3),a.dc("click",(function(){return a.Dc(i),a.hc(2).clearForm()})),a.Qb(1,"i",90),a.Vb(2,"span"),a.Lc(3,"Clear"),a.Ub(),a.Ub()}}function ii(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",5),a.dc("click",(function(){return a.Dc(i),a.hc(2).saveUpdate("add")})),a.Qb(1,"i",79),a.Vb(2,"span"),a.Lc(3,"Add"),a.Ub(),a.Ub()}}function ri(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",5),a.dc("click",(function(){return a.Dc(i),a.hc(2).saveUpdate()})),a.Qb(1,"i",79),a.Vb(2,"span"),a.Lc(3,"Update"),a.Ub(),a.Ub()}}function ni(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",3),a.dc("click",(function(){a.Dc(i);var t=a.hc(2);return t.iTxnUtilsService.redirectToList(t.txnKeys.inputScreenName)})),a.Qb(1,"i",91),a.Vb(2,"span"),a.Lc(3,"Cancel"),a.Ub(),a.Ub()}}function ai(t,e){1&t&&(a.Vb(0,"div",94),a.Vb(1,"span",95),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," You are unauthorized to "),a.Vb(4,"strong"),a.Lc(5,"update"),a.Ub(),a.Lc(6," this transaction! "),a.Ub())}function oi(t,e){1&t&&(a.Vb(0,"div",94),a.Vb(1,"span",95),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," Cannot update "),a.Vb(4,"strong"),a.Lc(5,"Cancelled"),a.Ub(),a.Lc(6," / "),a.Vb(7,"strong"),a.Lc(8,"Closed"),a.Ub(),a.Lc(9," / "),a.Vb(10,"strong"),a.Lc(11," Approved"),a.Ub(),a.Lc(12," transactions! "),a.Ub())}function si(t,e){if(1&t&&(a.Vb(0,"div",92),a.Vb(1,"div"),a.Vb(2,"strong"),a.Lc(3,"Created By:"),a.Ub(),a.Lc(4),a.Ub(),a.Jc(5,ai,7,0,"div",93),a.Jc(6,oi,13,0,"div",93),a.Ub()),2&t){var i=a.hc(2);a.Cb(4),a.Nc(" ",i.txnKeys.editCreatedName,""),a.Cb(1),a.oc("ngIf",i.branchUtilsService.txnValidateBtn(i.myForm1,i.txnKeys,"updateAclNote")),a.Cb(1),a.oc("ngIf",i.branchUtilsService.txnValidateBtn(i.myForm1,i.txnKeys,"updateNote"))}}function ci(t,e){1&t&&(a.Vb(0,"div",92),a.Vb(1,"span",95),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," You are unauthorized to "),a.Vb(4,"strong"),a.Lc(5,"add"),a.Ub(),a.Lc(6," this transaction!. "),a.Ub())}function ui(t,e){if(1&t&&(a.Vb(0,"th",96),a.Lc(1),a.Ub()),2&t){var i=e.data;a.Cb(1),a.Mc(i.name)}}function bi(t,e){if(1&t&&(a.Vb(0,"th",97),a.Lc(1),a.Ub()),2&t){var i=e.data;a.Cb(1),a.Mc(i.name)}}function li(t,e){if(1&t&&(a.Vb(0,"th",98),a.Lc(1),a.Vb(2,"span",17),a.Lc(3,"*"),a.Ub(),a.Ub()),2&t){var i=e.data;a.Cb(1),a.Mc(i.name)}}function mi(t,e){if(1&t&&(a.Vb(0,"th",99),a.Lc(1),a.Vb(2,"span",17),a.Lc(3,"*"),a.Ub(),a.Ub()),2&t){var i=e.data;a.Cb(1),a.Mc(i.name)}}function di(t,e){if(1&t&&(a.Vb(0,"th",99),a.Lc(1),a.Ub()),2&t){var i=e.data;a.Cb(1),a.Mc(i.name)}}function hi(t,e){if(1&t&&(a.Vb(0,"th",99),a.Lc(1),a.Ub()),2&t){var i=e.data;a.Cb(1),a.Mc(i.name)}}function pi(t,e){if(1&t&&(a.Vb(0,"th",100),a.Lc(1),a.Vb(2,"span",17),a.Lc(3,"*"),a.Ub(),a.Ub()),2&t){var i=e.data;a.Cb(1),a.Mc(i.name)}}function fi(t,e){if(1&t&&(a.Vb(0,"th",99),a.Lc(1),a.Vb(2,"span",17),a.Lc(3,"*"),a.Ub(),a.Ub()),2&t){var i=e.data;a.Cb(1),a.Mc(i.name)}}function gi(t,e){if(1&t&&(a.Vb(0,"th",101),a.Lc(1),a.Vb(2,"span",17),a.Lc(3,"*"),a.Ub(),a.Ub()),2&t){var i=e.data;a.Cb(1),a.Mc(i.name)}}function vi(t,e){if(1&t&&(a.Vb(0,"th",99),a.Lc(1),a.Vb(2,"span",17),a.Lc(3,"*"),a.Ub(),a.Ub()),2&t){var i=e.data;a.Cb(1),a.Mc(i.name)}}function yi(t,e){if(1&t){var i=a.Wb();a.Tb(0),a.Vb(1,"a",103),a.dc("click",(function(){a.Dc(i);var t=a.hc().i;return a.hc(2).removeItemFields(t)})),a.Qb(2,"i",104),a.Ub(),a.Sb()}}function Li(t,e){if(1&t&&(a.Tb(0,102),a.Tb(1,47),a.Vb(2,"td",86),a.Jc(3,yi,3,0,"ng-container",0),a.Ub(),a.Sb(),a.Sb()),2&t){var i=e.i,r=a.hc(2);a.oc("formGroup",r.myForm1),a.Cb(2),a.oc("formGroupName",i),a.Cb(1),a.oc("ngIf",r.myForm1Data.itemListArray[i].showDeleteIcon)}}function Si(t,e){if(1&t&&(a.Tb(0,102),a.Tb(1,47),a.Vb(2,"td",86),a.Lc(3),a.Ub(),a.Sb(),a.Sb()),2&t){var i=e.i,r=a.hc(2);a.oc("formGroup",r.myForm1),a.Cb(2),a.oc("formGroupName",i),a.Cb(1),a.Mc(i+1)}}function Ci(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.itemName,"\xa0"),a.Cb(2),a.Nc("(",i.itemCode,")")}}function Ii(t,e){if(1&t){var i=a.Wb();a.Vb(0,"span",80),a.dc("click",(function(){a.Dc(i);var t=a.hc().i,e=a.hc(2);return e.popupExternalService.showDetailPopup("item",e.myForm1Data.itemListArray[t].itemId)})),a.Qb(1,"i",81),a.Ub()}}function Ui(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc().i,r=a.hc(2);a.Cb(1),a.Nc(" ",r.myFormErrors1.itemListArray[i].itemId," ")}}function Vi(t,e){if(1&t){var i=a.Wb();a.Tb(0,102),a.Tb(1,47),a.Vb(2,"td",86),a.Vb(3,"div",36),a.Vb(4,"ng-select",105),a.dc("search",(function(t){return a.Dc(i),a.hc(2).onItemSearch(t)}))("change",(function(){a.Dc(i);var t=e.i;return a.hc(2).onItemChange(t)})),a.Jc(5,Ci,4,2,"ng-template",24),a.Ub(),a.Jc(6,Ii,2,0,"span",27),a.Ub(),a.Jc(7,Ui,2,1,"div",21),a.Ub(),a.Sb(),a.Sb()}if(2&t){var r=e.i,n=a.hc(2);a.oc("formGroup",n.myForm1),a.Cb(2),a.oc("formGroupName",r),a.Cb(2),a.oc("items",n.itemList)("multiple",!1)("virtualScroll",!0),a.Cb(2),a.oc("ngIf",n.myForm1Data.itemListArray[r].itemId),a.Cb(1),a.oc("ngIf",n.myFormErrors1.itemListArray[r].itemId)}}function Fi(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc().formItemListRow;a.Cb(1),a.Nc(" ",null==i.errors?null:i.errors.invalidMinQuantity," ")}}function Di(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc().i,r=a.hc(2);a.Cb(1),a.Nc(" ",r.myFormErrors1.itemListArray[i].quantity," ")}}function Ni(t,e){if(1&t&&(a.Tb(0,102),a.Tb(1,47),a.Vb(2,"td",86),a.Qb(3,"input",106),a.Jc(4,Fi,2,1,"div",21),a.Jc(5,Di,2,1,"div",21),a.Ub(),a.Sb(),a.Sb()),2&t){var i=e.formItemListRow,r=e.i,n=a.hc(2);a.oc("formGroup",n.myForm1),a.Cb(2),a.oc("formGroupName",r),a.Cb(2),a.oc("ngIf",null==i.errors?null:i.errors.invalidMinQuantity),a.Cb(1),a.oc("ngIf",n.myFormErrors1.itemListArray[r].quantity)}}function Ei(t,e){if(1&t&&(a.Tb(0,102),a.Tb(1,47),a.Vb(2,"td",86),a.Lc(3),a.Ub(),a.Sb(),a.Sb()),2&t){var i=e.i,r=a.hc(2);a.oc("formGroup",r.myForm1),a.Cb(2),a.oc("formGroupName",i),a.Cb(1),a.Nc(" ",r.myForm1Data.itemListArray[i].openQuantity," ")}}function ki(t,e){if(1&t&&(a.Tb(0,102),a.Tb(1,47),a.Vb(2,"td",86),a.Qb(3,"ng-select",107),a.Ub(),a.Sb(),a.Sb()),2&t){var i=e.i,r=a.hc(2);a.oc("formGroup",r.myForm1),a.Cb(2),a.oc("formGroupName",i),a.Cb(1),a.oc("items",r.uomList)("multiple",!1)}}function Ti(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.warehouseName,"\xa0"),a.Cb(2),a.Nc("(",i.warehouseCode,")")}}function Ai(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc().i,r=a.hc(2);a.Cb(1),a.Nc(" ",r.myFormErrors1.itemListArray[i].fromWarehouseId," ")}}function Pi(t,e){if(1&t){var i=a.Wb();a.Tb(0,102),a.Tb(1,47),a.Vb(2,"td",86),a.Vb(3,"ng-select",108),a.dc("change",(function(){a.Dc(i);var t=e.i;return a.hc(2).setBinList("from",t)})),a.Jc(4,Ti,4,2,"ng-template",24),a.Ub(),a.Jc(5,Ai,2,1,"div",21),a.Ub(),a.Sb(),a.Sb()}if(2&t){var r=e.i,n=a.hc(2);a.oc("formGroup",n.myForm1),a.Cb(2),a.oc("formGroupName",r),a.Cb(1),a.oc("items",n.itemFromWarehouseList)("multiple",!1),a.Cb(2),a.oc("ngIf",n.myFormErrors1.itemListArray[r].fromWarehouseId)}}function wi(t,e){if(1&t&&(a.Vb(0,"div",113),a.Vb(1,"strong"),a.Lc(2,"Only available stock bin's will be listed"),a.Ub(),a.Ub(),a.Lc(3)),2&t){var i=a.hc().i,r=a.hc(2);a.Cb(3),a.Nc(" ",r.myForm1Data.itemListArray[i].fromStockDetails?r.myForm1Data.itemListArray[i].fromStockDetails:"..."," ")}}function xi(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc().i,r=a.hc(2);a.Cb(1),a.Nc(" ",r.myFormErrors1.itemListArray[i].fromBinId," ")}}function Mi(t,e){if(1&t){var i=a.Wb();a.Tb(0,102),a.Tb(1,47),a.Vb(2,"td",86),a.Vb(3,"div",36),a.Qb(4,"ng-select",109),a.Vb(5,"span",110),a.dc("click",(function(){a.Dc(i);var t=e.i,r=a.hc(2);return r.branchUtilsService.txnSetItemStockToBinTooltip(r.myForm1,t,"fromWarehouseId","fromStockDetails")})),a.Jc(6,wi,4,1,"ng-template",null,111,a.Kc),a.Vb(8,"span",112),a.Qb(9,"i",81),a.Ub(),a.Ub(),a.Ub(),a.Jc(10,xi,2,1,"div",21),a.Ub(),a.Sb(),a.Sb()}if(2&t){var r=e.i,n=a.Ac(7),o=a.hc(2);a.oc("formGroup",o.myForm1),a.Cb(2),a.oc("formGroupName",r),a.Cb(2),a.oc("items",o.myForm1Data.itemListArray[r].fromBinList)("multiple",!1),a.Cb(4),a.oc("popover",n)("outsideClick",!0),a.Cb(2),a.oc("ngIf",o.myFormErrors1.itemListArray[r].fromBinId)}}function Wi(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.warehouseName,"\xa0"),a.Cb(2),a.Nc("(",i.warehouseCode,")")}}function Bi(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc().i,r=a.hc(2);a.Cb(1),a.Nc(" ",r.myFormErrors1.itemListArray[i].toWarehouseId," ")}}function Oi(t,e){if(1&t){var i=a.Wb();a.Tb(0,102),a.Tb(1,47),a.Vb(2,"td",86),a.Vb(3,"ng-select",114),a.dc("change",(function(){a.Dc(i);var t=e.i;return a.hc(2).setBinList("to",t)})),a.Jc(4,Wi,4,2,"ng-template",24),a.Ub(),a.Jc(5,Bi,2,1,"div",21),a.Ub(),a.Sb(),a.Sb()}if(2&t){var r=e.i,n=a.hc(2);a.oc("formGroup",n.myForm1),a.Cb(2),a.oc("formGroupName",r),a.Cb(1),a.oc("items",n.itemToWarehouseList)("multiple",!1),a.Cb(2),a.oc("ngIf",n.myFormErrors1.itemListArray[r].toWarehouseId)}}function Qi(t,e){if(1&t&&(a.Vb(0,"div",113),a.Vb(1,"strong"),a.Lc(2,"Only available stocks bin's are listed"),a.Ub(),a.Ub(),a.Lc(3)),2&t){var i=a.hc().i,r=a.hc(2);a.Cb(3),a.Nc(" ",r.myForm1Data.itemListArray[i].toStockDetails?r.myForm1Data.itemListArray[i].toStockDetails:"Loading..."," ")}}function Ji(t,e){if(1&t&&(a.Vb(0,"div",75),a.Lc(1),a.Ub()),2&t){var i=a.hc().i,r=a.hc(2);a.Cb(1),a.Nc(" ",r.myFormErrors1.itemListArray[i].toBinId," ")}}function Ri(t,e){if(1&t){var i=a.Wb();a.Tb(0,102),a.Tb(1,47),a.Vb(2,"td",86),a.Vb(3,"div",36),a.Qb(4,"ng-select",115),a.Vb(5,"span",110),a.dc("click",(function(){a.Dc(i);var t=e.i,r=a.hc(2);return r.branchUtilsService.txnSetItemStockToBinTooltip(r.myForm1,t,"toWarehouseId","toStockDetails")})),a.Jc(6,Qi,4,1,"ng-template",null,116,a.Kc),a.Vb(8,"span",112),a.Qb(9,"i",81),a.Ub(),a.Ub(),a.Ub(),a.Jc(10,Ji,2,1,"div",21),a.Ub(),a.Sb(),a.Sb()}if(2&t){var r=e.i,n=a.Ac(7),o=a.hc(2);a.oc("formGroup",o.myForm1),a.Cb(2),a.oc("formGroupName",r),a.Cb(2),a.oc("items",o.myForm1Data.itemListArray[r].toBinList)("multiple",!1),a.Cb(4),a.oc("popover",n)("outsideClick",!0),a.Cb(2),a.oc("ngIf",o.myFormErrors1.itemListArray[r].toBinId)}}var Ki=function(){return{"max-height.px":300}};function qi(t,e){if(1&t){var i=a.Wb();a.Tb(0),a.Vb(1,"div",1),a.Vb(2,"span"),a.Lc(3),a.Ub(),a.Lc(4),a.Jc(5,Se,2,0,"ng-container",0),a.Jc(6,Ce,2,0,"ng-container",0),a.Vb(7,"div",2),a.Vb(8,"button",3),a.dc("click",(function(){return a.Dc(i),a.hc().utilsService.goBack()})),a.Qb(9,"i",4),a.Vb(10,"span"),a.Lc(11,"Back"),a.Ub(),a.Ub(),a.Vb(12,"button",5),a.dc("click",(function(){a.Dc(i);var t=a.hc();return t.popupExternalService.showManageColumnsPopup(t.txnKeys.inputScreenName)})),a.Qb(13,"i",6),a.Vb(14,"span"),a.Lc(15,"Manage Item Columns"),a.Ub(),a.Ub(),a.Jc(16,Ie,4,0,"button",7),a.Vb(17,"button",5),a.dc("click",(function(){return a.Dc(i),a.hc().showTxnOptionsSidebar()})),a.Qb(18,"i",8),a.Vb(19,"span"),a.Lc(20,"More"),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(21,"div",9),a.Vb(22,"div",10),a.Vb(23,"div",11),a.Qb(24,"i",12),a.Lc(25,"Basic Info "),a.Ub(),a.Vb(26,"div",13),a.Vb(27,"div",14),a.Vb(28,"div",15),a.Vb(29,"label",16),a.Lc(30,"Doc No"),a.Vb(31,"span",17),a.Lc(32,"*"),a.Ub(),a.Ub(),a.Vb(33,"div",14),a.Vb(34,"div",18),a.Vb(35,"ng-select",19),a.dc("change",(function(){a.Dc(i);var t=a.hc();return t.branchUtilsService.onDocumentNumberingChange(t.documentNumberingList,t.myForm1)})),a.Ub(),a.Ub(),a.Vb(36,"div",18),a.Qb(37,"input",20),a.Ub(),a.Ub(),a.Jc(38,Ue,2,1,"div",21),a.Ub(),a.Vb(39,"div",15),a.Vb(40,"label",16),a.Lc(41,"Business Partner Name"),a.Ub(),a.Vb(42,"div",22),a.Vb(43,"ng-select",23),a.dc("change",(function(){a.Dc(i);var t=a.hc();return t.getBpContactList(),t.showTxnOptionsSidebar(!1)})),a.Jc(44,Ve,4,2,"ng-template",24),a.Ub(),a.Vb(45,"span"),a.Jc(46,Fe,2,0,"a",25),a.Jc(47,De,2,0,"a",26),a.Ub(),a.Jc(48,Ne,2,0,"span",27),a.Ub(),a.Ub(),a.Vb(49,"div",15),a.Vb(50,"label",16),a.Lc(51,"Contact Person"),a.Ub(),a.Vb(52,"ng-select",28),a.Jc(53,Ee,4,3,"ng-template",24),a.Ub(),a.Ub(),a.Vb(54,"div",15),a.Vb(55,"label",16),a.Lc(56,"Reference No"),a.Ub(),a.Qb(57,"input",29),a.Ub(),a.Vb(58,"div",15),a.Vb(59,"label",16),a.Lc(60," From Warehouse"),a.Vb(61,"span",17),a.Lc(62,"*"),a.Ub(),a.Jc(63,ke,3,0,"div",30),a.Ub(),a.Vb(64,"ng-select",31),a.dc("change",(function(){return a.Dc(i),a.hc().confirmFromWarehouseChanges()}))("open",(function(){a.Dc(i);var t=a.hc();return t.fromWarehousePrevValue=t.myForm1Data.fromWarehouseId})),a.Jc(65,Te,6,3,"ng-template",24),a.Ub(),a.Jc(66,Ae,2,1,"div",21),a.Ub(),a.Vb(67,"div",15),a.Vb(68,"label",16),a.Lc(69," To Warehouse"),a.Vb(70,"span",17),a.Lc(71,"*"),a.Ub(),a.Jc(72,Pe,3,0,"div",30),a.Ub(),a.Vb(73,"ng-select",32),a.dc("change",(function(){return a.Dc(i),a.hc().confirmToWarehouseChanges()}))("open",(function(){a.Dc(i);var t=a.hc();return t.toWarehousePrevValue=t.myForm1Data.toWarehouseId})),a.Jc(74,we,6,3,"ng-template",24),a.Ub(),a.Jc(75,xe,2,1,"div",21),a.Ub(),a.Vb(76,"div",15),a.Vb(77,"label",16),a.Lc(78,"Posting Date"),a.Vb(79,"span",17),a.Lc(80,"*"),a.Ub(),a.Ub(),a.Qb(81,"p-calendar",33),a.Jc(82,Me,2,1,"div",21),a.Jc(83,We,2,1,"div",21),a.Ub(),a.Vb(84,"div",15),a.Vb(85,"label",16),a.Lc(86,"Due Date"),a.Vb(87,"span",17),a.Lc(88,"*"),a.Ub(),a.Ub(),a.Qb(89,"p-calendar",34),a.Jc(90,Be,2,1,"div",21),a.Jc(91,Oe,2,1,"div",21),a.Ub(),a.Vb(92,"div",15),a.Vb(93,"label",16),a.Lc(94,"Document Date"),a.Vb(95,"span",17),a.Lc(96,"*"),a.Ub(),a.Ub(),a.Qb(97,"p-calendar",35),a.Jc(98,Qe,2,1,"div",21),a.Ub(),a.Vb(99,"div",15),a.Vb(100,"label",16),a.Lc(101,"Sales Employee"),a.Ub(),a.Vb(102,"div",36),a.Vb(103,"ng-select",37),a.Jc(104,Je,4,2,"ng-template",24),a.Ub(),a.Jc(105,Re,2,0,"span",27),a.Ub(),a.Ub(),a.Vb(106,"div",15),a.Vb(107,"label",16),a.Lc(108,"Status"),a.Vb(109,"span",17),a.Lc(110,"*"),a.Ub(),a.Ub(),a.Vb(111,"select",38),a.Jc(112,Ke,2,2,"option",39),a.Ub(),a.Jc(113,qe,2,1,"div",21),a.Ub(),a.Vb(114,"div",15),a.Vb(115,"label",16),a.Lc(116,"Duty Status"),a.Ub(),a.Vb(117,"select",40),a.Vb(118,"option",41),a.Lc(119,"--SELECT--"),a.Ub(),a.Jc(120,_e,2,2,"option",39),a.Ub(),a.Ub(),a.Vb(121,"div",15),a.Vb(122,"label",16),a.Lc(123,"Remarks"),a.Ub(),a.Qb(124,"textarea",42),a.Jc(125,Ge,2,1,"div",21),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(126,"div",10),a.Vb(127,"div",11),a.Qb(128,"i",12),a.Lc(129,"Content Info "),a.Ub(),a.Vb(130,"div",43),a.Vb(131,"div",44),a.Vb(132,"table",45),a.Vb(133,"thead"),a.Vb(134,"tr"),a.Jc(135,je,2,4,"ng-container",46),a.Ub(),a.Ub(),a.Vb(136,"tbody",47),a.Jc(137,Ye,2,2,"tr",48),a.Ub(),a.Jc(138,Ze,7,0,"tfoot",0),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Qb(139,"app-udf-viewer",49),a.Vb(140,"app-attachments",50),a.dc("doSuccess",(function(){a.Dc(i);var t=a.hc();return t.iTxnUtilsService.redirectToList(t.txnKeys.inputScreenName)})),a.Ub(),a.Vb(141,"div",51),a.Jc(142,Xe,4,0,"button",7),a.Jc(143,ti,4,0,"button",7),a.Jc(144,ei,4,0,"button",52),a.Jc(145,ii,4,0,"button",7),a.Jc(146,ri,4,0,"button",7),a.Jc(147,ni,4,0,"button",52),a.Ub(),a.Jc(148,si,7,3,"div",53),a.Jc(149,ci,7,0,"div",53),a.Ub(),a.Qb(150,"app-spi-txn-options"),a.Jc(151,ui,2,1,"ng-template",null,54,a.Kc),a.Jc(153,bi,2,1,"ng-template",null,55,a.Kc),a.Jc(155,li,4,1,"ng-template",null,56,a.Kc),a.Jc(157,mi,4,1,"ng-template",null,57,a.Kc),a.Jc(159,di,2,1,"ng-template",null,58,a.Kc),a.Jc(161,hi,2,1,"ng-template",null,59,a.Kc),a.Jc(163,pi,4,1,"ng-template",null,60,a.Kc),a.Jc(165,fi,4,1,"ng-template",null,61,a.Kc),a.Jc(167,gi,4,1,"ng-template",null,62,a.Kc),a.Jc(169,vi,4,1,"ng-template",null,63,a.Kc),a.Jc(171,Li,4,3,"ng-template",null,64,a.Kc),a.Jc(173,Si,4,3,"ng-template",null,65,a.Kc),a.Jc(175,Vi,8,7,"ng-template",null,66,a.Kc),a.Jc(177,Ni,6,4,"ng-template",null,67,a.Kc),a.Jc(179,Ei,4,3,"ng-template",null,68,a.Kc),a.Jc(181,ki,4,4,"ng-template",null,69,a.Kc),a.Jc(183,Pi,6,5,"ng-template",null,70,a.Kc),a.Jc(185,Mi,11,7,"ng-template",null,71,a.Kc),a.Jc(187,Oi,6,5,"ng-template",null,72,a.Kc),a.Jc(189,Ri,11,7,"ng-template",null,73,a.Kc),a.Sb()}if(2&t){var r=a.hc();a.Cb(3),a.Mc(r.branchUtilsService.txnGetTitle(r.screenAttributes.title,!0)),a.Cb(1),a.Nc("",r.branchUtilsService.txnGetTitle(r.screenAttributes.title)," - "),a.Cb(1),a.oc("ngIf",!r.txnKeys.inputEditId),a.Cb(1),a.oc("ngIf",r.txnKeys.inputEditId),a.Cb(10),a.oc("ngIf",r.txnKeys.inputEditId),a.Cb(5),a.oc("formGroup",r.myForm1),a.Cb(14),a.oc("items",r.documentNumberingList),a.Cb(3),a.oc("ngIf",r.myFormErrors1.documentNumberingId||r.myFormErrors1.documentNumber),a.Cb(5),a.oc("items",r.businessPartnerList)("multiple",!1),a.Cb(3),a.oc("ngIf",!r.bizRefreshFlag),a.Cb(1),a.oc("ngIf",r.bizRefreshFlag),a.Cb(1),a.oc("ngIf",r.myForm1Data.businessPartnerId),a.Cb(4),a.oc("items",r.bpContactList)("multiple",!1),a.Cb(11),a.oc("ngIf","inventoryRequest"===r.txnKeys.inputScreenName),a.Cb(1),a.oc("items",r.fromWarehouseList)("multiple",!1),a.Cb(2),a.oc("ngIf",r.myFormErrors1.fromWarehouseId),a.Cb(6),a.oc("ngIf","inventoryTransfer"===r.txnKeys.inputScreenName),a.Cb(1),a.oc("items",r.toWarehouseList)("multiple",!1),a.Cb(2),a.oc("ngIf",r.myFormErrors1.toWarehouseId),a.Cb(6),a.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),a.Cb(1),a.oc("ngIf",r.myFormErrors1.postingDate),a.Cb(1),a.oc("ngIf",null==r.myForm1.errors?null:r.myForm1.errors.invalidPostingDate),a.Cb(6),a.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),a.Cb(1),a.oc("ngIf",r.myFormErrors1.dueDate),a.Cb(1),a.oc("ngIf",null==r.myForm1.errors?null:r.myForm1.errors.invalidDueDate),a.Cb(6),a.oc("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.appConstants.PICKER_YEAR_RANGE)("dateFormat",r.appConstants.PICKER_DATE_FORMAT),a.Cb(1),a.oc("ngIf",r.myFormErrors1.documentDate),a.Cb(5),a.oc("items",r.salesEmployeeList)("multiple",!1),a.Cb(2),a.oc("ngIf",r.myForm1Data.salesEmpId),a.Cb(7),a.oc("ngForOf",r.statusList),a.Cb(1),a.oc("ngIf",r.myFormErrors1.status),a.Cb(7),a.oc("ngForOf",r.dutyStatusList),a.Cb(5),a.oc("ngIf",r.myFormErrors1.remarks),a.Cb(6),a.oc("ngStyle",a.rc(61,Ki)),a.Cb(4),a.oc("ngForOf",r.itemListColumnOrder),a.Cb(2),a.oc("ngForOf",r.myForm1.controls.itemListArray.controls),a.Cb(1),a.oc("ngIf",r.branchUtilsService.txnAddItemAccess(r.txnKeys.inputScreenName,r.myForm1,r.txnKeys.inputEditId)),a.Cb(1),a.oc("type",r.screenAttributes.backendKey),a.Cb(1),a.oc("type",r.screenAttributes.backendKey),a.Cb(2),a.oc("ngIf",r.branchUtilsService.txnValidateBtn(r.myForm1,r.txnKeys,"save")),a.Cb(1),a.oc("ngIf",r.branchUtilsService.txnValidateBtn(r.myForm1,r.txnKeys,"saveDraft")),a.Cb(1),a.oc("ngIf",r.branchUtilsService.txnValidateBtn(r.myForm1,r.txnKeys,"clear")),a.Cb(1),a.oc("ngIf",r.branchUtilsService.txnValidateBtn(r.myForm1,r.txnKeys,"add")),a.Cb(1),a.oc("ngIf",r.branchUtilsService.txnValidateBtn(r.myForm1,r.txnKeys,"update")),a.Cb(1),a.oc("ngIf",r.branchUtilsService.txnValidateBtn(r.myForm1,r.txnKeys,"cancel")),a.Cb(1),a.oc("ngIf",r.branchUtilsService.txnValidateBtn(r.myForm1,r.txnKeys,"editMsgContainer")),a.Cb(1),a.oc("ngIf",r.branchUtilsService.txnValidateBtn(r.myForm1,r.txnKeys,"addAclNote"))}}var _i,Gi=((_i=function(){function t(e,i,r,a,o,s,c,u,b,l,m){_classCallCheck(this,t),this.utilsService=e,this.storageService=i,this.authGuardService=r,this.commonDataService=a,this.branchUtilsService=o,this.iTxnUtilsService=s,this.popupExternalService=c,this.formBuilder=u,this.activatedRoute=b,this.changeDetectorRef=l,this.modalService=m,this.appConstants=n.h,this.screenAcl={},this.txnKeys={inputScreenName:"",inputEditId:"",inputDraftId:"",inputCopyId:"",inputCopyScreenName:"",inputDuplicateId:"",editStatusId:"",editCreatedName:""},this.screenAttributes={},this.screenDataService={},this.itemListColumnOrder=[],this.bizRefreshFlag=!1,this.documentNumberingList=[],this.businessPartnerList=[],this.bpContactList=[],this.fromWarehouseList=[],this.fromWarehousePrevValue=[],this.toWarehouseList=[],this.toWarehousePrevValue=[],this.salesEmployeeList=[],this.statusList=[],this.dutyStatusList=[],this.itemList=[],this.uomList=[],this.itemFromWarehouseList=[],this.itemToWarehouseList=[],this.myForm1Data={},this.myFormErrors1={},this.myFormValidationMsgs1={}}return _createClass(t,[{key:"ngOnInit",value:function(){this.initializeSubscriptions()}},{key:"ngAfterViewInit",value:function(){this.attachmentsComponent&&this.udfViewerComponent&&(this.attachmentsComponent.loadAttachments(this.txnKeys.inputEditId||this.txnKeys.inputDraftId),this.udfViewerComponent.getFields(this.txnKeys.inputEditId||this.txnKeys.inputDuplicateId||this.txnKeys.inputDraftId),this.changeDetectorRef.detectChanges())}},{key:"initializeSubscriptions",value:function(){var t=this;this.activatedRoute.params.subscribe((function(e){return t.iTxnUtilsService.checkScreenNameValid(e.screenName)?(t.screenAcl=t.authGuardService.getScreenAcl(t.branchUtilsService.screenAttributes[e.screenName].documentTypeId),t.screenAcl.view?(t.reInitializeGlobalVariables(),t.txnKeys.inputScreenName=e.screenName,t.transactionInitialization(),e.id&&(t.txnKeys.inputEditId=t.utilsService.decrypt(e.id),t.get()),e.copyScreenName&&e.copyId&&(t.txnKeys.inputCopyId=t.utilsService.decrypt(e.copyId),t.txnKeys.inputCopyScreenName=e.copyScreenName,t.copyFrom()),e.duplicateId&&(t.txnKeys.inputDuplicateId=t.utilsService.decrypt(e.duplicateId),t.getDuplicate()),e.draftId&&(t.txnKeys.inputDraftId=t.utilsService.decrypt(e.draftId),t.getDraft()),void(t.txnKeys.inputEditId||t.txnKeys.inputCopyId||t.txnKeys.inputDuplicateId||t.txnKeys.inputDraftId||(t.branchUtilsService.getMasterDocumentNumbering(t.myForm1,t.screenAttributes.documentTypeId).subscribe((function(e){t.documentNumberingList=e})),t.getBusinessPartnerList(),t.getWarehouseList(),t.getSalesEmployeeList(),t.getAutoSuggestionList("getUomList")))):(t.utilsService.showFailureMsg(n.h.ACL_UNAUTHORIZED_MSG),t.utilsService.goBack(),!1)):(t.utilsService.showFailureMsg("Screen that you are trying to is not valid!"),t.utilsService.goBack(),!1)})),this.branchUtilsService.itemSearch.pipe(Object($t.a)(700),Object(Ht.a)(),Object(Yt.a)((function(e){t.getItemList(e)}))).subscribe(),this.itemListColumnOrderChangesSubscription=this.branchUtilsService.itemListColumnOrderChanges.subscribe((function(e){"inventoryRequest"!==e.triggerType&&"inventoryTransfer"!==e.triggerType||(t.itemListColumnOrder=t.branchUtilsService.getSelectedItemColumnDataByTxn(t.txnKeys.inputScreenName))}))}},{key:"reInitializeGlobalVariables",value:function(){this.txnKeys.inputScreenName="",this.txnKeys.inputEditId="",this.txnKeys.inputCopyId="",this.txnKeys.inputCopyScreenName="",this.txnKeys.inputDuplicateId="",this.txnKeys.editStatusId="",this.txnKeys.editCreatedName="",this.screenAttributes={},this.screenDataService={},this.itemListColumnOrder=[],this.bizRefreshFlag=!1,this.documentNumberingList=[],this.businessPartnerList=[],this.bpContactList=[],this.fromWarehouseList=[],this.toWarehouseList=[],this.salesEmployeeList=[],this.statusList=[],this.dutyStatusList=[],this.itemList=[],this.uomList=[],this.itemFromWarehouseList=[],this.itemToWarehouseList=[]}},{key:"transactionInitialization",value:function(){this.screenAttributes=this.branchUtilsService.screenAttributes[this.txnKeys.inputScreenName],this.screenDataService=this.iTxnUtilsService.getScreenDataService(this.txnKeys.inputScreenName),this.itemListColumnOrder=this.branchUtilsService.getSelectedItemColumnDataByTxn(this.txnKeys.inputScreenName),this.myFormErrors1=this.iTxnUtilsService.getFormErrors(this.txnKeys.inputScreenName,"mainFields"),this.myFormValidationMsgs1=this.iTxnUtilsService.getFormValMsgs(this.txnKeys.inputScreenName),this.initializeForm1(),this.getAutoSuggestionList("getInventoryTransStatusList"),this.getAutoSuggestionList("getDutyStatusList"),this.branchUtilsService.spiTxnOptions.next({show:!1})}},{key:"initializeForm1",value:function(){var t=this;this.myForm1=this.iTxnUtilsService.getFormMainFields(this.txnKeys.inputScreenName),this.myForm1.valueChanges.subscribe((function(e){t.utilsService.validation(t.myForm1,t.myFormErrors1,t.myFormValidationMsgs1),t.myForm1Data=t.myForm1.getRawValue()})),this.myForm1Data=this.myForm1.getRawValue()}},{key:"addItemFields",value:function(t,e){var i=this.myForm1.controls.itemListArray;if(i.push(this.initItemFields(t,e)),!t){var r=i.length-1;i.at(r).patchValue({fromWarehouseId:this.myForm1Data.fromWarehouseId,toWarehouseId:this.myForm1Data.toWarehouseId}),this.setBinList("from",r),this.setBinList("to",r)}}},{key:"initItemFields",value:function(t,e){return this.myFormErrors1.itemListArray.push(this.iTxnUtilsService.getFormErrors(this.txnKeys.inputScreenName,"itemFields")),this.iTxnUtilsService.getFormItemFields(this.txnKeys.inputScreenName,t,e)}},{key:"removeItemFields",value:function(t){var e=this.myForm1Data.itemListArray[t].id;if(e){var i=this.myForm1Data.deletedItemChildIds;i.push(e),this.myForm1.patchValue({deletedItemChildIds:i})}this.myForm1.controls.itemListArray.removeAt(t)}},{key:"saveUpdate",value:function(t){var e=this,i=this.myForm1.getRawValue();if("3"!==i.approvalStatus&&"1"!==i.approvalStatus){var r=N.findIndex(this.documentNumberingList,{id:i.documentNumberingId});if("DRAFT"===this.documentNumberingList[r].documentNumberingType&&"add"!==t)return this.utilsService.showFailureMsg("Cannot Proceed - Select other than draft document numbering from Doc No field!"),!1}if(!this.myForm1.valid||!this.udfViewerComponent.valid())return this.utilsService.validation(this.myForm1,this.myFormErrors1,this.myFormValidationMsgs1,!0),this.udfViewerComponent.checkValidations(),!1;if(0===i.itemListArray.length)return this.utilsService.showFailureMsg("Cannot save / update - No item added!"),!1;for(var n=!1,a=this.myForm1Data.itemListArray.length,o=0;o<a;o++){var s=this.myForm1Data.itemListArray[o];if(s.fromWarehouseId===s.toWarehouseId&&s.fromBinId===s.toBinId){n=!0;break}}if(n)return this.utilsService.showFailureMsg("From Warehouse/Bin and To Warehouse/Bin cannot be same!"),!1;var c,u=this.iTxnUtilsService.getSaveUpdateDataFormation(this.txnKeys.inputScreenName,this.myForm1);u.udfFields=JSON.stringify(this.udfViewerComponent.getFormValues()),u.isDraft=this.txnKeys.inputDraftId?"2":"0","add"===t?(u.id=this.txnKeys.inputEditId||this.txnKeys.inputDraftId,c="proceed"):this.txnKeys.inputEditId||this.txnKeys.inputDraftId?(c="update",u.id=this.txnKeys.inputEditId||this.txnKeys.inputDraftId,u.deletedItemChildIds=this.myForm1Data.deletedItemChildIds):c="save",this.screenDataService[c](u).subscribe((function(t){"SUCCESS"===t.status?(e.utilsService.showSuccessMsg(t),e.attachmentsComponent.save("save"===c?t.sId:e.txnKeys.inputEditId||e.txnKeys.inputDraftId)):e.utilsService.showFailureMsg(t)}))}},{key:"addUpdateDraft",value:function(){var t=this,e=this.myForm1.getRawValue(),i=N.findIndex(this.documentNumberingList,{id:e.documentNumberingId});if("DRAFT"!==this.documentNumberingList[i].documentNumberingType)return this.utilsService.showFailureMsg("Cannot Proceed - Select draft document numbering from Doc No field!"),!1;if(0===e.itemListArray.length)return this.utilsService.showFailureMsg("Cannot save / update draft - No item added!"),!1;var r,n=this.iTxnUtilsService.getSaveUpdateDataFormation(this.txnKeys.inputScreenName,this.myForm1);n.udfFields=JSON.stringify(this.udfViewerComponent.getFormValues()),n.isDraft="1",this.txnKeys.inputDraftId?(r="update",n.id=this.txnKeys.inputDraftId,n.deletedItemChildIds=this.myForm1Data.deletedItemChildIds):r="save",this.screenDataService[r](n).subscribe((function(e){"SUCCESS"===e.status?(t.utilsService.showSuccessMsg(e),t.attachmentsComponent.save("save"===r?e.sId:t.txnKeys.inputDraftId)):t.utilsService.showFailureMsg(e)}))}},{key:"get",value:function(){var t=this;this.screenDataService.get(this.txnKeys.inputEditId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results,r=t.iTxnUtilsService.getMainFieldsWithData(t.txnKeys.inputScreenName,i);t.myForm1.patchValue(r);var n=[],a=[];i.fromWarehouseInfo[0]&&n.push(i.fromWarehouseInfo[0]),i.toWarehouseInfo[0]&&a.push(i.toWarehouseInfo[0]),t.branchUtilsService.getMasterDocumentNumbering(t.myForm1,t.screenAttributes.documentTypeId,"edit",i.documentNumberingInfo).subscribe((function(e){t.documentNumberingList=e})),t.getBusinessPartnerList(!0,i.bpInfo),t.getBpContactList(!0,i.bpContactsInfo),t.getSalesEmployeeList(i.salesEmpInfo);var o=[],s=[];i.itemListArray.forEach((function(e){t.addItemFields(e,"edit"),e.itemInfo[0]&&o.push(e.itemInfo[0]),e.uomInfo[0]&&s.push(e.uomInfo[0]),e.fromWarehouseInfo[0]&&n.push(e.fromWarehouseInfo[0]),e.toWarehouseInfo[0]&&a.push(e.toWarehouseInfo[0])})),t.getAutoSuggestionList("getUomList",s),t.getItemList("",!0,o),t.getWarehouseList(!0,n,a,i),t.txnKeys.editStatusId=i.status,t.txnKeys.editCreatedName=i.createdByInfo[0].employeeName,t.iTxnUtilsService.manipulationsOnEdit(t.txnKeys.inputScreenName,t.myForm1)}else t.utilsService.showFailureMsg(e),t.utilsService.goBack()}))}},{key:"copyFrom",value:function(){var t=this,e=this.iTxnUtilsService.getScreenDataService(this.txnKeys.inputCopyScreenName),i=this.branchUtilsService.screenAttributes[this.txnKeys.inputCopyScreenName];e.get(this.txnKeys.inputCopyId).subscribe((function(e){if("SUCCESS"===e.status){var r=e.results;delete r.documentNumber,delete r.documentNumberingId,delete r.documentNumberingInfo,delete r.salesEmpId;var n=t.iTxnUtilsService.getMainFieldsWithData(t.txnKeys.inputScreenName,r);t.myForm1.patchValue(n);var a=[],o=[];r.fromWarehouseInfo[0]&&a.push(r.fromWarehouseInfo[0]),r.toWarehouseInfo[0]&&o.push(r.toWarehouseInfo[0]),t.branchUtilsService.getMasterDocumentNumbering(t.myForm1,t.screenAttributes.documentTypeId).subscribe((function(e){t.documentNumberingList=e})),t.getBusinessPartnerList(!0,r.bpInfo),t.getBpContactList(!0,r.bpContactsInfo),t.getSalesEmployeeList(r.salesEmpInfo);var s=[],c=[],u=r.itemListArray.filter((function(t){return parseInt(t.openQuantity,0)>0}));r.itemListArray=u,r.itemListArray.forEach((function(e){e.copyFromId=e.id,e.copyFromType=i.backendKey,e.quantity=e.openQuantity,delete e.openQuantity,delete e.orderedQuantity,delete e.id,t.addItemFields(e),e.itemInfo[0]&&s.push(e.itemInfo[0]),e.uomInfo[0]&&c.push(e.uomInfo[0]),e.fromWarehouseInfo[0]&&a.push(e.fromWarehouseInfo[0]),e.toWarehouseInfo[0]&&o.push(e.toWarehouseInfo[0])})),t.getAutoSuggestionList("getUomList",c),t.getItemList("",!0,s),t.getWarehouseList(!0,a,o,r),t.iTxnUtilsService.manipulationsOnCopy(t.txnKeys.inputScreenName,t.myForm1)}else t.utilsService.showFailureMsg(e),t.utilsService.goBack()}))}},{key:"getDraft",value:function(){var t=this;this.screenDataService.get(this.txnKeys.inputDraftId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results,r=t.iTxnUtilsService.getMainFieldsWithData(t.txnKeys.inputScreenName,i);t.myForm1.patchValue(r);var n=[],a=[];i.fromWarehouseInfo[0]&&n.push(i.fromWarehouseInfo[0]),i.toWarehouseInfo[0]&&a.push(i.toWarehouseInfo[0]),t.branchUtilsService.getMasterDocumentNumbering(t.myForm1,t.screenAttributes.documentTypeId,"draft",i.documentNumberingInfo).subscribe((function(e){t.documentNumberingList=e})),t.getBusinessPartnerList(!0,i.bpInfo),t.getBpContactList(!0,i.bpContactsInfo),t.getSalesEmployeeList(i.salesEmpInfo);var o=[],s=[];i.itemListArray.forEach((function(e){t.addItemFields(e,"edit"),e.itemInfo[0]&&o.push(e.itemInfo[0]),e.uomInfo[0]&&s.push(e.uomInfo[0]),e.fromWarehouseInfo[0]&&n.push(e.fromWarehouseInfo[0]),e.toWarehouseInfo[0]&&a.push(e.toWarehouseInfo[0])})),t.getAutoSuggestionList("getUomList",s),t.getItemList("",!0,o),t.getWarehouseList(!0,n,a,i),t.txnKeys.editStatusId=i.status,t.txnKeys.editCreatedName=i.createdByInfo[0].employeeName,"1"===i.isDraft&&"4"===i.approvalStatus?(t.myForm1.controls.documentNumberingId.enable(),t.myForm1.controls.documentNumber.enable()):(t.myForm1.controls.documentNumberingId.disable(),t.myForm1.controls.documentNumber.disable())}else t.utilsService.showFailureMsg(e),t.utilsService.goBack()}))}},{key:"getDuplicate",value:function(){var t=this;this.screenDataService.get(this.txnKeys.inputDuplicateId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results;delete i.documentNumber,delete i.documentNumberingId,delete i.documentNumberingInfo,delete i.status;var r=t.iTxnUtilsService.getMainFieldsWithData(t.txnKeys.inputScreenName,i);t.myForm1.patchValue(r);var n=[],a=[];i.fromWarehouseInfo[0]&&n.push(i.fromWarehouseInfo[0]),i.toWarehouseInfo[0]&&a.push(i.toWarehouseInfo[0]),t.branchUtilsService.getMasterDocumentNumbering(t.myForm1,t.screenAttributes.documentTypeId).subscribe((function(e){t.documentNumberingList=e})),t.getBusinessPartnerList(),t.getSalesEmployeeList(i.salesEmpInfo);var o=[],s=[];i.itemListArray.forEach((function(e){delete e.id,delete e.openQuantity,delete e.orderedQuantity,delete e.copyFromType,delete e.copyFromId,t.addItemFields(e),e.itemInfo[0]&&o.push(e.itemInfo[0]),e.uomInfo[0]&&s.push(e.uomInfo[0]),e.fromWarehouseInfo[0]&&n.push(e.fromWarehouseInfo[0]),e.toWarehouseInfo[0]&&a.push(e.toWarehouseInfo[0])})),t.getAutoSuggestionList("getUomList",s),t.getItemList("",!0,o),t.getWarehouseList(!0,n,a,i)}else t.utilsService.showFailureMsg(e),t.utilsService.goBack()}))}},{key:"clearForm",value:function(){this.initializeForm1()}},{key:"onItemChange",value:function(t){this.branchUtilsService.txnSetUom(this.itemList,this.myForm1,t,"itemId"),this.branchUtilsService.txnCheckItemDuplicate(this.myForm1,t,"itemId",this.itemList),this.branchUtilsService.txnSetDefaultItemBin(this.itemList,this.myForm1,t,"fromWarehouseId","fromBinId","fromBinList"),this.branchUtilsService.txnSetDefaultItemBin(this.itemList,this.myForm1,t,"toWarehouseId","toBinId","toBinList")}},{key:"onItemSearch",value:function(t){this.branchUtilsService.itemSearch.next(t)}},{key:"getAutoSuggestionList",value:function(t,e){var i=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(r){"SUCCESS"===r.status?(i.utilsService.ifNotPushToList(r.results,e),"getInventoryTransStatusList"===t?(i.txnKeys.inputEditId||(r.results=r.results.filter((function(t){return"1"===t.id}))),i.statusList=r.results):"getDutyStatusList"===t?i.dutyStatusList=r.results:"getUomList"===t&&(i.uomList=r.results)):i.utilsService.showFailureMsg(r)}))}},{key:"getBusinessPartnerList",value:function(t,e){var i=this;this.commonDataService.getBusinessPartnerList([1]).subscribe((function(t){"SUCCESS"===t.status?(i.utilsService.ifNotPushToList(t.results,e),i.businessPartnerList=t.results.map((function(t){return t.searchText=t.partnerName+" - "+t.partnerCode,t}))):i.utilsService.showFailureMsg(t)}))}},{key:"getBpContactList",value:function(t,e){var i=this;this.bpContactList=[],this.branchUtilsService.getBpContactListAndSet(this.myForm1,"bpContactsId","businessPartnerId",t,e).subscribe((function(t){i.bpContactList=t}))}},{key:"getSalesEmployeeList",value:function(t){var e=this;this.commonDataService.getEmployeeList(1).subscribe((function(i){"SUCCESS"===i.status?(e.utilsService.ifNotPushToList(i.results,t),e.salesEmployeeList=i.results.map((function(t){return t.searchText=t.employeeName+" - "+t.empCode,t}))):e.utilsService.showFailureMsg(i)}))}},{key:"getItemList",value:function(t,e,i){var r=this;return e?(this.itemList=i.map((function(t){return t.searchText=t.itemName+" - "+t.itemCode,t})),!1):!t.term||t.term.length<3?(this.itemList=[],!1):void this.commonDataService.getItemList(t.term,3).subscribe((function(t){"SUCCESS"===t.status?r.itemList=t.results.map((function(t){return t.searchText=t.itemName+" - "+t.itemCode,t})):r.utilsService.showFailureMsg(t)}))}},{key:"getWarehouseList",value:function(t,e,i,r){var n=this;this.screenDataService.getFromToWarehouseList().subscribe((function(a){"SUCCESS"===a.status?(n.utilsService.ifNotPushToList(a.results.fromList,e),n.fromWarehouseList=a.results.fromList.map((function(t){return t.searchText=t.warehouseName+" - "+t.warehouseCode,t})),n.utilsService.ifNotPushToList(a.results.toList,i),n.toWarehouseList=a.results.toList.map((function(t){return t.searchText=t.warehouseName+" - "+t.warehouseCode,t})),n.myForm1Data.intraBranchFlag?(n.setIntraBranch(t,r),"inventoryRequest"===n.txnKeys.inputScreenName?n.setItemToWarehouseList(t,r):"inventoryTransfer"===n.txnKeys.inputScreenName&&n.setItemFromWarehouseList(t,r)):(n.setItemFromWarehouseList(t,r),n.setItemToWarehouseList(t,r))):n.utilsService.showFailureMsg(a)}))}},{key:"setIntraBranch",value:function(t,e){this.myForm1Data.intraBranchFlag?"inventoryRequest"===this.txnKeys.inputScreenName?(t||this.myForm1.patchValue({fromWarehouseId:null}),this.fromWarehouseList=_toConsumableArray(this.toWarehouseList),this.setItemFromWarehouseList(t,e)):"inventoryTransfer"===this.txnKeys.inputScreenName&&(t||this.myForm1.patchValue({toWarehouseId:null}),this.toWarehouseList=_toConsumableArray(this.fromWarehouseList),this.setItemToWarehouseList(t,e)):this.getWarehouseList()}},{key:"confirmFromWarehouseChanges",value:function(){var t=this;if(0===this.itemFromWarehouseList.length)return this.setItemFromWarehouseList(),!1;this.utilsService.confirmDialog("Confirmation",'Changing the warehouse will clear all the "From Warehouse / From Bin" in the items').content.confirmation.subscribe((function(e){e?t.setItemFromWarehouseList():t.myForm1.patchValue({fromWarehouseId:t.fromWarehousePrevValue})}))}},{key:"setItemFromWarehouseList",value:function(t,e){var i=this;if(this.itemFromWarehouseList=[],this.myForm1.controls.itemListArray.controls.forEach((function(e){e.patchValue({fromBinList:[[]]}),t||e.patchValue({fromWarehouseId:null,fromBinId:null})})),!this.myForm1Data.fromWarehouseId)return!1;var r=N.findIndex(this.fromWarehouseList,{id:this.myForm1Data.fromWarehouseId});if(r>=0){var n=this.fromWarehouseList[r].branchId;this.itemFromWarehouseList=this.fromWarehouseList.filter((function(t){return t.branchId===n}))}t&&e.itemListArray.forEach((function(t,e){i.setBinList("from",e,!0,t.fromBinInfo)}))}},{key:"confirmToWarehouseChanges",value:function(){var t=this;if(0===this.itemToWarehouseList.length)return this.setItemToWarehouseList(),!1;this.utilsService.confirmDialog("Confirmation",'Changing the warehouse will clear all the "To Warehouse / To Bin" in the items').content.confirmation.subscribe((function(e){e?t.setItemToWarehouseList():t.myForm1.patchValue({toWarehouseId:t.toWarehousePrevValue})}))}},{key:"setItemToWarehouseList",value:function(t,e){var i=this;if(this.itemToWarehouseList=[],this.myForm1.controls.itemListArray.controls.forEach((function(e){e.patchValue({toBinList:[[]]}),t||e.patchValue({toWarehouseId:null,toBinId:null})})),!this.myForm1Data.toWarehouseId)return!1;var r=N.findIndex(this.toWarehouseList,{id:this.myForm1Data.toWarehouseId});if(r>=0){var n=this.toWarehouseList[r].branchId;this.itemToWarehouseList=this.toWarehouseList.filter((function(t){return t.branchId===n}))}t&&e.itemListArray.forEach((function(t,e){i.setBinList("to",e,!0,t.toBinInfo)}))}},{key:"setBinList",value:function(t,e,i,r){var n=this.myForm1.controls.itemListArray.at(e);"from"===t?(this.branchUtilsService.txnSetBinListAndPreselect(this.itemFromWarehouseList,this.itemList,this.myForm1,e,"fromWarehouseId","fromBinId","fromBinList",i,r),n.patchValue({fromStockDetails:""})):"to"===t&&(this.branchUtilsService.txnSetBinListAndPreselect(this.itemToWarehouseList,this.itemList,this.myForm1,e,"toWarehouseId","toBinId","toBinList",i,r),n.patchValue({toStockDetails:""}))}},{key:"showTxnOptionsSidebar",value:function(t){this.branchUtilsService.spiTxnOptions.next(!1===t?{show:!1}:{show:!0,spiName:this.branchUtilsService.spiTxnId.inventory,screenName:this.txnKeys.inputScreenName,editId:this.txnKeys.inputEditId,bpId:this.myForm1Data.businessPartnerId,status:this.myForm1Data.status})}},{key:"downloadPdf",value:function(){this.branchUtilsService.spiTxnOptionsDownloadPdf.next({spiName:this.branchUtilsService.spiTxnId.inventory,screenName:this.txnKeys.inputScreenName,id:this.txnKeys.inputEditId})}},{key:"onKeydownHandler",value:function(t){t.ctrlKey&&"s"===t.key.toLowerCase()&&(this.txnKeys.inputEditId&&"1"===this.txnKeys.editStatusId||!this.txnKeys.inputEditId)&&(this.saveUpdate(),t.preventDefault()),this.txnKeys.inputEditId&&t.ctrlKey&&-1!=="p".indexOf(t.key)&&(this.downloadPdf(),t.preventDefault())}},{key:"ngOnDestroy",value:function(){this.reInitializeGlobalVariables(),this.itemListColumnOrderChangesSubscription.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||_i)(a.Pb(n.g),a.Pb(n.f),a.Pb(n.a),a.Pb(o.l),a.Pb(s.a),a.Pb(Tt),a.Pb(c.a),a.Pb(d.e),a.Pb(r.a),a.Pb(a.h),a.Pb(k.b))},_i.\u0275cmp=a.Jb({type:_i,selectors:[["app-inventory-txn-add"]],viewQuery:function(t,e){var i;1&t&&(a.Pc(E.a,!0),a.Pc(Zt.a,!0),a.Pc(ee,!0),a.Pc(ie,!0),a.Pc(re,!0),a.Pc(ne,!0),a.Pc(ae,!0),a.Pc(oe,!0),a.Pc(se,!0),a.Pc(ce,!0),a.Pc(ue,!0),a.Pc(be,!0),a.Pc(le,!0),a.Pc(me,!0),a.Pc(de,!0),a.Pc(he,!0),a.Pc(pe,!0),a.Pc(fe,!0),a.Pc(ge,!0),a.Pc(ve,!0),a.Pc(ye,!0),a.Pc(Le,!0)),2&t&&(a.zc(i=a.ec())&&(e.attachmentsComponent=i.first),a.zc(i=a.ec())&&(e.udfViewerComponent=i.first),a.zc(i=a.ec())&&(e.hActions=i.first),a.zc(i=a.ec())&&(e.hSno=i.first),a.zc(i=a.ec())&&(e.hItemName=i.first),a.zc(i=a.ec())&&(e.hQuantity=i.first),a.zc(i=a.ec())&&(e.hOpenQty=i.first),a.zc(i=a.ec())&&(e.hUOM=i.first),a.zc(i=a.ec())&&(e.hFromWarehouse=i.first),a.zc(i=a.ec())&&(e.hFromBin=i.first),a.zc(i=a.ec())&&(e.hToWarehouse=i.first),a.zc(i=a.ec())&&(e.hToBin=i.first),a.zc(i=a.ec())&&(e.bActions=i.first),a.zc(i=a.ec())&&(e.bSno=i.first),a.zc(i=a.ec())&&(e.bItemName=i.first),a.zc(i=a.ec())&&(e.bQuantity=i.first),a.zc(i=a.ec())&&(e.bOpenQty=i.first),a.zc(i=a.ec())&&(e.bUOM=i.first),a.zc(i=a.ec())&&(e.bFromWarehouse=i.first),a.zc(i=a.ec())&&(e.bFromBin=i.first),a.zc(i=a.ec())&&(e.bToWarehouse=i.first),a.zc(i=a.ec())&&(e.bToBin=i.first))},hostBindings:function(t,e){1&t&&a.dc("keydown",(function(t){return e.onKeydownHandler(t)}),!1,a.Bc)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-arrow-left"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-columns"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],[1,"fa","fa-plus-square"],[1,"working-container","spi-txn-add",3,"formGroup"],[1,"box"],[1,"box-header"],[1,"fa","fa-angle-right"],[1,"box-body","box-form"],[1,"row"],[1,"form-group","col-sm-3"],[1,"form-label"],[1,"mandatory"],[1,"col-sm-6"],["formControlName","documentNumberingId","bindLabel","documentNumberingName","bindValue","id","placeholder","--SELECT--",3,"items","change"],["type","text","formControlName","documentNumber",1,"form-control","form-control-sm"],["class","validation-error",4,"ngIf"],[1,"action-control"],["formControlName","businessPartnerId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple","change"],["ng-option-tmp",""],["target","_blank","routerLink","/branch/bp/biz-partner-add",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["class","info-icon","container","body","tooltip","View Details",3,"click",4,"ngIf"],["formControlName","bpContactsId","bindLabel","contactName","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["type","text","formControlName","referenceNumber",1,"form-control","form-control-sm"],["class","float-right",4,"ngIf"],["formControlName","fromWarehouseId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple","change","open"],["formControlName","toWarehouseId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple","change","open"],["formControlName","postingDate",3,"monthNavigator","yearNavigator","yearRange","dateFormat"],["formControlName","dueDate",3,"monthNavigator","yearNavigator","yearRange","dateFormat"],["formControlName","documentDate",3,"monthNavigator","yearNavigator","yearRange","dateFormat"],[1,"position-relative"],["formControlName","salesEmpId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--",3,"items","multiple"],["formControlName","status",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],["formControlName","dutyStatusId",1,"form-control","form-control-sm"],["value",""],["formControlName","remarks","rows","2",1,"form-control","form-control-sm"],[1,"box-body","box-table"],[1,"table-responsive",3,"ngStyle"],[1,"table","table-striped","table-bordered"],[4,"ngFor","ngForOf"],["formArrayName","itemListArray"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"type"],[3,"type","doSuccess"],[1,"btn-group","text-right"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],["hActions",""],["hSno",""],["hItemName",""],["hQuantity",""],["hOpenQty",""],["hUOM",""],["hFromWarehouse",""],["hFromBin",""],["hToWarehouse",""],["hToBin",""],["bActions",""],["bSno",""],["bItemName",""],["bQuantity",""],["bOpenQty",""],["bUOM",""],["bFromWarehouse",""],["bFromBin",""],["bToWarehouse",""],["bToBin",""],[1,"fa","fa-print"],[1,"validation-error"],["target","_blank","routerLink","/branch/bp/biz-partner-add",3,"click"],[1,"fa","fa-plus"],[3,"click"],[1,"fa","fa-redo-alt"],["container","body","tooltip","View Details",1,"info-icon",3,"click"],[1,"fa","fa-info-circle"],[1,"float-right"],["type","checkbox","formControlName","intraBranchFlag",3,"change"],[3,"value"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"formGroupName"],["colspan","10"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"fa","fa-broom"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],["class","mt-2",4,"ngIf"],[1,"mt-2"],[1,"badge","badge-danger"],[2,"min-width","80px"],[2,"min-width","30px"],[2,"min-width","200px"],[2,"min-width","100px"],[2,"min-width","135px"],[2,"min-width","120px"],[3,"formGroup"],["placement","top","container","body","tooltip","Delete",1,"action","red",3,"click"],[1,"fa","fa-minus-circle"],["formControlName","itemId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple","virtualScroll","search","change"],["type","text","formControlName","quantity",1,"form-control","form-control-sm","text-right"],["formControlName","uomId","bindLabel","uomName","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["formControlName","fromWarehouseId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple","change"],["formControlName","fromBinId","bindLabel","binName","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["tooltip","Click to get stock details","container","body","placement","bottom",1,"info-icon",3,"click"],["popTemplate",""],["container","body","placement","bottom",3,"popover","outsideClick"],[1,"mb-1"],["formControlName","toWarehouseId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple","change"],["formControlName","toBinId","bindLabel","binName","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["popTemplate1",""]],template:function(t,e){1&t&&a.Jc(0,qi,191,62,"ng-container",0),2&t&&a.oc("ngIf",e.screenAcl.view)},directives:[u.m,d.n,d.i,T.a,d.m,d.g,d.b,T.c,At.a,d.t,u.l,d.p,d.v,u.n,d.d,Zt.a,E.a,Xt.a,r.g,m.a,d.a,u.q,d.j,te.a],styles:[""]}),_i),zi=i("xKhi"),ji=["dataTable"];function $i(t,e){1&t&&(a.Vb(0,"colgroup"),a.Qb(1,"col",13),a.Qb(2,"col",14),a.Qb(3,"col",15),a.Qb(4,"col",15),a.Qb(5,"col",15),a.Qb(6,"col",15),a.Qb(7,"col",16),a.Ub())}function Hi(t,e){if(1&t&&(a.Vb(0,"option",26),a.Lc(1),a.Ub()),2&t){var i=e.$implicit;a.oc("value",i.id),a.Cb(1),a.Mc(i.name)}}function Yi(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"th"),a.Lc(2,"Actions"),a.Ub(),a.Vb(3,"th",17),a.Lc(4,"Code"),a.Qb(5,"p-sortIcon",18),a.Ub(),a.Vb(6,"th",17),a.Lc(7,"Chapter"),a.Qb(8,"p-sortIcon",18),a.Ub(),a.Vb(9,"th",17),a.Lc(10,"Heading"),a.Qb(11,"p-sortIcon",18),a.Ub(),a.Vb(12,"th",17),a.Lc(13,"Sub Heading"),a.Qb(14,"p-sortIcon",18),a.Ub(),a.Vb(15,"th",17),a.Lc(16,"Description"),a.Qb(17,"p-sortIcon",18),a.Ub(),a.Vb(18,"th",17),a.Lc(19,"Status"),a.Qb(20,"p-sortIcon",18),a.Ub(),a.Ub(),a.Vb(21,"tr",19),a.Vb(22,"th"),a.Vb(23,"a",20),a.dc("click",(function(){return a.Dc(i),a.hc().clearSearchForm()})),a.Qb(24,"i",21),a.Lc(25,"Clear"),a.Ub(),a.Ub(),a.Vb(26,"th"),a.Vb(27,"input",22),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc().searchForm.hsnCode=t}))("keyup.enter",(function(){return a.Dc(i),a.hc().resetListing()})),a.Ub(),a.Ub(),a.Vb(28,"th"),a.Vb(29,"input",22),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc().searchForm.chapter=t}))("keyup.enter",(function(){return a.Dc(i),a.hc().resetListing()})),a.Ub(),a.Ub(),a.Vb(30,"th"),a.Vb(31,"input",22),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc().searchForm.heading=t}))("keyup.enter",(function(){return a.Dc(i),a.hc().resetListing()})),a.Ub(),a.Ub(),a.Vb(32,"th"),a.Vb(33,"input",22),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc().searchForm.subHeading=t}))("keyup.enter",(function(){return a.Dc(i),a.hc().resetListing()})),a.Ub(),a.Ub(),a.Vb(34,"th"),a.Vb(35,"input",22),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc().searchForm.hsnDescription=t}))("keyup.enter",(function(){return a.Dc(i),a.hc().resetListing()})),a.Ub(),a.Ub(),a.Vb(36,"th"),a.Vb(37,"select",23),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc().searchForm.status=t}))("change",(function(){return a.Dc(i),a.hc().resetListing()})),a.Vb(38,"option",24),a.Lc(39,"--SELECT--"),a.Ub(),a.Jc(40,Hi,2,2,"option",25),a.Ub(),a.Ub(),a.Ub()}if(2&t){var r=a.hc();a.Cb(3),a.oc("pSortableColumn","hsnCode"),a.Cb(2),a.oc("field","hsnCode"),a.Cb(1),a.oc("pSortableColumn","chapter"),a.Cb(2),a.oc("field","chapter"),a.Cb(1),a.oc("pSortableColumn","heading"),a.Cb(2),a.oc("field","heading"),a.Cb(1),a.oc("pSortableColumn","subHeading"),a.Cb(2),a.oc("field","subHeading"),a.Cb(1),a.oc("pSortableColumn","hsnDescription"),a.Cb(2),a.oc("field","hsnDescription"),a.Cb(1),a.oc("pSortableColumn","status"),a.Cb(2),a.oc("field","status"),a.Cb(7),a.oc("ngModel",r.searchForm.hsnCode),a.Cb(2),a.oc("ngModel",r.searchForm.chapter),a.Cb(2),a.oc("ngModel",r.searchForm.heading),a.Cb(2),a.oc("ngModel",r.searchForm.subHeading),a.Cb(2),a.oc("ngModel",r.searchForm.hsnDescription),a.Cb(2),a.oc("ngModel",r.searchForm.status),a.Cb(3),a.oc("ngForOf",r.statusList)}}function Zi(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"td"),a.Vb(2,"a",27),a.dc("click",(function(){a.Dc(i);var t=e.$implicit;return a.hc().showAddPopup(t.id)})),a.Qb(3,"i",28),a.Ub(),a.Ub(),a.Vb(4,"td"),a.Lc(5),a.Ub(),a.Vb(6,"td"),a.Lc(7),a.Ub(),a.Vb(8,"td"),a.Lc(9),a.Ub(),a.Vb(10,"td"),a.Lc(11),a.Ub(),a.Vb(12,"td"),a.Lc(13),a.Ub(),a.Vb(14,"td"),a.Vb(15,"span",29),a.Lc(16),a.Ub(),a.Ub(),a.Ub()}if(2&t){var r=e.$implicit,n=a.hc();a.Cb(5),a.Mc(r.hsnCode),a.Cb(2),a.Mc(r.chapter),a.Cb(2),a.Mc(r.heading),a.Cb(2),a.Mc(r.subHeading),a.Cb(2),a.Mc(r.hsnDescription),a.Cb(2),a.oc("ngClass",n.appConstants.STATUS_COLOR_CLS[r.status]),a.Cb(1),a.Mc(r.statusName)}}var Xi,tr=((Xi=function(){function t(e,i,r,a,o){_classCallCheck(this,t),this.utilsService=e,this.commonDataService=i,this.hsnDataService=r,this.branchUtilsService=a,this.modalService=o,this.appConstants=n.h,this.statusList=[],this.listing={data:[],totalRecords:0},this.searchForm={hsnCode:"",chapter:"",heading:"",subHeading:"",hsnDescription:"",status:"1"}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.getAutoSuggestionList("getCommonStatusList"),this.branchUtilsService.actionSaveUpdate.subscribe((function(e){"bin-location"===e.triggerType&&t.resetListing()}))}},{key:"getListing",value:function(t){var e=this,i=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.hsnDataService.getList(i).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"clearSearchForm",value:function(){this.searchForm={hsnCode:"",chapter:"",heading:"",subHeading:"",hsnDescription:"",status:"1"},this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"getAutoSuggestionList",value:function(t){var e=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(i){"SUCCESS"===i.status?"getCommonStatusList"===t&&(e.statusList=i.results):e.utilsService.showFailureMsg(i)}))}},{key:"showAddPopup",value:function(t){var e={backdrop:"static"};t&&(e.initialState={inputEditId:t}),this.modalService.show(zi.a,e)}}]),t}()).\u0275fac=function(t){return new(t||Xi)(a.Pb(n.g),a.Pb(o.l),a.Pb(o.t),a.Pb(s.a),a.Pb(k.b))},Xi.\u0275cmp=a.Jb({type:Xi,selectors:[["app-hsn-list"]],viewQuery:function(t,e){var i;1&t&&a.Pc(ji,!0),2&t&&a.zc(i=a.ec())&&(e.dataTable=i.first)},decls:18,vars:5,consts:[[1,"page-title"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],[2,"width","80px"],[2,"width","100px"],[2,"width","200px"],[2,"width","120px"],[3,"pSortableColumn"],[3,"field"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"],[1,"badge",3,"ngClass"]],template:function(t,e){1&t&&(a.Vb(0,"div",0),a.Vb(1,"span"),a.Lc(2,"H"),a.Ub(),a.Lc(3,"SN - List "),a.Vb(4,"div",1),a.Vb(5,"button",2),a.dc("click",(function(){return e.showAddPopup()})),a.Qb(6,"i",3),a.Vb(7,"span"),a.Lc(8,"Add HSN"),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(9,"div",4),a.Vb(10,"div",5),a.Vb(11,"div",6),a.Vb(12,"div",7),a.Vb(13,"p-table",8,9),a.dc("onLazyLoad",(function(t){return e.getListing(t)})),a.Jc(15,$i,8,0,"ng-template",10),a.Jc(16,Yi,41,19,"ng-template",11),a.Jc(17,Zi,17,7,"ng-template",12),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub()),2&t&&(a.Cb(13),a.oc("value",e.listing.data)("lazy",!0)("paginator",!0)("rows",e.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",e.listing.totalRecords))},directives:[b.c,l.b,b.b,b.a,m.a,d.b,d.m,d.o,d.t,d.p,d.v,u.l,u.k],styles:[""]}),Xi);function er(t,e){1&t&&(a.Tb(0),a.Lc(1,"Add"),a.Sb())}function ir(t,e){1&t&&(a.Tb(0),a.Lc(1,"Edit"),a.Sb())}function rr(t,e){if(1&t&&(a.Vb(0,"div",18),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors.priceListName," ")}}function nr(t,e){if(1&t&&(a.Vb(0,"div",18),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors.defaultPriceListId," ")}}function ar(t,e){if(1&t&&(a.Vb(0,"div",18),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors.defaultFactor," ")}}function or(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",19),a.dc("click",(function(){return a.Dc(i),a.hc().saveUpdate()})),a.Qb(1,"i",20),a.Vb(2,"span"),a.Lc(3,"Save"),a.Ub(),a.Ub()}}function sr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",21),a.dc("click",(function(){return a.Dc(i),a.hc().clearForm()})),a.Qb(1,"i",22),a.Vb(2,"span"),a.Lc(3,"Clear"),a.Ub(),a.Ub()}}function cr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",19),a.dc("click",(function(){return a.Dc(i),a.hc().saveUpdate()})),a.Qb(1,"i",23),a.Vb(2,"span"),a.Lc(3,"Update"),a.Ub(),a.Ub()}}function ur(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",21),a.dc("click",(function(){return a.Dc(i),a.hc().activeModal.hide()})),a.Qb(1,"i",24),a.Vb(2,"span"),a.Lc(3,"Cancel"),a.Ub(),a.Ub()}}function br(t,e){1&t&&(a.Vb(0,"div",25),a.Vb(1,"span",26),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," You are unauthorized to "),a.Vb(4,"strong"),a.Lc(5,"update"),a.Ub(),a.Lc(6," this transaction! "),a.Ub())}function lr(t,e){1&t&&(a.Vb(0,"div",25),a.Vb(1,"span",26),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," You are unauthorized to "),a.Vb(4,"strong"),a.Lc(5,"add"),a.Ub(),a.Lc(6," this transaction!. "),a.Ub())}var mr,dr=((mr=function(){function t(e,i,r,n,a,o,s){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.commonDataService=r,this.pricingDataService=n,this.branchUtilsService=a,this.activeModal=o,this.formBuilder=s,this.screenAcl={},this.defaultBasePriceList=[],this.myFormData={},this.myFormErrors={priceListName:"",defaultPriceListId:"",defaultFactor:""},this.myFormValidationMsgs={priceListName:{required:"Price List Name is required"},defaultPriceListId:{required:"Default Base Price List is required"},defaultFactor:{required:"Default Factor is required"}}}return _createClass(t,[{key:"ngOnInit",value:function(){this.screenAcl=this.authGuardService.getScreenAcl("28"),this.initializeForm(),this.inputEditId?this.get():this.getAutoSuggestionList("getPriceList")}},{key:"initializeForm",value:function(){var t=this;this.myForm=this.formBuilder.group({priceListName:["",[d.u.required]],defaultPriceListId:[null,[d.u.required]],defaultFactor:[{value:"",disabled:!1},[d.u.required]],defaultPriceListName:[""]}),this.myForm.valueChanges.subscribe((function(e){t.utilsService.validation(t.myForm,t.myFormErrors,t.myFormValidationMsgs),t.myFormData=t.myForm.getRawValue()})),this.myFormData=this.myForm.getRawValue()}},{key:"saveUpdate",value:function(){var t=this;if(!this.myForm.valid)return this.utilsService.validation(this.myForm,this.myFormErrors,this.myFormValidationMsgs,!0),!1;var e,i={priceListName:this.myFormData.priceListName,defaultPriceListId:0===this.myFormData.defaultPriceListId?"":this.myFormData.defaultPriceListId,defaultFactor:this.myFormData.defaultFactor,defaultPriceListName:this.myFormData.defaultPriceListName};this.inputEditId?(e="update",i.id=this.inputEditId):e="save",this.pricingDataService[e](i).subscribe((function(e){"SUCCESS"===e.status?(t.utilsService.showSuccessMsg(e),t.branchUtilsService.actionSaveUpdate.next({triggerType:"price"}),t.activeModal.hide()):t.utilsService.showFailureMsg(e)}))}},{key:"get",value:function(){var t=this;this.pricingDataService.get(this.inputEditId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results[0];t.myForm.patchValue({priceListName:i.priceListName,defaultPriceListId:i.defaultPriceListId,defaultFactor:i.defaultFactor}),t.getAutoSuggestionList("getPriceList",i.defaultPriceListId)}else t.utilsService.showFailureMsg(e)}))}},{key:"clearForm",value:function(){this.initializeForm()}},{key:"onPriceListNameChange",value:function(){var t,e=this;(t=N.findIndex(this.defaultBasePriceList,this.inputEditId?function(t){return t.id===e.inputEditId}:function(t){return 0===t.id}))>=0?(this.defaultBasePriceList[t].priceListName=this.myFormData.priceListName,this.myFormData.defaultPriceListId||this.myFormData.priceListName!==this.defaultBasePriceList[t].priceListName||this.myForm.patchValue({defaultPriceListId:this.defaultBasePriceList[t].id})):(this.defaultBasePriceList.push({id:0,priceListName:this.myFormData.priceListName}),this.myForm.patchValue({defaultPriceListId:0})),this.defaultBasePriceList=this.defaultBasePriceList.slice(0),this.setDefaultFactor()}},{key:"onDefaultPriceListNameChange",value:function(){var t=this,e=N.find(this.defaultBasePriceList,(function(e){return e.id===t.myFormData.defaultPriceListId}));this.myForm.patchValue({defaultPriceListName:e.priceListName}),this.setDefaultFactor()}},{key:"setDefaultFactor",value:function(){var t=this,e=N.find(this.defaultBasePriceList,(function(e){return e.id===t.myFormData.defaultPriceListId}));e&&e.priceListName===this.myFormData.priceListName?(this.myForm.patchValue({defaultFactor:1}),this.myForm.controls.defaultFactor.disable()):(this.myForm.controls.defaultFactor.enable(),this.myFormData.defaultFactor||this.myForm.patchValue({defaultFactor:""}))}},{key:"getAutoSuggestionList",value:function(t,e){var i=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(t){"SUCCESS"===t.status?(i.utilsService.ifNotPushToList(t.results,e),i.defaultBasePriceList=t.results,i.setDefaultFactor()):i.utilsService.showFailureMsg(t)}))}}]),t}()).\u0275fac=function(t){return new(t||mr)(a.Pb(n.g),a.Pb(n.a),a.Pb(o.l),a.Pb(o.I),a.Pb(s.a),a.Pb(k.a),a.Pb(d.e))},mr.\u0275cmp=a.Jb({type:mr,selectors:[["app-pricing-add-popup"]],decls:39,vars:13,consts:[[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],[1,"close",3,"click"],[1,"modal-body"],[1,"row",3,"formGroup"],[1,"form-group","col-sm-6"],[1,"form-label"],[1,"mandatory"],["type","text","formControlName","priceListName",1,"form-control","form-control-sm",3,"change"],["class","validation-error",4,"ngIf"],["formControlName","defaultPriceListId","bindLabel","priceListName","bindValue","id","placeholder","--SELECT--",3,"items","change"],["type","text","formControlName","defaultFactor",1,"form-control","form-control-sm"],[1,"modal-footer"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],[1,"validation-error"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-broom"],[1,"fa","fa-sync"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(a.Vb(0,"div",0),a.Vb(1,"h5",1),a.Jc(2,er,2,0,"ng-container",2),a.Jc(3,ir,2,0,"ng-container",2),a.Lc(4," Price "),a.Ub(),a.Vb(5,"button",3),a.dc("click",(function(){return e.activeModal.hide()})),a.Vb(6,"span"),a.Lc(7,"\xd7"),a.Ub(),a.Ub(),a.Ub(),a.Vb(8,"div",4),a.Vb(9,"div",5),a.Vb(10,"div",6),a.Vb(11,"label",7),a.Lc(12,"Price List Name"),a.Vb(13,"span",8),a.Lc(14,"*"),a.Ub(),a.Ub(),a.Vb(15,"input",9),a.dc("change",(function(){return e.onPriceListNameChange()})),a.Ub(),a.Jc(16,rr,2,1,"div",10),a.Ub(),a.Vb(17,"div",6),a.Vb(18,"label",7),a.Lc(19,"Default Base Price List"),a.Vb(20,"span",8),a.Lc(21,"*"),a.Ub(),a.Ub(),a.Vb(22,"ng-select",11),a.dc("change",(function(){return e.onDefaultPriceListNameChange()})),a.Ub(),a.Jc(23,nr,2,1,"div",10),a.Ub(),a.Vb(24,"div",6),a.Vb(25,"label",7),a.Lc(26,"Default Factor"),a.Vb(27,"span",8),a.Lc(28,"*"),a.Ub(),a.Ub(),a.Qb(29,"input",12),a.Jc(30,ar,2,1,"div",10),a.Ub(),a.Ub(),a.Ub(),a.Vb(31,"div",13),a.Vb(32,"div",14),a.Jc(33,or,4,0,"button",15),a.Jc(34,sr,4,0,"button",16),a.Jc(35,cr,4,0,"button",15),a.Jc(36,ur,4,0,"button",16),a.Ub(),a.Jc(37,br,7,0,"div",17),a.Jc(38,lr,7,0,"div",17),a.Ub()),2&t&&(a.Cb(2),a.oc("ngIf",!e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId),a.Cb(6),a.oc("formGroup",e.myForm),a.Cb(7),a.oc("ngIf",e.myFormErrors.priceListName),a.Cb(6),a.oc("items",e.defaultBasePriceList),a.Cb(1),a.oc("ngIf",e.myFormErrors.defaultPriceListId),a.Cb(7),a.oc("ngIf",e.myFormErrors.defaultFactor),a.Cb(3),a.oc("ngIf",e.screenAcl.add&&!e.inputEditId),a.Cb(1),a.oc("ngIf",!e.inputEditId),a.Cb(1),a.oc("ngIf",e.screenAcl.update&&e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId&&!e.screenAcl.update),a.Cb(1),a.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[u.m,d.n,d.i,d.b,d.m,d.g,T.a],styles:[""]}),mr),hr=["dataTable"];function pr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"th",13),a.Lc(2,"Actions"),a.Ub(),a.Vb(3,"th",14),a.Lc(4,"Price List Name"),a.Qb(5,"p-sortIcon",15),a.Ub(),a.Vb(6,"th",14),a.Lc(7,"Default Base Price List "),a.Qb(8,"p-sortIcon",15),a.Ub(),a.Vb(9,"th",14),a.Lc(10,"Default Factor "),a.Qb(11,"p-sortIcon",15),a.Ub(),a.Ub(),a.Vb(12,"tr",16),a.Vb(13,"th"),a.Vb(14,"a",17),a.dc("click",(function(){return a.Dc(i),a.hc(2).clearSearchForm()})),a.Qb(15,"i",18),a.Lc(16,"Clear"),a.Ub(),a.Ub(),a.Vb(17,"th"),a.Vb(18,"input",19),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.priceListName=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(19,"th"),a.Vb(20,"input",19),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.defaultPriceListName=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(21,"th"),a.Vb(22,"input",19),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.defaultFactor=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Ub()}if(2&t){var r=a.hc(2);a.Cb(3),a.oc("pSortableColumn","priceListName"),a.Cb(2),a.oc("field","priceListName"),a.Cb(1),a.oc("pSortableColumn","defaultPriceListName"),a.Cb(2),a.oc("field","defaultPriceListName"),a.Cb(1),a.oc("pSortableColumn","defaultFactor"),a.Cb(2),a.oc("field","defaultFactor"),a.Cb(7),a.oc("ngModel",r.searchForm.priceListName),a.Cb(2),a.oc("ngModel",r.searchForm.defaultPriceListName),a.Cb(2),a.oc("ngModel",r.searchForm.defaultFactor)}}function fr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"a",22),a.dc("click",(function(){a.Dc(i);var t=a.hc().$implicit;return a.hc(2).showAddPopup(t.id)})),a.Qb(1,"i",23),a.Ub()}}function gr(t,e){1&t&&(a.Vb(0,"span",24),a.Lc(1,"System"),a.Ub())}function vr(t,e){if(1&t&&(a.Vb(0,"tr"),a.Vb(1,"td"),a.Jc(2,fr,2,0,"a",20),a.Jc(3,gr,2,0,"span",21),a.Ub(),a.Vb(4,"td"),a.Lc(5),a.Ub(),a.Vb(6,"td"),a.Lc(7),a.Ub(),a.Vb(8,"td"),a.Lc(9),a.Ub(),a.Ub()),2&t){var i=e.$implicit;a.Cb(2),a.oc("ngIf","0"===i.isSystemConfig),a.Cb(1),a.oc("ngIf","1"===i.isSystemConfig),a.Cb(2),a.Mc(i.priceListName),a.Cb(2),a.Mc(i.defaultPriceListName),a.Cb(2),a.Mc(i.defaultFactor)}}function yr(t,e){if(1&t){var i=a.Wb();a.Tb(0),a.Vb(1,"div",1),a.Vb(2,"span"),a.Lc(3,"P"),a.Ub(),a.Lc(4,"rice - List "),a.Vb(5,"div",2),a.Vb(6,"button",3),a.dc("click",(function(){return a.Dc(i),a.hc().showAddPopup()})),a.Qb(7,"i",4),a.Vb(8,"span"),a.Lc(9,"Add Price"),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(10,"div",5),a.Vb(11,"div",6),a.Vb(12,"div",7),a.Vb(13,"div",8),a.Vb(14,"p-table",9,10),a.dc("onLazyLoad",(function(t){return a.Dc(i),a.hc().getListing(t)})),a.Jc(16,pr,23,9,"ng-template",11),a.Jc(17,vr,10,5,"ng-template",12),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Sb()}if(2&t){var r=a.hc();a.Cb(14),a.oc("value",r.listing.data)("lazy",!0)("paginator",!0)("rows",r.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",r.listing.totalRecords)}}var Lr,Sr=((Lr=function(){function t(e,i,r,a,o){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.pricingDataService=r,this.branchUtilsService=a,this.modalService=o,this.appConstants=n.h,this.screenAcl={},this.listing={data:[],totalRecords:0},this.searchForm={priceListName:"",defaultPriceListName:"",defaultFactor:""}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;if(this.screenAcl=this.authGuardService.getScreenAcl("28"),!this.screenAcl.view)return this.utilsService.showFailureMsg(n.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.branchUtilsService.actionSaveUpdate.subscribe((function(e){"price"===e.triggerType&&t.resetListing()}))}},{key:"getListing",value:function(t){var e=this,i=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.pricingDataService.getList(i).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"clearSearchForm",value:function(){this.searchForm={priceListName:"",defaultPriceListName:"",defaultFactor:""},this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"showAddPopup",value:function(t){var e={backdrop:"static"};t&&(e.initialState={inputEditId:t}),this.modalService.show(dr,e)}}]),t}()).\u0275fac=function(t){return new(t||Lr)(a.Pb(n.g),a.Pb(n.a),a.Pb(o.I),a.Pb(s.a),a.Pb(k.b))},Lr.\u0275cmp=a.Jb({type:Lr,selectors:[["app-pricing-list"]],viewQuery:function(t,e){var i;1&t&&a.Pc(hr,!0),2&t&&a.zc(i=a.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[2,"width","100px"],[2,"width","100px",3,"pSortableColumn"],[3,"field"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],["class","action blue","placement","top","container","body","tooltip","Edit",3,"click",4,"ngIf"],["class","badge badge-danger",4,"ngIf"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&a.Jc(0,yr,18,5,"ng-container",0),2&t&&a.oc("ngIf",e.screenAcl.view)},directives:[u.m,b.c,l.b,b.b,b.a,m.a,d.b,d.m,d.o],styles:[""]}),Lr);function Cr(t,e){1&t&&(a.Tb(0),a.Lc(1,"Add"),a.Sb())}function Ir(t,e){1&t&&(a.Tb(0),a.Lc(1,"Edit"),a.Sb())}function Ur(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.partnerName,"\xa0"),a.Cb(2),a.Nc("(",i.partnerCode,")")}}function Vr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"span",24),a.dc("click",(function(){a.Dc(i);var t=a.hc();return t.popupExternalService.showDetailPopup("biz-partner",t.myFormData.businessPartnerId)})),a.Qb(1,"i",25),a.Ub()}}function Fr(t,e){if(1&t&&(a.Vb(0,"div",26),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors.businessPartnerId," ")}}function Dr(t,e){if(1&t&&(a.Vb(0,"div"),a.Lc(1),a.Vb(2,"small"),a.Lc(3),a.Ub(),a.Ub()),2&t){var i=e.item;a.Cb(1),a.Nc("",i.itemName,"\xa0"),a.Cb(2),a.Nc("(",i.itemCode,")")}}function Nr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"span",24),a.dc("click",(function(){a.Dc(i);var t=a.hc();return t.popupExternalService.showDetailPopup("item",t.myFormData.itemId)})),a.Qb(1,"i",25),a.Ub()}}function Er(t,e){if(1&t&&(a.Vb(0,"div",26),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors.itemName," ")}}function kr(t,e){if(1&t&&(a.Vb(0,"div",26),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors.priceListId," ")}}function Tr(t,e){if(1&t&&(a.Vb(0,"div",26),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors.unitPrice," ")}}function Ar(t,e){if(1&t&&(a.Vb(0,"div",26),a.Lc(1),a.Ub()),2&t){var i=a.hc();a.Cb(1),a.Nc(" ",i.myFormErrors.discountPercentage," ")}}function Pr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",27),a.dc("click",(function(){return a.Dc(i),a.hc().saveUpdate()})),a.Qb(1,"i",28),a.Vb(2,"span"),a.Lc(3,"Save"),a.Ub(),a.Ub()}}function wr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",29),a.dc("click",(function(){return a.Dc(i),a.hc().clearForm()})),a.Qb(1,"i",30),a.Vb(2,"span"),a.Lc(3,"Clear"),a.Ub(),a.Ub()}}function xr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",27),a.dc("click",(function(){return a.Dc(i),a.hc().saveUpdate()})),a.Qb(1,"i",31),a.Vb(2,"span"),a.Lc(3,"Update"),a.Ub(),a.Ub()}}function Mr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"button",29),a.dc("click",(function(){return a.Dc(i),a.hc().activeModal.hide()})),a.Qb(1,"i",32),a.Vb(2,"span"),a.Lc(3,"Cancel"),a.Ub(),a.Ub()}}function Wr(t,e){1&t&&(a.Vb(0,"div",33),a.Vb(1,"span",34),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," You are unauthorized to "),a.Vb(4,"strong"),a.Lc(5,"update"),a.Ub(),a.Lc(6," this transaction! "),a.Ub())}function Br(t,e){1&t&&(a.Vb(0,"div",33),a.Vb(1,"span",34),a.Lc(2,"Note:"),a.Ub(),a.Lc(3," You are unauthorized to "),a.Vb(4,"strong"),a.Lc(5,"add"),a.Ub(),a.Lc(6," this transaction!. "),a.Ub())}var Or,Qr=((Or=function(){function t(e,i,r,n,a,o,s,c){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.commonDataService=r,this.spPricingSpDataService=n,this.branchUtilsService=a,this.activeModal=o,this.formBuilder=s,this.popupExternalService=c,this.screenAcl={},this.businessPartnerList=[],this.itemList=[],this.pricingList=[],this.myFormData={},this.myFormErrors={businessPartnerId:"",itemName:"",priceListId:"",unitPrice:"",discountPercentage:""},this.myFormValidationMsgs={businessPartnerId:{required:"Business Partner Name is required"},itemName:{required:"Item Name is required"},priceListId:{required:"Price List is required"},unitPrice:{required:"Unit price is required",pattern:"Only positive numbers are allowed"},discountPercentage:{required:"Discount Percentage is required"}}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.screenAcl=this.authGuardService.getScreenAcl("29"),this.initializeForm(),this.branchUtilsService.itemSearch.pipe(Object($t.a)(700),Object(Ht.a)(),Object(Yt.a)((function(e){t.getItemList(e)}))).subscribe(),this.inputEditId?this.get():(this.getAutoSuggestionList("getBusinessPartnerList"),this.getAutoSuggestionList("getPriceList"))}},{key:"initializeForm",value:function(){var t=this;this.myForm=this.formBuilder.group({businessPartnerId:[null,[d.u.required]],itemId:[null,[d.u.required]],priceListId:[null,[d.u.required]],unitPrice:[0,[d.u.required,d.u.pattern(n.h.VALIDATION_PATTERNS.positiveFloatNumber)]],discountPercentage:["",[d.u.required]],priceAfterDiscount:[{value:"",disabled:!0}]}),this.myForm.valueChanges.subscribe((function(e){t.utilsService.validation(t.myForm,t.myFormErrors,t.myFormValidationMsgs),t.myFormData=t.myForm.getRawValue()})),this.myFormData=this.myForm.getRawValue()}},{key:"saveUpdate",value:function(){var t=this;if(!this.myForm.valid)return this.utilsService.validation(this.myForm,this.myFormErrors,this.myFormValidationMsgs,!0),!1;var e,i={businessPartnerId:this.myFormData.businessPartnerId,priceListId:this.myFormData.priceListId,itemId:this.myFormData.itemId,discountPercentage:this.myFormData.discountPercentage,unitPrice:this.myFormData.unitPrice,priceAfterDiscount:this.myFormData.priceAfterDiscount};this.inputEditId?(e="update",i.id=this.inputEditId):e="save",this.spPricingSpDataService[e](i).subscribe((function(e){"SUCCESS"===e.status?(t.utilsService.showSuccessMsg(e),t.branchUtilsService.actionSaveUpdate.next({triggerType:"sp-price-bp"}),t.activeModal.hide()):t.utilsService.showFailureMsg(e)}))}},{key:"get",value:function(){var t=this;this.spPricingSpDataService.get(this.inputEditId).subscribe((function(e){if("SUCCESS"===e.status){var i=e.results[0];t.myForm.patchValue({businessPartnerId:i.businessPartnerInfo[0].id,itemId:i.itemInfo[0].id,priceListId:i.priceListInfo[0].id,unitPrice:i.unitPrice,discountPercentage:i.discountPercentage,priceAfterDiscount:i.priceAfterDiscount}),t.getItemList("",!0,i.itemInfo),t.getAutoSuggestionList("getBusinessPartnerList",i.businessPartnerInfo),t.getAutoSuggestionList("getPriceList",i.priceListInfo)}else t.utilsService.showFailureMsg(e)}))}},{key:"clearForm",value:function(){this.initializeForm()}},{key:"onItemSearch",value:function(t){this.branchUtilsService.itemSearch.next(t)}},{key:"getAutoSuggestionList",value:function(t,e){var i=this;this.commonDataService.getAutoSuggestionList(t).subscribe((function(r){"SUCCESS"===r.status?(i.utilsService.ifNotPushToList(r.results,e),"getPriceList"===t?i.pricingList=r.results:"getBusinessPartnerList"===t&&(i.businessPartnerList=r.results.map((function(t){return t.searchText=t.partnerName+" - "+t.partnerCode,t})))):i.utilsService.showFailureMsg(r)}))}},{key:"onItemPriceChange",value:function(){var t=this;this.myFormData.priceListId&&this.myFormData.itemId?this.commonDataService.getItemPriceValue({itemId:this.myFormData.itemId,priceListId:this.myFormData.priceListId,type:"SPB"}).subscribe((function(e){"SUCCESS"===e.status?(t.myForm.patchValue({discountPercentage:e.results.discountPercentage,unitPrice:e.results.unitPrice}),t.onDiscountChange()):t.utilsService.showFailureMsg(e)})):this.myFormData.itemId||this.utilsService.showFailureMsg("Select Item to get unit price")}},{key:"onDiscountChange",value:function(){var t=this.myFormData.unitPrice?this.myFormData.unitPrice:0,e=this.myFormData.discountPercentage?this.myFormData.discountPercentage:0,i=parseInt(t,10)*(parseInt(e,10)/100),r=parseInt(t,10)-i;this.myForm.patchValue({priceAfterDiscount:r})}},{key:"getItemList",value:function(t,e,i){var r=this;return e?(this.itemList=i.map((function(t){return t.searchText=t.itemName+" - "+t.itemCode,t})),!1):!t.term||t.term.length<3?(this.itemList=[],!1):void this.commonDataService.getItemList(t.term,3).subscribe((function(t){"SUCCESS"===t.status?r.itemList=t.results.map((function(t){return t.searchText=t.itemName+" - "+t.itemCode,t})):r.utilsService.showFailureMsg(t)}))}}]),t}()).\u0275fac=function(t){return new(t||Or)(a.Pb(n.g),a.Pb(n.a),a.Pb(o.l),a.Pb(o.cb),a.Pb(s.a),a.Pb(k.a),a.Pb(d.e),a.Pb(c.a))},Or.\u0275cmp=a.Jb({type:Or,selectors:[["app-sp-pricing-bp-add-popup"]],decls:63,vars:22,consts:[[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],[1,"close",3,"click"],[1,"modal-body"],[1,"row",3,"formGroup"],[1,"form-group","col-sm-6"],[1,"form-label"],[1,"mandatory"],[1,"position-relative"],["formControlName","businessPartnerId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple"],["ng-option-tmp",""],["class","info-icon","container","body","tooltip","View Details",3,"click",4,"ngIf"],["class","validation-error",4,"ngIf"],["formControlName","itemId","bindLabel","searchText","bindValue","id","placeholder","--SELECT--","appendTo","body",3,"items","multiple","virtualScroll","search","change"],["formControlName","priceListId","bindLabel","priceListName","bindValue","id","placeholder","--SELECT--",3,"items","change"],["type","text","formControlName","unitPrice",1,"form-control","form-control-sm",3,"keyup"],["type","text","formControlName","discountPercentage",1,"form-control","form-control-sm",3,"keyup"],["type","text","formControlName","priceAfterDiscount",1,"form-control","form-control-sm"],[1,"modal-footer"],[1,"btn-group","text-right"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","btn btn-secondary btn-sm",3,"click",4,"ngIf"],["class","alert alert-info mt-3",4,"ngIf"],["container","body","tooltip","View Details",1,"info-icon",3,"click"],[1,"fa","fa-info-circle"],[1,"validation-error"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-broom"],[1,"fa","fa-sync"],[1,"fa","fa-times"],[1,"alert","alert-info","mt-3"],[1,"badge","badge-danger"]],template:function(t,e){1&t&&(a.Vb(0,"div",0),a.Vb(1,"h5",1),a.Lc(2," Special Prices for Business Partners - "),a.Jc(3,Cr,2,0,"ng-container",2),a.Jc(4,Ir,2,0,"ng-container",2),a.Ub(),a.Vb(5,"button",3),a.dc("click",(function(){return e.activeModal.hide()})),a.Vb(6,"span"),a.Lc(7,"\xd7"),a.Ub(),a.Ub(),a.Ub(),a.Vb(8,"div",4),a.Vb(9,"div",5),a.Vb(10,"div",6),a.Vb(11,"label",7),a.Lc(12,"Business Partner Name"),a.Vb(13,"span",8),a.Lc(14,"*"),a.Ub(),a.Ub(),a.Vb(15,"div",9),a.Vb(16,"ng-select",10),a.Jc(17,Ur,4,2,"ng-template",11),a.Ub(),a.Jc(18,Vr,2,0,"span",12),a.Ub(),a.Jc(19,Fr,2,1,"div",13),a.Ub(),a.Vb(20,"div",6),a.Vb(21,"label",7),a.Lc(22,"Item Name"),a.Vb(23,"span",8),a.Lc(24,"*"),a.Ub(),a.Ub(),a.Vb(25,"div",9),a.Vb(26,"ng-select",14),a.dc("search",(function(t){return e.onItemSearch(t)}))("change",(function(){return e.onItemPriceChange()})),a.Jc(27,Dr,4,2,"ng-template",11),a.Ub(),a.Jc(28,Nr,2,0,"span",12),a.Ub(),a.Jc(29,Er,2,1,"div",13),a.Ub(),a.Vb(30,"div",6),a.Vb(31,"label",7),a.Lc(32,"Price List"),a.Vb(33,"span",8),a.Lc(34,"*"),a.Ub(),a.Ub(),a.Vb(35,"ng-select",15),a.dc("change",(function(){return e.onItemPriceChange()})),a.Ub(),a.Jc(36,kr,2,1,"div",13),a.Ub(),a.Vb(37,"div",6),a.Vb(38,"label",7),a.Lc(39,"Unit Price"),a.Vb(40,"span",8),a.Lc(41,"*"),a.Ub(),a.Ub(),a.Vb(42,"input",16),a.dc("keyup",(function(){return e.onDiscountChange()})),a.Ub(),a.Jc(43,Tr,2,1,"div",13),a.Ub(),a.Vb(44,"div",6),a.Vb(45,"label",7),a.Lc(46,"Discount Percentage"),a.Vb(47,"span",8),a.Lc(48,"*"),a.Ub(),a.Ub(),a.Vb(49,"input",17),a.dc("keyup",(function(){return e.onDiscountChange()})),a.Ub(),a.Jc(50,Ar,2,1,"div",13),a.Ub(),a.Vb(51,"div",6),a.Vb(52,"label",7),a.Lc(53,"Price After Discount"),a.Ub(),a.Qb(54,"input",18),a.Ub(),a.Ub(),a.Ub(),a.Vb(55,"div",19),a.Vb(56,"div",20),a.Jc(57,Pr,4,0,"button",21),a.Jc(58,wr,4,0,"button",22),a.Jc(59,xr,4,0,"button",21),a.Jc(60,Mr,4,0,"button",22),a.Ub(),a.Jc(61,Wr,7,0,"div",23),a.Jc(62,Br,7,0,"div",23),a.Ub()),2&t&&(a.Cb(3),a.oc("ngIf",!e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId),a.Cb(5),a.oc("formGroup",e.myForm),a.Cb(7),a.oc("items",e.businessPartnerList)("multiple",!1),a.Cb(2),a.oc("ngIf",e.myFormData.businessPartnerId),a.Cb(1),a.oc("ngIf",e.myFormErrors.businessPartnerId),a.Cb(7),a.oc("items",e.itemList)("multiple",!1)("virtualScroll",!0),a.Cb(2),a.oc("ngIf",e.myFormData.itemId),a.Cb(1),a.oc("ngIf",e.myFormErrors.itemName),a.Cb(6),a.oc("items",e.pricingList),a.Cb(1),a.oc("ngIf",e.myFormErrors.priceListId),a.Cb(7),a.oc("ngIf",e.myFormErrors.unitPrice),a.Cb(7),a.oc("ngIf",e.myFormErrors.discountPercentage),a.Cb(7),a.oc("ngIf",e.screenAcl.add&&!e.inputEditId),a.Cb(1),a.oc("ngIf",!e.inputEditId),a.Cb(1),a.oc("ngIf",e.screenAcl.update&&e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId),a.Cb(1),a.oc("ngIf",e.inputEditId&&!e.screenAcl.update),a.Cb(1),a.oc("ngIf",!e.inputEditId&&!e.screenAcl.add))},directives:[u.m,d.n,d.i,T.a,d.m,d.g,T.c,d.b,m.a],styles:[""]}),Or),Jr=["dataTable"];function Rr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"th",13),a.Lc(2,"Actions"),a.Ub(),a.Vb(3,"th",14),a.Lc(4,"Business Partner Name"),a.Qb(5,"p-sortIcon",15),a.Ub(),a.Vb(6,"th",14),a.Lc(7,"Item Name "),a.Qb(8,"p-sortIcon",15),a.Ub(),a.Vb(9,"th",16),a.Lc(10,"Price List "),a.Qb(11,"p-sortIcon",15),a.Ub(),a.Vb(12,"th",16),a.Lc(13,"Unit Price "),a.Qb(14,"p-sortIcon",15),a.Ub(),a.Vb(15,"th",17),a.Lc(16,"Discount Percentage "),a.Qb(17,"p-sortIcon",15),a.Ub(),a.Vb(18,"th",18),a.Lc(19,"Price After Discount "),a.Qb(20,"p-sortIcon",15),a.Ub(),a.Ub(),a.Vb(21,"tr",19),a.Vb(22,"th"),a.Vb(23,"a",20),a.dc("click",(function(){return a.Dc(i),a.hc(2).clearSearchForm()})),a.Qb(24,"i",21),a.Lc(25,"Clear"),a.Ub(),a.Ub(),a.Vb(26,"th"),a.Vb(27,"input",22),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.partnerName=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Qb(28,"th"),a.Vb(29,"th"),a.Vb(30,"input",22),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.priceListName=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(31,"th"),a.Vb(32,"input",22),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.unitPrice=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(33,"th"),a.Vb(34,"input",22),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.discountPercentage=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Vb(35,"th"),a.Vb(36,"input",22),a.dc("ngModelChange",(function(t){return a.Dc(i),a.hc(2).searchForm.priceAfterDiscount=t}))("keyup.enter",(function(){return a.Dc(i),a.hc(2).resetListing()})),a.Ub(),a.Ub(),a.Ub()}if(2&t){var r=a.hc(2);a.Cb(3),a.oc("pSortableColumn","partnerName"),a.Cb(2),a.oc("field","partnerName"),a.Cb(1),a.oc("pSortableColumn","itemName"),a.Cb(2),a.oc("field","itemName"),a.Cb(1),a.oc("pSortableColumn","priceListName"),a.Cb(2),a.oc("field","priceListName"),a.Cb(1),a.oc("pSortableColumn","unitPrice"),a.Cb(2),a.oc("field","unitPrice"),a.Cb(1),a.oc("pSortableColumn","discountPercentage"),a.Cb(2),a.oc("field","discountPercentage"),a.Cb(1),a.oc("pSortableColumn","priceAfterDiscount"),a.Cb(2),a.oc("field","priceAfterDiscount"),a.Cb(7),a.oc("ngModel",r.searchForm.partnerName),a.Cb(3),a.oc("ngModel",r.searchForm.priceListName),a.Cb(2),a.oc("ngModel",r.searchForm.unitPrice),a.Cb(2),a.oc("ngModel",r.searchForm.discountPercentage),a.Cb(2),a.oc("ngModel",r.searchForm.priceAfterDiscount)}}function Kr(t,e){if(1&t){var i=a.Wb();a.Vb(0,"tr"),a.Vb(1,"td"),a.Vb(2,"a",23),a.dc("click",(function(){a.Dc(i);var t=e.$implicit;return a.hc(2).showAddPopup(t.id)})),a.Qb(3,"i",24),a.Ub(),a.Ub(),a.Vb(4,"td"),a.Lc(5),a.Ub(),a.Vb(6,"td"),a.Lc(7),a.Ub(),a.Vb(8,"td"),a.Lc(9),a.Ub(),a.Vb(10,"td"),a.Lc(11),a.Ub(),a.Vb(12,"td"),a.Lc(13),a.Ub(),a.Vb(14,"td"),a.Lc(15),a.Ub(),a.Ub()}if(2&t){var r=e.$implicit;a.Cb(5),a.Oc("",r.partnerCode," - ",r.partnerName,""),a.Cb(2),a.Oc("",r.itemCode," - ",r.itemName,""),a.Cb(2),a.Mc(r.priceListName),a.Cb(2),a.Mc(r.unitPrice),a.Cb(2),a.Mc(r.discountPercentage),a.Cb(2),a.Mc(r.priceAfterDiscount)}}function qr(t,e){if(1&t){var i=a.Wb();a.Tb(0),a.Vb(1,"div",1),a.Vb(2,"span"),a.Lc(3,"S"),a.Ub(),a.Lc(4,"pecial Prices for Business Partners - List "),a.Vb(5,"div",2),a.Vb(6,"button",3),a.dc("click",(function(){return a.Dc(i),a.hc().showAddPopup()})),a.Qb(7,"i",4),a.Vb(8,"span"),a.Lc(9,"Add Special Prices"),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(10,"div",5),a.Vb(11,"div",6),a.Vb(12,"div",7),a.Vb(13,"div",8),a.Vb(14,"p-table",9,10),a.dc("onLazyLoad",(function(t){return a.Dc(i),a.hc().getListing(t)})),a.Jc(16,Rr,37,17,"ng-template",11),a.Jc(17,Kr,16,8,"ng-template",12),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Sb()}if(2&t){var r=a.hc();a.Cb(14),a.oc("value",r.listing.data)("lazy",!0)("paginator",!0)("rows",r.appConstants.TABLE_DEFAULT_ROWS)("totalRecords",r.listing.totalRecords)}}var _r,Gr,zr=r.h.forChild([{path:"item-list",component:D},{path:"item-add",component:ot},{path:"item-edit/:id",component:ot},{path:"bin-list",component:Et},{path:"inventory-txn-list/:screenName",component:jt},{path:"inventory-txn-add/:screenName",component:Gi},{path:"inventory-txn-edit/:screenName/:id",component:Gi},{path:"inventory-txn-edit-draft/:screenName/:draftId",component:Gi},{path:"inventory-txn-copy/:screenName/:copyScreenName/:copyId",component:Gi},{path:"inventory-txn-duplicate/:screenName/:duplicateId",component:Gi},{path:"hsn-list",component:tr},{path:"pricing-list",component:Sr},{path:"special-pricing-list",component:(_r=function(){function t(e,i,r,a,o){_classCallCheck(this,t),this.utilsService=e,this.authGuardService=i,this.spPricingSpDataService=r,this.branchUtilsService=a,this.modalService=o,this.appConstants=n.h,this.screenAcl={},this.listing={data:[],totalRecords:0},this.searchForm={partnerName:"",priceListName:"",unitPrice:"",discountPercentage:"",priceAfterDiscount:""}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;if(this.screenAcl=this.authGuardService.getScreenAcl("29"),!this.screenAcl.view)return this.utilsService.showFailureMsg(n.h.ACL_UNAUTHORIZED_MSG),this.utilsService.goBack(),!1;this.branchUtilsService.actionSaveUpdate.subscribe((function(e){"sp-price-bp"===e.triggerType&&t.resetListing()}))}},{key:"getListing",value:function(t){var e=this,i=this.utilsService.dataTableParameterFormation(t,this.searchForm);this.spPricingSpDataService.getList(i).subscribe((function(t){"SUCCESS"===t.status?(e.listing.data=t.results.searchResults,e.listing.totalRecords=t.results.totalRecords):e.utilsService.showFailureMsg(t)}))}},{key:"clearSearchForm",value:function(){this.searchForm={partnerName:"",priceListName:"",unitPrice:"",discountPercentage:"",priceAfterDiscount:""},this.resetListing()}},{key:"resetListing",value:function(){this.dataTable.reset()}},{key:"showAddPopup",value:function(t){var e={backdrop:"static"};t&&(e.initialState={inputEditId:t}),this.modalService.show(Qr,e)}}]),t}(),_r.\u0275fac=function(t){return new(t||_r)(a.Pb(n.g),a.Pb(n.a),a.Pb(o.cb),a.Pb(s.a),a.Pb(k.b))},_r.\u0275cmp=a.Jb({type:_r,selectors:[["app-sp-pricing-bp-list"]],viewQuery:function(t,e){var i;1&t&&a.Pc(Jr,!0),2&t&&a.zc(i=a.ec())&&(e.dataTable=i.first)},decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-title"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"working-container"],[1,"row"],[1,"col-12"],[1,"datatable-responsive"],[3,"value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],[2,"width","50px"],[2,"width","150px",3,"pSortableColumn"],[3,"field"],[2,"width","80px",3,"pSortableColumn"],[2,"width","100px",3,"pSortableColumn"],[2,"width","90px",3,"pSortableColumn"],["placement","top","container","body","tooltip","Press Enter key to search",1,"search"],[1,"clear-search",3,"click"],[1,"fa","fa-times"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","keyup.enter"],["placement","top","container","body","tooltip","Edit",1,"action","blue",3,"click"],[1,"fa","fa-edit"]],template:function(t,e){1&t&&a.Jc(0,qr,18,5,"ng-container",0),2&t&&a.oc("ngIf",e.screenAcl.view)},directives:[u.m,b.c,l.b,b.b,b.a,m.a,d.b,d.m,d.o],styles:[""]}),_r)}]),jr=i("o+NB"),$r=i("7zUj"),Hr=i("N5hj"),Yr=i("dJ0z"),Zr=((Gr=function t(){_classCallCheck(this,t)}).\u0275mod=a.Nb({type:Gr}),Gr.\u0275inj=a.Mb({factory:function(t){return new(t||Gr)},providers:[Tt],imports:[[zr,jr.BranchModule,$r.a,Hr.a,Yr.a]]}),Gr)}}]);